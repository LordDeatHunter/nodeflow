(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function o(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=o(r);fetch(r.href,s)}})();const zo=(t,e)=>t===e,Po=Symbol("solid-track"),Ge={equals:zo};let Jt=no;const ie=1,We=2,eo={owned:null,cleanups:null,context:null,owner:null};var P=null;let it=null,_o=null,x=null,L=null,ee=null,ot=0;function Fe(t,e){const o=x,n=P,r=t.length===0,s=e===void 0?n:e,a=r?eo:{owned:null,cleanups:null,context:s?s.context:null,owner:s},i=r?t:()=>t(()=>ue(()=>xe(a)));P=a,x=null;try{return $e(i,!0)}finally{x=o,P=n}}function mt(t,e){e=e?Object.assign({},Ge,e):Ge;const o={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=r=>(typeof r=="function"&&(r=r(o.value)),oo(o,r));return[to.bind(o),n]}function K(t,e,o){const n=yt(t,e,!1,ie);Ee(n)}function Eo(t,e,o){Jt=To;const n=yt(t,e,!1,ie);n.user=!0,ee?ee.push(n):Ee(n)}function V(t,e,o){o=o?Object.assign({},Ge,o):Ge;const n=yt(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=o.equals||void 0,Ee(n),to.bind(n)}function ue(t){if(x===null)return t();const e=x;x=null;try{return t()}finally{x=e}}function $o(t){Eo(()=>ue(t))}function Ao(t){return P===null||(P.cleanups===null?P.cleanups=[t]:P.cleanups.push(t)),t}function to(){if(this.sources&&this.state)if(this.state===ie)Ee(this);else{const t=L;L=null,$e(()=>Ue(this),!1),L=t}if(x){const t=this.observers?this.observers.length:0;x.sources?(x.sources.push(this),x.sourceSlots.push(t)):(x.sources=[this],x.sourceSlots=[t]),this.observers?(this.observers.push(x),this.observerSlots.push(x.sources.length-1)):(this.observers=[x],this.observerSlots=[x.sources.length-1])}return this.value}function oo(t,e,o){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&$e(()=>{for(let r=0;r<t.observers.length;r+=1){const s=t.observers[r],a=it&&it.running;a&&it.disposed.has(s),(a?!s.tState:!s.state)&&(s.pure?L.push(s):ee.push(s),s.observers&&so(s)),a||(s.state=ie)}if(L.length>1e6)throw L=[],new Error},!1)),e}function Ee(t){if(!t.fn)return;xe(t);const e=ot;Oo(t,t.value,e)}function Oo(t,e,o){let n;const r=P,s=x;x=P=t;try{n=t.fn(e)}catch(a){return t.pure&&(t.state=ie,t.owned&&t.owned.forEach(xe),t.owned=null),t.updatedAt=o+1,ro(a)}finally{x=s,P=r}(!t.updatedAt||t.updatedAt<=o)&&(t.updatedAt!=null&&"observers"in t?oo(t,n):t.value=n,t.updatedAt=o)}function yt(t,e,o,n=ie,r){const s={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:P,context:P?P.context:null,pure:o};return P===null||P!==eo&&(P.owned?P.owned.push(s):P.owned=[s]),s}function Ke(t){if(t.state===0)return;if(t.state===We)return Ue(t);if(t.suspense&&ue(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<ot);)t.state&&e.push(t);for(let o=e.length-1;o>=0;o--)if(t=e[o],t.state===ie)Ee(t);else if(t.state===We){const n=L;L=null,$e(()=>Ue(t,e[0]),!1),L=n}}function $e(t,e){if(L)return t();let o=!1;e||(L=[]),ee?o=!0:ee=[],ot++;try{const n=t();return Fo(o),n}catch(n){o||(ee=null),L=null,ro(n)}}function Fo(t){if(L&&(no(L),L=null),t)return;const e=ee;ee=null,e.length&&$e(()=>Jt(e),!1)}function no(t){for(let e=0;e<t.length;e++)Ke(t[e])}function To(t){let e,o=0;for(e=0;e<t.length;e++){const n=t[e];n.user?t[o++]=n:Ke(n)}for(e=0;e<o;e++)Ke(t[e])}function Ue(t,e){t.state=0;for(let o=0;o<t.sources.length;o+=1){const n=t.sources[o];if(n.sources){const r=n.state;r===ie?n!==e&&(!n.updatedAt||n.updatedAt<ot)&&Ke(n):r===We&&Ue(n,e)}}}function so(t){for(let e=0;e<t.observers.length;e+=1){const o=t.observers[e];o.state||(o.state=We,o.pure?L.push(o):ee.push(o),o.observers&&so(o))}}function xe(t){let e;if(t.sources)for(;t.sources.length;){const o=t.sources.pop(),n=t.sourceSlots.pop(),r=o.observers;if(r&&r.length){const s=r.pop(),a=o.observerSlots.pop();n<r.length&&(s.sourceSlots[a]=n,r[n]=s,o.observerSlots[n]=a)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)xe(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)xe(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function Lo(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function ro(t,e=P){throw Lo(t)}const Bo=Symbol("fallback");function $t(t){for(let e=0;e<t.length;e++)t[e]()}function jo(t,e,o={}){let n=[],r=[],s=[],a=0,i=e.length>1?[]:null;return Ao(()=>$t(s)),()=>{let c=t()||[],d=c.length,u,l;return c[Po],ue(()=>{let g,p,w,N,j,b,C,D,m;if(d===0)a!==0&&($t(s),s=[],n=[],r=[],a=0,i&&(i=[])),o.fallback&&(n=[Bo],r[0]=Fe(R=>(s[0]=R,o.fallback())),a=1);else if(a===0){for(r=new Array(d),l=0;l<d;l++)n[l]=c[l],r[l]=Fe(f);a=d}else{for(w=new Array(d),N=new Array(d),i&&(j=new Array(d)),b=0,C=Math.min(a,d);b<C&&n[b]===c[b];b++);for(C=a-1,D=d-1;C>=b&&D>=b&&n[C]===c[D];C--,D--)w[D]=r[C],N[D]=s[C],i&&(j[D]=i[C]);for(g=new Map,p=new Array(D+1),l=D;l>=b;l--)m=c[l],u=g.get(m),p[l]=u===void 0?-1:u,g.set(m,l);for(u=b;u<=C;u++)m=n[u],l=g.get(m),l!==void 0&&l!==-1?(w[l]=r[u],N[l]=s[u],i&&(j[l]=i[u]),l=p[l],g.set(m,l)):s[u]();for(l=b;l<d;l++)l in w?(r[l]=w[l],s[l]=N[l],i&&(i[l]=j[l],i[l](l))):r[l]=Fe(f);r=r.slice(0,a=d),n=c.slice(0)}return r});function f(g){if(s[l]=g,i){const[p,w]=mt(l);return i[l]=w,e(c[l],p)}return e(c[l])}}}function z(t,e){return ue(()=>t(e||{}))}const Go=t=>`Stale read from <${t}>.`;function Wo(t){const e="fallback"in t&&{fallback:()=>t.fallback};return V(jo(()=>t.each,t.children,e||void 0))}function se(t){const e=t.keyed,o=V(()=>t.when,void 0,{equals:(n,r)=>e?n===r:!n==!r});return V(()=>{const n=o();if(n){const r=t.children;return typeof r=="function"&&r.length>0?ue(()=>r(e?n:()=>{if(!ue(o))throw Go("Show");return t.when})):r}return t.fallback},void 0,void 0)}function Ko(t,e,o){let n=o.length,r=e.length,s=n,a=0,i=0,c=e[r-1].nextSibling,d=null;for(;a<r||i<s;){if(e[a]===o[i]){a++,i++;continue}for(;e[r-1]===o[s-1];)r--,s--;if(r===a){const u=s<n?i?o[i-1].nextSibling:o[s-i]:c;for(;i<s;)t.insertBefore(o[i++],u)}else if(s===i)for(;a<r;)(!d||!d.has(e[a]))&&e[a].remove(),a++;else if(e[a]===o[s-1]&&o[i]===e[r-1]){const u=e[--r].nextSibling;t.insertBefore(o[i++],e[a++].nextSibling),t.insertBefore(o[--s],u),e[r]=o[s]}else{if(!d){d=new Map;let l=i;for(;l<s;)d.set(o[l],l++)}const u=d.get(e[a]);if(u!=null)if(i<u&&u<s){let l=a,f=1,g;for(;++l<r&&l<s&&!((g=d.get(e[l]))==null||g!==u+f);)f++;if(f>u-i){const p=e[a];for(;i<u;)t.insertBefore(o[i++],p)}else t.replaceChild(o[i++],e[a++])}else a++;else e[a++].remove()}}}const At="_$DX_DELEGATE";function Uo(t,e,o,n={}){let r;return Fe(s=>{r=s,e===document?t():$(e,t(),e.firstChild?null:void 0,o)},n.owner),()=>{r(),e.textContent=""}}function A(t,e,o){let n;const r=()=>{const a=document.createElement("template");return a.innerHTML=t,a.content.firstChild},s=()=>(n||(n=r())).cloneNode(!0);return s.cloneNode=s,s}function nt(t,e=window.document){const o=e[At]||(e[At]=new Set);for(let n=0,r=t.length;n<r;n++){const s=t[n];o.has(s)||(o.add(s),e.addEventListener(s,Ro))}}function Ot(t,e,o){o==null?t.removeAttribute(e):t.setAttribute(e,o)}function I(t,e){e==null?t.removeAttribute("class"):t.className=e}function Ft(t,e,o={}){const n=Object.keys(e||{}),r=Object.keys(o);let s,a;for(s=0,a=r.length;s<a;s++){const i=r[s];!i||i==="undefined"||e[i]||(Tt(t,i,!1),delete o[i])}for(s=0,a=n.length;s<a;s++){const i=n[s],c=!!e[i];!i||i==="undefined"||o[i]===c||!c||(Tt(t,i,!0),o[i]=c)}return o}function $(t,e,o,n){if(o!==void 0&&!n&&(n=[]),typeof e!="function")return Re(t,e,n,o);K(r=>Re(t,e(),r,o),n)}function Tt(t,e,o){const n=e.trim().split(/\s+/);for(let r=0,s=n.length;r<s;r++)t.classList.toggle(n[r],o)}function Ro(t){let e=t.target;const o=`$$${t.type}`,n=t.target,r=t.currentTarget,s=c=>Object.defineProperty(t,"target",{configurable:!0,value:c}),a=()=>{const c=e[o];if(c&&!e.disabled){const d=e[`${o}Data`];if(d!==void 0?c.call(e,d,t):c.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&s(e.host),!0},i=()=>{for(;a()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const c=t.composedPath();s(c[0]);for(let d=0;d<c.length-2&&(e=c[d],!!a());d++){if(e._$host){e=e._$host,i();break}if(e.parentNode===r)break}}else i();s(n)}function Re(t,e,o,n,r){for(;typeof o=="function";)o=o();if(e===o)return o;const s=typeof e,a=n!==void 0;if(t=a&&o[0]&&o[0].parentNode||t,s==="string"||s==="number"){if(s==="number"&&(e=e.toString(),e===o))return o;if(a){let i=o[0];i&&i.nodeType===3?i.data!==e&&(i.data=e):i=document.createTextNode(e),o=fe(t,o,n,i)}else o!==""&&typeof o=="string"?o=t.firstChild.data=e:o=t.textContent=e}else if(e==null||s==="boolean")o=fe(t,o,n);else{if(s==="function")return K(()=>{let i=e();for(;typeof i=="function";)i=i();o=Re(t,i,o,n)}),()=>o;if(Array.isArray(e)){const i=[],c=o&&Array.isArray(o);if(ut(i,e,o,r))return K(()=>o=Re(t,i,o,n,!0)),()=>o;if(i.length===0){if(o=fe(t,o,n),a)return o}else c?o.length===0?Lt(t,i,n):Ko(t,o,i):(o&&fe(t),Lt(t,i));o=i}else if(e.nodeType){if(Array.isArray(o)){if(a)return o=fe(t,o,n,e);fe(t,o,null,e)}else o==null||o===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);o=e}}return o}function ut(t,e,o,n){let r=!1;for(let s=0,a=e.length;s<a;s++){let i=e[s],c=o&&o[t.length],d;if(!(i==null||i===!0||i===!1))if((d=typeof i)=="object"&&i.nodeType)t.push(i);else if(Array.isArray(i))r=ut(t,i,c)||r;else if(d==="function")if(n){for(;typeof i=="function";)i=i();r=ut(t,Array.isArray(i)?i:[i],Array.isArray(c)?c:[c])||r}else t.push(i),r=!0;else{const u=String(i);c&&c.nodeType===3&&c.data===u?t.push(c):t.push(document.createTextNode(u))}}return r}function Lt(t,e,o=null){for(let n=0,r=e.length;n<r;n++)t.insertBefore(e[n],o)}function fe(t,e,o,n){if(o===void 0)return t.textContent="";const r=n||document.createTextNode("");if(e.length){let s=!1;for(let a=e.length-1;a>=0;a--){const i=e[a];if(r!==i){const c=i.parentNode===t;!s&&!a?c?t.replaceChild(r,i):t.insertBefore(r,o):c&&i.remove()}else s=!0}}else t.insertBefore(r,o);return[r]}(function(){try{if(typeof document<"u"){var t=document.createElement("style");t.appendChild(document.createTextNode("@layer nodeflow{.nodeflowConnectorSection{position:absolute;display:flex;justify-content:space-evenly;width:0;height:0;top:50%;left:50%}.nodeflowNode{position:absolute;border:1px solid black;-webkit-user-select:none;user-select:none;z-index:1;cursor:grab}}")),document.head.appendChild(t)}}catch(e){console.error("vite-plugin-css-injected-by-js",e)}})();var Ho=Object.defineProperty,Vo=(t,e,o)=>e in t?Ho(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,v=(t,e,o)=>(Vo(t,typeof e!="symbol"?e+"":e,o),o),io=(t,e,o)=>{if(!e.has(t))throw TypeError("Cannot "+o)},S=(t,e,o)=>(io(t,e,"read from private field"),o?o.call(t):e.get(t)),ht=(t,e,o)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,o)},Zo=(t,e,o,n)=>(io(t,e,"write to private field"),e.set(t,o),o);const qo=(t,e)=>t===e,he=Symbol("solid-proxy"),ft=Symbol("solid-track"),He={equals:qo};let ao=ho;const ae=1,Ve=2,co={owned:null,cleanups:null,context:null,owner:null};var _=null;let at=null,M=null,B=null,te=null,st=0;function ct(t,e){const o=M,n=_,r=t.length===0,s=n,a=r?co:{owned:null,cleanups:null,context:s?s.context:null,owner:s},i=r?t:()=>t(()=>re(()=>Pe(a)));_=a,M=null;try{return Ne(i,!0)}finally{M=o,_=n}}function Ae(t,e){e=e?Object.assign({},He,e):He;const o={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},n=r=>(typeof r=="function"&&(r=r(o.value)),uo(o,r));return[lo.bind(o),n]}function U(t,e,o){const n=Ct(t,e,!1,ae);Oe(n)}function ze(t,e,o){ao=Qo;const n=Ct(t,e,!1,ae);n.user=!0,te?te.push(n):Oe(n)}function X(t,e,o){o=o?Object.assign({},He,o):He;const n=Ct(t,e,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=o.equals||void 0,Oe(n),lo.bind(n)}function Te(t){return Ne(t,!1)}function re(t){if(M===null)return t();const e=M;M=null;try{return t()}finally{M=e}}function wt(t){return _===null||(_.cleanups===null?_.cleanups=[t]:_.cleanups.push(t)),t}function Ze(){return M}function lo(){if(this.sources&&this.state)if(this.state===ae)Oe(this);else{const t=B;B=null,Ne(()=>Xe(this),!1),B=t}if(M){const t=this.observers?this.observers.length:0;M.sources?(M.sources.push(this),M.sourceSlots.push(t)):(M.sources=[this],M.sourceSlots=[t]),this.observers?(this.observers.push(M),this.observerSlots.push(M.sources.length-1)):(this.observers=[M],this.observerSlots=[M.sources.length-1])}return this.value}function uo(t,e,o){let n=t.value;return(!t.comparator||!t.comparator(n,e))&&(t.value=e,t.observers&&t.observers.length&&Ne(()=>{for(let r=0;r<t.observers.length;r+=1){const s=t.observers[r],a=at&&at.running;a&&at.disposed.has(s),(a?!s.tState:!s.state)&&(s.pure?B.push(s):te.push(s),s.observers&&fo(s)),a||(s.state=ae)}if(B.length>1e6)throw B=[],new Error},!1)),e}function Oe(t){if(!t.fn)return;Pe(t);const e=st;Xo(t,t.value,e)}function Xo(t,e,o){let n;const r=_,s=M;M=_=t;try{n=t.fn(e)}catch(a){return t.pure&&(t.state=ae,t.owned&&t.owned.forEach(Pe),t.owned=null),t.updatedAt=o+1,po(a)}finally{M=s,_=r}(!t.updatedAt||t.updatedAt<=o)&&(t.updatedAt!=null&&"observers"in t?uo(t,n):t.value=n,t.updatedAt=o)}function Ct(t,e,o,n=ae,r){const s={fn:t,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:_,context:_?_.context:null,pure:o};return _===null||_!==co&&(_.owned?_.owned.push(s):_.owned=[s]),s}function qe(t){if(t.state===0)return;if(t.state===Ve)return Xe(t);if(t.suspense&&re(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<st);)t.state&&e.push(t);for(let o=e.length-1;o>=0;o--)if(t=e[o],t.state===ae)Oe(t);else if(t.state===Ve){const n=B;B=null,Ne(()=>Xe(t,e[0]),!1),B=n}}function Ne(t,e){if(B)return t();let o=!1;e||(B=[]),te?o=!0:te=[],st++;try{const n=t();return Yo(o),n}catch(n){o||(te=null),B=null,po(n)}}function Yo(t){if(B&&(ho(B),B=null),t)return;const e=te;te=null,e.length&&Ne(()=>ao(e),!1)}function ho(t){for(let e=0;e<t.length;e++)qe(t[e])}function Qo(t){let e,o=0;for(e=0;e<t.length;e++){const n=t[e];n.user?t[o++]=n:qe(n)}for(e=0;e<o;e++)qe(t[e])}function Xe(t,e){t.state=0;for(let o=0;o<t.sources.length;o+=1){const n=t.sources[o];if(n.sources){const r=n.state;r===ae?n!==e&&(!n.updatedAt||n.updatedAt<st)&&qe(n):r===Ve&&Xe(n,e)}}}function fo(t){for(let e=0;e<t.observers.length;e+=1){const o=t.observers[e];o.state||(o.state=Ve,o.pure?B.push(o):te.push(o),o.observers&&fo(o))}}function Pe(t){let e;if(t.sources)for(;t.sources.length;){const o=t.sources.pop(),n=t.sourceSlots.pop(),r=o.observers;if(r&&r.length){const s=r.pop(),a=o.observerSlots.pop();n<r.length&&(s.sourceSlots[a]=n,r[n]=s,o.observerSlots[n]=a)}}if(t.tOwned){for(e=t.tOwned.length-1;e>=0;e--)Pe(t.tOwned[e]);delete t.tOwned}if(t.owned){for(e=t.owned.length-1;e>=0;e--)Pe(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function Jo(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function po(t,e=_){throw Jo(t)}const en=Symbol("fallback");function Bt(t){for(let e=0;e<t.length;e++)t[e]()}function tn(t,e,o={}){let n=[],r=[],s=[],a=0,i=e.length>1?[]:null;return wt(()=>Bt(s)),()=>{let c=t()||[],d=c.length,u,l;return c[ft],re(()=>{let g,p,w,N,j,b,C,D,m;if(d===0)a!==0&&(Bt(s),s=[],n=[],r=[],a=0,i&&(i=[])),o.fallback&&(n=[en],r[0]=ct(R=>(s[0]=R,o.fallback())),a=1);else if(a===0){for(r=new Array(d),l=0;l<d;l++)n[l]=c[l],r[l]=ct(f);a=d}else{for(w=new Array(d),N=new Array(d),i&&(j=new Array(d)),b=0,C=Math.min(a,d);b<C&&n[b]===c[b];b++);for(C=a-1,D=d-1;C>=b&&D>=b&&n[C]===c[D];C--,D--)w[D]=r[C],N[D]=s[C],i&&(j[D]=i[C]);for(g=new Map,p=new Array(D+1),l=D;l>=b;l--)m=c[l],u=g.get(m),p[l]=u===void 0?-1:u,g.set(m,l);for(u=b;u<=C;u++)m=n[u],l=g.get(m),l!==void 0&&l!==-1?(w[l]=r[u],N[l]=s[u],i&&(j[l]=i[u]),l=p[l],g.set(m,l)):s[u]();for(l=b;l<d;l++)l in w?(r[l]=w[l],s[l]=N[l],i&&(i[l]=j[l],i[l](l))):r[l]=ct(f);r=r.slice(0,a=d),n=c.slice(0)}return r});function f(g){if(s[l]=g,i){const[p,w]=Ae(l);return i[l]=w,e(c[l],p)}return e(c[l])}}}function H(t,e){return re(()=>t(e||{}))}const on=t=>`Stale read from <${t}>.`;function ge(t){const e="fallback"in t&&{fallback:()=>t.fallback};return X(tn(()=>t.each,t.children,e||void 0))}function bt(t){const e=t.keyed,o=X(()=>t.when,void 0,{equals:(n,r)=>e?n===r:!n==!r});return X(()=>{const n=o();if(n){const r=t.children;return typeof r=="function"&&r.length>0?re(()=>r(e?n:()=>{if(!re(o))throw on("Show");return t.when})):r}return t.fallback},void 0,void 0)}function nn(t,e,o){let n=o.length,r=e.length,s=n,a=0,i=0,c=e[r-1].nextSibling,d=null;for(;a<r||i<s;){if(e[a]===o[i]){a++,i++;continue}for(;e[r-1]===o[s-1];)r--,s--;if(r===a){const u=s<n?i?o[i-1].nextSibling:o[s-i]:c;for(;i<s;)t.insertBefore(o[i++],u)}else if(s===i)for(;a<r;)(!d||!d.has(e[a]))&&e[a].remove(),a++;else if(e[a]===o[s-1]&&o[i]===e[r-1]){const u=e[--r].nextSibling;t.insertBefore(o[i++],e[a++].nextSibling),t.insertBefore(o[--s],u),e[r]=o[s]}else{if(!d){d=new Map;let l=i;for(;l<s;)d.set(o[l],l++)}const u=d.get(e[a]);if(u!=null)if(i<u&&u<s){let l=a,f=1,g;for(;++l<r&&l<s&&!((g=d.get(e[l]))==null||g!==u+f);)f++;if(f>u-i){const p=e[a];for(;i<u;)t.insertBefore(o[i++],p)}else t.replaceChild(o[i++],e[a++])}else a++;else e[a++].remove()}}}const jt="_$DX_DELEGATE";function ce(t,e,o){let n;const r=()=>{const a=document.createElement("template");return a.innerHTML=t,o?a.content.firstChild.firstChild:a.content.firstChild},s=e?()=>re(()=>document.importNode(n||(n=r()),!0)):()=>(n||(n=r())).cloneNode(!0);return s.cloneNode=s,s}function rt(t,e=window.document){const o=e[jt]||(e[jt]=new Set);for(let n=0,r=t.length;n<r;n++){const s=t[n];o.has(s)||(o.add(s),e.addEventListener(s,sn))}}function E(t,e,o){o==null?t.removeAttribute(e):t.setAttribute(e,o)}function go(t,e){e==null?t.removeAttribute("class"):t.className=e}function pt(t,e,o={}){const n=Object.keys(e||{}),r=Object.keys(o);let s,a;for(s=0,a=r.length;s<a;s++){const i=r[s];!i||i==="undefined"||e[i]||(Gt(t,i,!1),delete o[i])}for(s=0,a=n.length;s<a;s++){const i=n[s],c=!!e[i];!i||i==="undefined"||o[i]===c||!c||(Gt(t,i,!0),o[i]=c)}return o}function Dt(t,e,o){return re(()=>t(e,o))}function de(t,e,o,n){if(o!==void 0&&!n&&(n=[]),typeof e!="function")return Ye(t,e,n,o);U(r=>Ye(t,e(),r,o),n)}function Gt(t,e,o){const n=e.trim().split(/\s+/);for(let r=0,s=n.length;r<s;r++)t.classList.toggle(n[r],o)}function sn(t){let e=t.target;const o=`$$${t.type}`,n=t.target,r=t.currentTarget,s=c=>Object.defineProperty(t,"target",{configurable:!0,value:c}),a=()=>{const c=e[o];if(c&&!e.disabled){const d=e[`${o}Data`];if(d!==void 0?c.call(e,d,t):c.call(e,t),t.cancelBubble)return}return e.host&&typeof e.host!="string"&&!e.host._$host&&e.contains(t.target)&&s(e.host),!0},i=()=>{for(;a()&&(e=e._$host||e.parentNode||e.host););};if(Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return e||document}}),t.composedPath){const c=t.composedPath();s(c[0]);for(let d=0;d<c.length-2&&(e=c[d],!!a());d++){if(e._$host){e=e._$host,i();break}if(e.parentNode===r)break}}else i();s(n)}function Ye(t,e,o,n,r){for(;typeof o=="function";)o=o();if(e===o)return o;const s=typeof e,a=n!==void 0;if(t=a&&o[0]&&o[0].parentNode||t,s==="string"||s==="number"){if(s==="number"&&(e=e.toString(),e===o))return o;if(a){let i=o[0];i&&i.nodeType===3?i.data!==e&&(i.data=e):i=document.createTextNode(e),o=pe(t,o,n,i)}else o!==""&&typeof o=="string"?o=t.firstChild.data=e:o=t.textContent=e}else if(e==null||s==="boolean")o=pe(t,o,n);else{if(s==="function")return U(()=>{let i=e();for(;typeof i=="function";)i=i();o=Ye(t,i,o,n)}),()=>o;if(Array.isArray(e)){const i=[],c=o&&Array.isArray(o);if(gt(i,e,o,r))return U(()=>o=Ye(t,i,o,n,!0)),()=>o;if(i.length===0){if(o=pe(t,o,n),a)return o}else c?o.length===0?Wt(t,i,n):nn(t,o,i):(o&&pe(t),Wt(t,i));o=i}else if(e.nodeType){if(Array.isArray(o)){if(a)return o=pe(t,o,n,e);pe(t,o,null,e)}else o==null||o===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);o=e}}return o}function gt(t,e,o,n){let r=!1;for(let s=0,a=e.length;s<a;s++){let i=e[s],c=o&&o[t.length],d;if(!(i==null||i===!0||i===!1))if((d=typeof i)=="object"&&i.nodeType)t.push(i);else if(Array.isArray(i))r=gt(t,i,c)||r;else if(d==="function")if(n){for(;typeof i=="function";)i=i();r=gt(t,Array.isArray(i)?i:[i],Array.isArray(c)?c:[c])||r}else t.push(i),r=!0;else{const u=String(i);c&&c.nodeType===3&&c.data===u?t.push(c):t.push(document.createTextNode(u))}}return r}function Wt(t,e,o=null){for(let n=0,r=e.length;n<r;n++)t.insertBefore(e[n],o)}function pe(t,e,o,n){if(o===void 0)return t.textContent="";const r=n||document.createTextNode("");if(e.length){let s=!1;for(let a=e.length-1;a>=0;a--){const i=e[a];if(r!==i){const c=i.parentNode===t;!s&&!a?c?t.replaceChild(r,i):t.insertBefore(r,o):c&&i.remove()}else s=!0}}else t.insertBefore(r,o);return[r]}class h{constructor(e,o){v(this,"x"),v(this,"y"),this.x=e,this.y=o}static zero(){return new h(0,0)}static of(e,o){return new h(e,o)}static fromEvent(e){return new h(e.clientX,e.clientY)}static fromVec2(e){return new h(e.x,e.y)}copy(){return h.fromVec2(this)}serialize(){return{x:this.x,y:this.y}}static deserialize(e){return new h(e.x,e.y)}static deserializeOrDefault(e,o=h.zero()){return e?h.deserialize(e):o}add(...e){return e.reduce((o,n)=>new h(o.x+n.x,o.y+n.y),this)}subtract(...e){return e.reduce((o,n)=>new h(o.x-n.x,o.y-n.y),this)}multiply(...e){return e.reduce((o,n)=>new h(o.x*n.x,o.y*n.y),this)}divide(...e){return e.reduce((o,n)=>new h(n.x/o.x,n.y/o.y),this)}negate(){return new h(-this.x,-this.y)}shift(e){return new h(this.x+e,this.y+e)}multiplyBy(e){return new h(this.x*e,this.y*e)}divideBy(e){return new h(this.x/e,this.y/e)}isWithinRect(e,o){return this.x>=e.x&&this.x<=e.x+o.x&&this.y>=e.y&&this.y<=e.y+o.y}distanceTo(e){return Math.hypot(this.x-e.x,this.y-e.y)}abs(){return h.of(Math.abs(this.x),Math.abs(this.y))}equals(e){return this.x===e.x&&this.y===e.y}hashCode(){return`${this.x}:${this.y}`}get magnitude(){return Math.hypot(this.x,this.y)}normalize(){const e=this.magnitude;return new h(this.x/e,this.y/e)}}var rn=ce("<div>");const an=t=>(()=>{var e=rn();return e.$$pointerup=o=>t.nodeflowData.eventStore.onPointerUpInConnector.publish({event:o,nodeId:t.nodeId,connectorId:t.connectorId}),e.$$touchstart=o=>t.nodeflowData.eventStore.onTouchStartInConnector.publish({event:o,nodeId:t.nodeId,connectorId:t.connectorId}),e.$$mousedown=o=>t.nodeflowData.eventStore.onMouseDownInConnector.publish({event:o,nodeId:t.nodeId,connectorId:t.connectorId}),Dt(o=>setTimeout(()=>{var n,r;if(!o)return;const s=t.nodeflowData.nodes.get(t.nodeId).connectorSections.get(t.sectionId).connectors.get(t.connectorId),a=new ResizeObserver(()=>{s.size=h.of(o.offsetWidth,o.offsetHeight)});a.observe(o),s.update({position:h.of((((n=o?.parentElement)==null?void 0:n.offsetLeft)??0)+o.offsetLeft,(((r=o?.parentElement)==null?void 0:r.offsetTop)??0)+o.offsetTop),ref:o,resizeObserver:a,size:h.of(o.offsetWidth,o.offsetHeight)})}),e),U(o=>{var n,r=(n=t.connector)==null?void 0:n.css,s=`connector-${t.connectorId}`;return r!==o.e&&go(e,o.e=r),s!==o.t&&E(e,"id",o.t=s),o},{e:void 0,t:void 0}),e})();rt(["mousedown","touchstart","pointerup"]);var Kt=ce("<svg><circle r=4 fill=none></svg>",!1,!0),cn=ce("<svg><path stroke=black stroke-width=1 fill=transparent>");const ln=t=>{const e=X(()=>{const{mouseData:o,curveFunctions:n}=t.nodeflowData;if(o.heldConnectors.length!==1)return;const r=o.heldConnectors[0].connector,s=r.parentNode,a=r.getCenter(),i=o.globalMousePosition(),{anchorStart:c,anchorEnd:d}=n.calculateCurveAnchors(a,i,s.getCenter(),i);return{start:a,end:i,anchorStart:c,anchorEnd:d,path:n.createDefaultCurvePath(a,i,c,d)}});return(()=>{var o=cn(),n=o.firstChild;return o.style.setProperty("z-index","2"),o.style.setProperty("position","absolute"),o.style.setProperty("width","1px"),o.style.setProperty("height","1px"),o.style.setProperty("pointer-events","none"),o.style.setProperty("overflow","visible"),de(o,H(bt,{get when(){return t.nodeflowData.settings.debugMode},get children(){return[(()=>{var r=Kt();return U(s=>{var a,i,c=(a=e())==null?void 0:a.anchorStart.x,d=(i=e())==null?void 0:i.anchorStart.y,u=t.css??"";return c!==s.e&&E(r,"cx",s.e=c),d!==s.t&&E(r,"cy",s.t=d),u!==s.a&&E(r,"class",s.a=u),s},{e:void 0,t:void 0,a:void 0}),r})(),(()=>{var r=Kt();return U(s=>{var a,i,c=(a=e())==null?void 0:a.anchorEnd.x,d=(i=e())==null?void 0:i.anchorEnd.y,u=t.css??"";return c!==s.e&&E(r,"cx",s.e=c),d!==s.t&&E(r,"cy",s.t=d),u!==s.a&&E(r,"class",s.a=u),s},{e:void 0,t:void 0,a:void 0}),r})()]}}),null),U(r=>{var s,a=(s=e())==null?void 0:s.path,i=t.css;return a!==r.e&&E(n,"d",r.e=a),i!==r.t&&E(n,"class",r.t=i),r},{e:void 0,t:void 0}),o})()};var dn=ce("<svg><path stroke=black stroke-width=1 fill=none></svg>",!1,!0),Ut=ce("<svg><circle r=4 fill=none></svg>",!1,!0);const un=t=>{const e=X(()=>t.nodeflowData.nodes.get(t.sourceNodeId)),o=X(()=>t.nodeflowData.nodes.get(t.destinationNodeId)),n=X(()=>e().getConnector(t.sourceConnectorId)),r=X(()=>o().getConnector(t.destinationConnectorId)),s=X(()=>{var a,i;return!e()||!o()?-1:((i=(a=n())==null?void 0:a.destinations)==null?void 0:i.findIndex(c=>c.destinationConnector===r()))??-1});return ze(()=>{if(s()<0)return;const{curveFunctions:a}=t.nodeflowData,i=e().getConnector(t.sourceConnectorId),c=o().getConnector(t.destinationConnectorId),d=i.getCenter(),u=c.getCenter(),{anchorStart:l,anchorEnd:f}=a.calculateCurveAnchors(d,u,e().getCenter(),o().getCenter());n().destinations.get(s()).path={start:d,end:u,anchorStart:l,anchorEnd:f,path:a.createDefaultCurvePath(d,u,l,f)}}),[(()=>{var a=dn();return a.$$pointerdown=i=>{t.nodeflowData.eventStore.onPointerDownInNodeCurve.publish({event:i,sourceConnector:n(),destinationConnector:r()})},a.style.setProperty("cursor","pointer"),a.style.setProperty("pointer-events","visibleStroke"),U(i=>{var c,d,u,l=(c=n().destinations.get(s()).path)==null?void 0:c.path,f={[((d=t.css)==null?void 0:d.normal)??""]:!0,[((u=t.css)==null?void 0:u.selected)??""]:t.nodeflowData.mouseData.hasSelectedConnection(t.sourceNodeId,t.sourceConnectorId,t.destinationNodeId,t.destinationConnectorId)};return l!==i.e&&E(a,"d",i.e=l),i.t=pt(a,f,i.t),i},{e:void 0,t:void 0}),a})(),H(bt,{get when(){return t.nodeflowData.settings.debugMode},get children(){return[(()=>{var a=Ut();return U(i=>{var c,d,u,l,f,g=(d=(c=n().destinations.get(s()).path)==null?void 0:c.anchorStart)==null?void 0:d.x,p=(l=(u=n().destinations.get(s()).path)==null?void 0:u.anchorStart)==null?void 0:l.y,w=((f=t.css)==null?void 0:f.normal)??"";return g!==i.e&&E(a,"cx",i.e=g),p!==i.t&&E(a,"cy",i.t=p),w!==i.a&&E(a,"class",i.a=w),i},{e:void 0,t:void 0,a:void 0}),a})(),(()=>{var a=Ut();return U(i=>{var c,d,u,l,f,g=(d=(c=n().destinations.get(s()).path)==null?void 0:c.anchorEnd)==null?void 0:d.x,p=(l=(u=n().destinations.get(s()).path)==null?void 0:u.anchorEnd)==null?void 0:l.y,w=((f=t.css)==null?void 0:f.normal)??"";return g!==i.e&&E(a,"cx",i.e=g),p!==i.t&&E(a,"cy",i.t=p),w!==i.a&&E(a,"class",i.a=w),i},{e:void 0,t:void 0,a:void 0}),a})()]}})]};rt(["pointerdown"]);var hn=ce("<div class=nodeflowNode>"),fn=ce("<div>");const pn=t=>{const e=X(()=>t.nodeflowData.nodes.get(t.nodeId)),[o,n]=Ae(!1);return U(()=>{const r=t.nodeflowData.mouseData.selections.at(-1);r?.type!=="node"||r.node.id!==t.nodeId||!t.nodeflowData.mouseData.pointerDown||e().updateWithPrevious(s=>{const a=t.nodeflowData.mouseData.mousePosition.divideBy(t.nodeflowData.zoomLevel).subtract(t.nodeflowData.mouseData.clickStartPosition??h.zero());return t.nodeflowData.chunking.updateNodeInChunk(t.nodeId,s.position,a),{position:a}})}),wt(()=>{t.nodeflowData.chunking.removeNodeFromChunk(t.nodeId,e().position),e().resizeObserver&&(e().resizeObserver.disconnect(),Array.from(e().connectorSections.values()).forEach(r=>{Array.from(r.connectors.values()).forEach(s=>{s.resizeObserver&&s.resizeObserver.disconnect()})}))}),(()=>{var r=hn();return r.$$pointerup=s=>t.nodeflowData.eventStore.onPointerUpInNode.publish({event:s,nodeId:t.nodeId}),r.$$touchstart=s=>t.nodeflowData.eventStore.onTouchStartInNode.publish({event:s,nodeId:t.nodeId}),r.$$mousedown=s=>t.nodeflowData.eventStore.onMouseDownInNode.publish({event:s,nodeId:t.nodeId}),Dt(s=>setTimeout(()=>{if(!s)return;const a=new ResizeObserver(()=>{e().update({size:h.of(s.clientWidth,s.clientHeight)}),Array.from(e().connectorSections.values()).forEach(c=>Array.from(c.connectors.values()).forEach(d=>{var u,l;const f=d.ref;f&&(d.position=h.of((((u=f?.parentElement)==null?void 0:u.offsetLeft)??0)+f.offsetLeft,(((l=f?.parentElement)==null?void 0:l.offsetTop)??0)+f.offsetTop))}))});a.observe(s);const i=e().centered?h.of(s.clientWidth,s.clientHeight).divideBy(2):h.zero();e().update({offset:h.of(s.clientLeft,s.clientTop),ref:s,resizeObserver:a,position:e().position.subtract(i),size:h.of(s.clientWidth,s.clientHeight)}),n(!0)}),r),de(r,()=>e().display({node:e()}),null),de(r,H(ge,{get each(){return Array.from(e().connectorSections.entries())},children:([s,a])=>(()=>{var i=fn();return E(i,"id",`section-${s}`),de(i,H(ge,{get each(){return Array.from(a.connectors.entries())},children:([c,d])=>H(an,{connector:d,connectorId:c,get nodeId(){return t.nodeId},sectionId:s,get nodeflowData(){return t.nodeflowData}})})),U(c=>pt(i,{[a?.css??""]:!0,nodeflowConnectorSection:!0},c)),i})()}),null),U(s=>{var a,i,c,d,u=`${e().position.x}px`,l=`${e().position.y}px`,f=o()?1:0,g=`node-${t.nodeId}`,p={[((i=(a=e())==null?void 0:a.css)==null?void 0:i.normal)??""]:!0,[((d=(c=e())==null?void 0:c.css)==null?void 0:d.selected)??""]:t.nodeflowData.mouseData.hasSelectedNode(t.nodeId)};return u!==s.e&&((s.e=u)!=null?r.style.setProperty("left",u):r.style.removeProperty("left")),l!==s.t&&((s.t=l)!=null?r.style.setProperty("top",l):r.style.removeProperty("top")),f!==s.a&&((s.a=f)!=null?r.style.setProperty("opacity",f):r.style.removeProperty("opacity")),g!==s.o&&E(r,"id",s.o=g),s.i=pt(r,p,s.i),s},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),r})()};rt(["mousedown","touchstart","pointerup"]);var gn=ce("<div tabindex=0><div><svg>");const vn=t=>e=>(()=>{var o=gn(),n=o.firstChild,r=n.firstChild;return o.$$touchmove=s=>t.eventStore.onTouchMoveInNodeflow.publish({event:s}),o.$$touchstart=s=>t.eventStore.onTouchStartInNodeflow.publish({event:s}),o.$$keyup=s=>t.eventStore.onKeyUpInNodeflow.publish({event:s}),o.$$keydown=s=>t.eventStore.onKeyDownInNodeflow.publish({event:s}),o.$$mousedown=s=>t.eventStore.onMouseDownInNodeflow.publish({event:s}),o.addEventListener("wheel",s=>t.eventStore.onWheelInNodeflow.publish({event:s})),o.$$pointerup=s=>t.eventStore.onPointerUpInNodeflow.publish({event:s}),o.$$mousemove=s=>t.eventStore.onMouseMoveInNodeflow.publish({event:s}),Dt(s=>{new ResizeObserver(()=>{t.update({size:h.of(s.clientWidth,s.clientHeight),startPosition:h.of(s.offsetLeft,s.offsetTop)})}).observe(s)},o),o.style.setProperty("overflow","hidden"),n.style.setProperty("position","absolute"),n.style.setProperty("transform-origin","center"),n.style.setProperty("transition","scale 0.1s ease-out"),de(n,H(ge,{get each(){return Array.from(t.nodes.keys())},children:s=>H(pn,{nodeId:s,nodeflowData:t})}),r),r.style.setProperty("z-index","2"),r.style.setProperty("position","absolute"),r.style.setProperty("width","1px"),r.style.setProperty("height","1px"),r.style.setProperty("pointer-events","none"),r.style.setProperty("overflow","visible"),de(r,H(ge,{get each(){return Array.from(t.nodes.entries())},children:([s,a])=>H(ge,{get each(){return a.getAllConnectors()},children:i=>H(ge,{get each(){return i.destinations.array},children:c=>H(un,{nodeflowData:t,sourceNodeId:s,get sourceConnectorId(){return i.id},get destinationNodeId(){return c.destinationConnector.parentSection.parentNode.id},get destinationConnectorId(){return c.destinationConnector.id},get css(){return c.css}})})})})),de(n,H(bt,{get when(){return t.mouseData.heldConnectors.length===1},get children(){return H(ln,{get css(){var s;return(s=e?.css)==null?void 0:s.newCurve},nodeflowData:t})}}),null),U(s=>{var a,i=`nodeflow-${t.id}`,c=(a=e?.css)==null?void 0:a.nodeflow,d=e.height,u=e.width,l=`scale(${t.zoomLevel}) translate(${t.position.x}px, ${t.position.y}px)`;return i!==s.e&&E(o,"id",s.e=i),c!==s.t&&go(o,s.t=c),d!==s.a&&((s.a=d)!=null?o.style.setProperty("height",d):o.style.removeProperty("height")),u!==s.o&&((s.o=u)!=null?o.style.setProperty("width",u):o.style.removeProperty("width")),l!==s.i&&((s.i=l)!=null?n.style.setProperty("transform",l):n.style.removeProperty("transform")),s},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),o})();rt(["mousemove","pointerup","mousedown","keydown","keyup","touchstart","touchmove"]);const Qe=Symbol("store-raw"),ye=Symbol("store-node"),Q=Symbol("store-has"),vo=Symbol("store-self");function mo(t){let e=t[he];if(!e&&(Object.defineProperty(t,he,{value:e=new Proxy(t,wn)}),!Array.isArray(t))){const o=Object.keys(t),n=Object.getOwnPropertyDescriptors(t);for(let r=0,s=o.length;r<s;r++){const a=o[r];n[a].get&&Object.defineProperty(t,a,{enumerable:n[a].enumerable,get:n[a].get.bind(e)})}}return e}function Ce(t){let e;return t!=null&&typeof t=="object"&&(t[he]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function be(t,e=new Set){let o,n,r,s;if(o=t!=null&&t[Qe])return o;if(!Ce(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let a=0,i=t.length;a<i;a++)r=t[a],(n=be(r,e))!==r&&(t[a]=n)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const a=Object.keys(t),i=Object.getOwnPropertyDescriptors(t);for(let c=0,d=a.length;c<d;c++)s=a[c],!i[s].get&&(r=t[s],(n=be(r,e))!==r&&(t[s]=n))}return t}function Je(t,e){let o=t[e];return o||Object.defineProperty(t,e,{value:o=Object.create(null)}),o}function _e(t,e,o){if(t[e])return t[e];const[n,r]=Ae(o,{equals:!1,internal:!0});return n.$=r,t[e]=n}function mn(t,e){const o=Reflect.getOwnPropertyDescriptor(t,e);return!o||o.get||!o.configurable||e===he||e===ye||(delete o.value,delete o.writable,o.get=()=>t[he][e]),o}function yo(t){Ze()&&_e(Je(t,ye),vo)()}function yn(t){return yo(t),Reflect.ownKeys(t)}const wn={get(t,e,o){if(e===Qe)return t;if(e===he)return o;if(e===ft)return yo(t),o;const n=Je(t,ye),r=n[e];let s=r?r():t[e];if(e===ye||e===Q||e==="__proto__")return s;if(!r){const a=Object.getOwnPropertyDescriptor(t,e);Ze()&&(typeof s!="function"||t.hasOwnProperty(e))&&!(a&&a.get)&&(s=_e(n,e,s)())}return Ce(s)?mo(s):s},has(t,e){return e===Qe||e===he||e===ft||e===ye||e===Q||e==="__proto__"?!0:(Ze()&&_e(Je(t,Q),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:yn,getOwnPropertyDescriptor:mn};function De(t,e,o,n=!1){if(!n&&t[e]===o)return;const r=t[e],s=t.length;o===void 0?(delete t[e],t[Q]&&t[Q][e]&&r!==void 0&&t[Q][e].$()):(t[e]=o,t[Q]&&t[Q][e]&&r===void 0&&t[Q][e].$());let a=Je(t,ye),i;if((i=_e(a,e,r))&&i.$(()=>o),Array.isArray(t)&&t.length!==s){for(let c=t.length;c<s;c++)(i=a[c])&&i.$();(i=_e(a,"length",s))&&i.$(t.length)}(i=a[vo])&&i.$()}function wo(t,e){const o=Object.keys(e);for(let n=0;n<o.length;n+=1){const r=o[n];De(t,r,e[r])}}function Cn(t,e){if(typeof e=="function"&&(e=e(t)),e=be(e),Array.isArray(e)){if(t===e)return;let o=0,n=e.length;for(;o<n;o++){const r=e[o];t[o]!==r&&De(t,o,r)}De(t,"length",n)}else wo(t,e)}function ke(t,e,o=[]){let n,r=t;if(e.length>1){n=e.shift();const a=typeof n,i=Array.isArray(t);if(Array.isArray(n)){for(let c=0;c<n.length;c++)ke(t,[n[c]].concat(e),o);return}else if(i&&a==="function"){for(let c=0;c<t.length;c++)n(t[c],c)&&ke(t,[c].concat(e),o);return}else if(i&&a==="object"){const{from:c=0,to:d=t.length-1,by:u=1}=n;for(let l=c;l<=d;l+=u)ke(t,[l].concat(e),o);return}else if(e.length>1){ke(t[n],e,[n].concat(o));return}r=t[n],o=[n].concat(o)}let s=e[0];typeof s=="function"&&(s=s(r,o),s===r)||n===void 0&&s==null||(s=be(s),n===void 0||Ce(r)&&Ce(s)&&!Array.isArray(s)?wo(r,s):De(t,n,s))}function q(...[t,e]){const o=be(t||{}),n=Array.isArray(o),r=mo(o);function s(...a){Te(()=>{n&&a.length===1?Cn(o,a[0]):ke(o,a)})}return[r,s]}const et=new WeakMap,Co={get(t,e){if(e===Qe)return t;const o=t[e];let n;return Ce(o)?et.get(o)||(et.set(o,n=new Proxy(o,Co)),n):o},set(t,e,o){return De(t,e,be(o)),!0},deleteProperty(t,e){return De(t,e,void 0,!0),!0}};function vt(t){return e=>{if(Ce(e)){let o;(o=et.get(e))||et.set(e,o=new Proxy(e,Co)),t(o)}return e}}class Z{constructor(e){v(this,"store"),this.store=q(e??[])}get array(){return this.store[0]}get length(){return this.store[0].length}at(e){return this.store[0].at(e)}forEach(e){this.store[0].forEach(e)}filter(e){return this.store[0].filter(e)}filterInPlace(e){this.store[1](this.filter(e))}map(e){return this.store[0].map(e)}flatMap(e){return this.store[0].flatMap(e)}find(e){return this.store[0].find(e)}findIndex(e){return this.store[0].findIndex(e)}splice(e,o,...n){this.store[1](this.store[0].splice(e,o,...n))}reduce(e,o){return this.store[0].reduce(e,o)}some(e){return this.store[0].some(e)}every(e){return this.store[0].every(e)}get(e){return this.store[0][e]}set(e,o){this.store[1](e,o)}push(e){this.store[1](this.store[0].length,e)}}class W{constructor(e=-1){v(this,"changes"),v(this,"currentChangeIndex",-1),v(this,"maxChanges"),this.maxChanges=e,this.changes=[]}serialize(){return{changes:this.changes,currentChangeIndex:this.currentChangeIndex,maxChanges:this.maxChanges}}deserialize(e){this.changes=e.changes,this.currentChangeIndex=e.currentChangeIndex,this.maxChanges=e.maxChanges}addChange(e){this.changes=this.changes.slice(0,this.currentChangeIndex+1),this.changes.length===this.maxChanges&&this.changes.shift(),this.changes.push(e),this.currentChangeIndex=this.changes.length-1}undo(){if(this.currentChangeIndex===-1)return!1;const e=this.changes[this.currentChangeIndex].historyGroup;for(;this.currentChangeIndex>-1&&this.changes[this.currentChangeIndex].historyGroup===e;)this.changes[this.currentChangeIndex].undoChange(),this.currentChangeIndex--;return!0}redo(){if(this.currentChangeIndex===this.changes.length-1)return!1;const e=this.changes[this.currentChangeIndex+1].historyGroup;for(;this.currentChangeIndex<this.changes.length-1&&this.changes[this.currentChangeIndex+1].historyGroup===e;)this.currentChangeIndex++,this.changes[this.currentChangeIndex].applyChange();return!0}static evaluateHistoryGroup(e=!0){return typeof e=="boolean"?e?crypto.randomUUID():!1:e}}class bo{constructor(e){v(this,"nodeflowData"),v(this,"getHorizontalCurve",(o,n)=>h.of((n.x-o.x)/1.5,0)),v(this,"getVerticalCurve",(o,n)=>h.of(0,(n.y-o.y)/1.5)),v(this,"createDefaultCurvePath",(o,n,r,s)=>`M ${o.x} ${o.y} C ${r.x} ${r.y}, ${s.x} ${s.y}, ${n.x} ${n.y}`),this.nodeflowData=e}calculateCurveAnchors(e,o,n,r){const s=e.distanceTo(o)/300,a=n.add(e.subtract(n).multiplyBy(s)),i=r.add(o.subtract(r).multiplyBy(s));return{anchorStart:a,anchorEnd:i}}}class bn{constructor(e){v(this,"store"),this.store=q(e)}get css(){return this.store[0].css}get destinationConnector(){return this.store[0].destinationConnector}get path(){return this.store[0].path}set css(e){this.store[1]({css:e})}set path(e){this.store[1]({path:e})}set destinationConnector(e){this.store[1]({destinationConnector:e})}update(e){this.store[1](e)}updateWithPrevious(e){this.store[1](e)}}const Me=(...t)=>{const e=t[0];return t.slice(1).reduce((o,n)=>new Set([...o].filter(r=>n.has(r))),e)},ve=t=>t.size===0,J=t=>typeof t!="object"||t===null||t===void 0?t:Array.isArray(t)?t.map(J):typeof t=="object"?Object.fromEntries(Object.entries(t).map(([e,o])=>[e,J(o)])):t;class St{constructor(e){v(this,"store"),this.store=q(e)}serialize(){return{css:this.css,hovered:this.hovered,id:this.id,position:this.position.serialize()}}serializeConnections(){return[...this.destinations.map(({destinationConnector:e,css:o})=>({sourceNodeId:this.parentNode.id,sourceConnectorId:this.id,destinationNodeId:e.parentNode.id,destinationConnectorId:e.id,css:J(o)})),...this.sources.map(({sourceConnector:e})=>{var o;return{sourceNodeId:e.parentNode.id,sourceConnectorId:e.id,destinationNodeId:this.parentNode.id,destinationConnectorId:this.id,css:J((o=e.destinations.find(n=>n.destinationConnector.parentNode.id===this.parentNode.id))==null?void 0:o.css)}})]}static deserialize(e,o){const n=!e.id||o.connectors.has(e.id)?o.parentNode.getNextFreeConnectorId():e.id;return new St({css:e.css,destinations:new Z,hovered:e.hovered??!1,id:n,parentSection:o,position:h.deserializeOrDefault(e.position),ref:void 0,resizeObserver:void 0,size:h.zero(),sources:new Z})}get css(){return this.store[0].css}values(){return this.store[0]}get destinations(){return this.store[0].destinations}get hovered(){return this.store[0].hovered}get id(){return this.store[0].id}get parentSection(){return this.store[0].parentSection}get parentNode(){return this.store[0].parentSection.parentNode}get position(){return this.store[0].position}get ref(){return this.store[0].ref}get resizeObserver(){return this.store[0].resizeObserver}get size(){return this.store[0].size}get sources(){return this.store[0].sources}set css(e){this.store[1]({css:e})}set destinations(e){this.store[1]({destinations:e})}set hovered(e){this.store[1]({hovered:e})}set id(e){this.store[1]({id:e})}set parentSection(e){this.store[1]({parentSection:e})}set position(e){this.store[1]({position:e})}set ref(e){this.store[1]({ref:e})}set resizeObserver(e){this.store[1]({resizeObserver:e})}set size(e){this.store[1]({size:e})}set sources(e){this.store[1]({sources:e})}update(e){this.store[1](e)}updateWithPrevious(e){this.store[1](e)}removeIncomingConnections(){this.sources.forEach(({sourceConnector:e})=>{e.destinations.filterInPlace(({destinationConnector:o})=>o.parentNode.id!==this.id)}),this.sources=new Z}removeOutgoingConnections(){this.destinations.forEach(({destinationConnector:e})=>{e.sources.filterInPlace(({sourceConnector:o})=>o.parentNode.id!==this.id)}),this.destinations=new Z}getCenter(){const{position:e,offset:o}=this.parentNode;return e.add(o,this.position,this.size.divideBy(2))}}const Do=class Le{constructor(){v(this,"nodeflows"),v(this,"globalEventStore"),this.nodeflows=new Map,this.globalEventStore={onMouseMoveInDocument:new lt,onPointerLeaveFromDocument:new lt,onPointerUpInDocument:new lt},this.setupDefaultEventHandlers()}static get(){return this.instance||(Le.instance=new Le),Le.instance}createCanvas(...e){const o=new zn(...e);return this.nodeflows.set(e[0],o),[o,vn(o)]}getNodeflow(e){return this.nodeflows.get(e)}removeNodeflow(e){this.nodeflows.delete(e)}clear(){this.nodeflows.clear()}hasNodeflow(e){return this.nodeflows.has(e)}setupDefaultEventHandlers(){document.onmousemove=e=>this.globalEventStore.onMouseMoveInDocument.publish({event:e}),document.onpointerleave=e=>this.globalEventStore.onPointerLeaveFromDocument.publish({event:e}),document.onpointerup=e=>this.globalEventStore.onPointerUpInDocument.publish({event:e}),this.globalEventStore.onMouseMoveInDocument.subscribeMultiple([{name:"update-mouse-position",event:({event:e})=>{this.nodeflows.forEach(o=>{o.mouseData.mousePosition=h.fromEvent(e)})}}]),this.globalEventStore.onPointerLeaveFromDocument.subscribeMultiple([{name:"reset-mouse-data",event:()=>{this.nodeflows.forEach(e=>{e.mouseData.reset()})}}]),this.globalEventStore.onPointerUpInDocument.subscribeMultiple([])}};v(Do,"instance");let O=Do;var Dn={equals:!1},Sn=Dn,oe,Rt,Ht=(Rt=class{constructor(t=Map){ht(this,oe,void 0),Zo(this,oe,new t)}dirty(t){var e;(e=S(this,oe).get(t))==null||e.$$()}dirtyAll(){for(const t of S(this,oe).values())t.$$()}track(t){if(!Ze())return;let e=S(this,oe).get(t);if(e)e.n++;else{const[o,n]=Ae(void 0,Sn);S(this,oe).set(t,e={$:o,$$:n,n:1})}wt(()=>{e.n--===1&&queueMicrotask(()=>e.n===0&&S(this,oe).delete(t))}),e.$()}},oe=new WeakMap,Rt),ne=Symbol("track-keys"),G,Y,Vt,Se=(Vt=class extends Map{constructor(t){if(super(),ht(this,G,new Ht),ht(this,Y,new Ht),t)for(const e of t)super.set(e[0],e[1])}has(t){return S(this,G).track(t),super.has(t)}get(t){return S(this,Y).track(t),super.get(t)}get size(){return S(this,G).track(ne),super.size}*keys(){for(const t of super.keys())S(this,G).track(t),yield t;S(this,G).track(ne)}*values(){for(const[t,e]of super.entries())S(this,Y).track(t),yield e;S(this,G).track(ne)}*entries(){for(const t of super.entries())S(this,Y).track(t[0]),yield t;S(this,G).track(ne)}set(t,e){return Te(()=>{if(super.has(t)){if(super.get(t)===e)return}else S(this,G).dirty(t),S(this,G).dirty(ne);S(this,Y).dirty(t),super.set(t,e)}),this}delete(t){const e=super.delete(t);return e&&Te(()=>{S(this,G).dirty(t),S(this,G).dirty(ne),S(this,Y).dirty(t)}),e}clear(){super.size&&Te(()=>{for(const t of super.keys())S(this,G).dirty(t),S(this,Y).dirty(t);super.clear(),S(this,G).dirty(ne)})}forEach(t){S(this,G).track(ne);for(const[e,o]of super.entries())S(this,Y).track(e),t(o,e,this)}[Symbol.iterator](){return this.entries()}},G=new WeakMap,Y=new WeakMap,Vt);class Nt{constructor(e,o){v(this,"store"),v(this,"nodeflowData"),this.nodeflowData=e,this.store=q(o)}serialize(){return{connectors:Object.fromEntries(Array.from(this.connectors.entries()).map(([e,o])=>[e,o.serialize()])),css:this.css,id:this.id}}static deserialize(e,o,n=!0){const r=W.evaluateHistoryGroup(n),s=!e.id||o.connectorSections.has(e.id)?o.getNextFreeConnectorSectionId():e.id,a=new Nt(o.nodeflow,{connectors:new Se,css:e.css,id:s,parentNode:o});for(const[i,c]of Object.entries(e.connectors??{}))a.addConnector({...c,id:i},r);return a}addConnector(e,o=!0){const n=St.deserialize(e,this);if(this.connectors.has(n.id))return this.connectors.get(n.id);const r=W.evaluateHistoryGroup(o);if(r){const s=n.serialize(),a=this.id,i=s.id,c=this.parentNode.id,d=this.nodeflowData.id;this.nodeflowData.changes.addChange({type:"add",source:"connector",applyChange:()=>{var u,l;(l=(u=O.get().getNodeflow(d))==null?void 0:u.nodes.get(c))==null||l.addConnector(a,s,!1)},undoChange:()=>{var u,l;(l=(u=O.get().getNodeflow(d))==null?void 0:u.nodes.get(c))==null||l.removeConnector(a,i,!1)},historyGroup:r})}return this.connectors.set(n.id,n),n}removeConnector(e,o=!0){if(!this.connectors.has(e))return;const n=this.connectors.get(e),r=W.evaluateHistoryGroup(o);if(r){const s=n.serialize(),a=this.id,i=s.id,c=this.parentNode.id,d=this.nodeflowData.id;this.nodeflowData.changes.addChange({type:"remove",source:"connector",applyChange:()=>{var u,l;(l=(u=O.get().getNodeflow(d))==null?void 0:u.nodes.get(c))==null||l.removeConnector(a,i,!1)},undoChange:()=>{var u,l;(l=(u=O.get().getNodeflow(d))==null?void 0:u.nodes.get(c))==null||l.addConnector(a,s,!1)},historyGroup:r})}this.connectors.delete(e)}get connectors(){return this.store[0].connectors}get css(){return this.store[0].css}get id(){return this.store[0].id}get parentNode(){return this.store[0].parentNode}set connectors(e){this.store[1]({connectors:e})}set css(e){this.store[1]({css:e})}set id(e){this.store[1]({id:e})}set parentNode(e){this.store[1]({parentNode:e})}update(e){this.store[1](e)}updateWithPrevious(e){this.store[1](e)}removeIncomingConnections(){this.connectors.forEach(e=>e.removeIncomingConnections())}removeOutgoingConnections(){this.connectors.forEach(e=>e.removeOutgoingConnections())}getSourceConnectors(){return Array.from(this.connectors.values()).flatMap(e=>e.sources.flatMap(o=>o.sourceConnector))}getDestinationConnectors(){return Array.from(this.connectors.values()).flatMap(e=>e.destinations.flatMap(o=>o.destinationConnector))}}class Nn{constructor(e){v(this,"store"),this.store=q(e)}get sourceConnector(){return this.store[0].sourceConnector}set sourceConnector(e){this.store[1]({sourceConnector:e})}update(e){this.store[1](e)}updateWithPrevious(e){this.store[1](e)}}class So{constructor(){v(this,"subscriptions",new Se),v(this,"blacklistFilters",new Se)}blacklist(e,o){this.blacklistFilters.set(e,o)}unblacklist(e){this.blacklistFilters.delete(e)}unblacklistMultiple(e){e.forEach(this.unblacklist)}clearBlacklist(){this.blacklistFilters.clear()}subscribe(e,o,n=0){this.subscriptions.set(e,{name:e,event:o,priority:n})}subscribeMultiple(e){e.forEach(({name:o,event:n,priority:r})=>this.subscribe(o,n,r))}unsubscribe(e){this.subscriptions.delete(e)}unsubsribeMultiple(e){e.forEach(this.unsubscribe)}publish(e){Array.from(this.subscriptions.values()).sort((o,n)=>n.priority-o.priority).filter(({name:o,priority:n})=>!Array.from(this.blacklistFilters.values()).some(r=>r(e,o,n))).map(({event:o})=>o).forEach(o=>o(e))}clear(){this.subscriptions.clear()}get size(){return this.subscriptions.size}get isEmpty(){return this.size===0}}class F extends So{constructor(e){super(),v(this,"nodeflowData"),this.nodeflowData=e}}class lt extends So{}class In{constructor(e){v(this,"store"),v(this,"nodeflowData"),this.nodeflowData=e,this.store=q({heldKeys:new Set})}get heldKeys(){return this.store[0].heldKeys}set heldKeys(e){this.store[1]({heldKeys:e})}releaseKey(e){this.store[1](vt(o=>o.heldKeys.delete(e)))}clearKeys(){this.store[1]({heldKeys:new Set})}pressKey(e){this.store[1](vt(o=>o.heldKeys.add(e)))}isActionPressed(e){return!ve(Me(this.heldKeys,e))}}class kn{constructor(e){v(this,"store"),v(this,"nodeflowData"),v(this,"selectNode",(o,n,r=!0)=>{if(!this.nodeflowData.nodes.has(o))return;const s=this.nodeflowData.nodes.get(o);this.hasSelectedNode(o)&&this.selections.filterInPlace(a=>a.type!=="node"||a.node.id!==o),this.selections.push({node:s,type:"node"}),this.update({pointerDown:r,mousePosition:n,clickStartPosition:n.divideBy(this.nodeflowData.zoomLevel).subtract(this.nodeflowData.nodes.get(o).position)})}),v(this,"clearSelections",()=>{this.store[1]("selections",new Z),this.nodeflowData.resetMovement()}),v(this,"startCreatingConnection",(o,n,r)=>{if(!this.nodeflowData.settings.canCreateConnections)return;const s=this.nodeflowData.nodes.get(o);if(!s)return;const a=s.getConnector(r);a&&this.update({pointerDown:!0,selections:new Z([{connector:a,type:"connector"}]),mousePosition:n,clickStartPosition:n.divideBy(this.nodeflowData.zoomLevel).subtract(s.position)})}),v(this,"globalMousePosition",()=>this.mousePosition.subtract(this.nodeflowData.startPosition).divideBy(this.nodeflowData.zoomLevel).subtract(this.nodeflowData.position)),this.nodeflowData=e,this.store=q({clickStartPosition:void 0,mousePosition:h.zero(),pointerDown:!1,selections:new Z})}serialize(){var e;const o=this.store[0].selections.map(n=>{switch(n.type){case"connector":return{connectorId:n.connector.id,nodeId:n.connector.parentNode.id,type:"connector"};case"node":return{nodeId:n.node.id,type:"node"};case"connection":return{connection:{destinationConnectorId:n.connection.destinationConnector.id,destinationNodeId:n.connection.destinationConnector.parentSection.parentNode.id,sourceConnectorId:n.connection.sourceConnector.id,sourceNodeId:n.connection.sourceConnector.parentNode.id},type:"connection"};default:return{type:"nodeflow"}}});return{clickStartPosition:(e=this.clickStartPosition)==null?void 0:e.serialize(),selections:o}}deserialize(e){const o=e.selections.map(n=>{if(n.type==="connector"){const r=this.nodeflowData.nodes.get(n.nodeId);if(!r)return;const s=r.getConnector(n.connectorId);return s?{connector:s,type:"connector"}:void 0}else if(n.type==="node"){const r=this.nodeflowData.nodes.get(n.nodeId);return r?{node:r,type:"node"}:void 0}else if(n.type==="connection"){const r=this.nodeflowData.nodes.get(n.connection.sourceNodeId);if(!r)return;const s=r.getConnector(n.connection.sourceConnectorId);if(!s)return;const a=this.nodeflowData.nodes.get(n.connection.destinationNodeId);if(!a)return;const i=a.getConnector(n.connection.destinationConnectorId);return i?{connection:{destinationConnector:i,sourceConnector:s},type:"connection"}:void 0}else return{type:"nodeflow"}}).filter(Boolean);this.update({clickStartPosition:h.deserializeOrDefault(e.clickStartPosition),selections:new Z(o)})}get clickStartPosition(){return this.store[0].clickStartPosition}get isDraggingObject(){return this.store[0].pointerDown}get selections(){return this.store[0].selections}get heldConnections(){return this.store[0].selections.filter(e=>e.type==="connection")}get heldConnectors(){return this.store[0].selections.filter(e=>e.type==="connector")}get heldNodes(){return this.store[0].selections.filter(e=>e.type==="node")}filterSelections(e){this.selections.filterInPlace(e)}get mousePosition(){return this.store[0].mousePosition}get pointerDown(){return this.store[0].pointerDown}set clickStartPosition(e){this.store[1]({clickStartPosition:e})}set mousePosition(e){this.store[1]({mousePosition:e})}set pointerDown(e){this.store[1]({pointerDown:e})}update(e){this.store[1](e)}updateWithPrevious(e){this.store[1](e)}reset(e=!1){this.update({clickStartPosition:void 0,pointerDown:e,selections:new Z})}selectNodeflow(){this.hasSelectedNodeflow()&&this.selections.filterInPlace(e=>e.type!=="nodeflow"),this.selections.push({type:"nodeflow"})}clearSelectedByType(e){this.store[0].selections.filterInPlace(o=>o.type!==e)}hasSelectedNodeflow(){return this.store[0].selections.some(e=>e.type==="nodeflow")}hasSelectedNode(e){return this.store[0].selections.some(o=>o.type==="node"&&o.node.id===e)}hasSelectedConnector(e){return this.store[0].selections.some(o=>o.type==="connector"&&o.connector.id===e)}hasSelectedConnection(e,o,n,r){return this.store[0].selections.some(s=>s.type==="connection"&&s.connection.sourceConnector.id===o&&s.connection.sourceConnector.parentNode.id===e&&s.connection.destinationConnector.id===r&&s.connection.destinationConnector.parentNode.id===n)}}class Mn{constructor(e,o=2048){v(this,"store"),v(this,"nodeflowData"),this.nodeflowData=e,this.store=q({chunkSize:o,chunks:new Se})}get chunkSize(){return this.store[0].chunkSize}set chunkSize(e){this.store[1]({chunkSize:e})}get chunks(){return this.store[0].chunks}set chunks(e){this.store[1]({chunks:e})}addNodeToChunk(e,o){const n=this.calculateChunkPosition(o),r=this.chunks.get(n)||new Set;r.add(e),this.chunks.set(n,r)}removeNodeFromChunk(e,o){const n=this.calculateChunkPosition(o),r=this.chunks.get(n);r&&(r.delete(e),this.chunks.set(n,r))}updateNodeInChunk(e,o,n){const r=this.calculateChunkPosition(o),s=this.calculateChunkPosition(n);r!=s&&ze(()=>{const a=this.chunks.get(r),i=this.chunks.get(s)||new Set;a&&(a.delete(e),this.chunks.set(r,a),ve(a)&&this.chunks.delete(r)),i&&(i.add(e),this.chunks.set(s,i))})}getChunk(e){return this.chunks.get(this.calculateChunkPosition(e))||new Set}calculateChunkPosition(e){return h.of(Math.floor(e.x/this.chunkSize),Math.floor(e.y/this.chunkSize)).hashCode()}checkForCollisions(e){if(!this.nodeflowData.settings.allowCollision)return[];const o=this.nodeflowData.nodes.get(e),n=[];if(!o)return n;for(let r=-1;r<2;++r)for(let s=-1;s<2;++s){const a=this.getChunk(o.rectWithOffset.position.add(h.of(r*this.chunkSize,s*this.chunkSize)));a.size>0&&n.push(...a)}return n.filter(r=>{const s=this.nodeflowData.nodes.get(r);return s?.id==o.id?!1:s&&s.id!=o.id&&s.rectWithOffset.intersects(o.rectWithOffset)})}}const[tt,xn]=Ae(h.of(window.innerWidth,window.innerHeight));ze(()=>{const t=()=>xn(h.of(window.innerWidth,window.innerHeight));return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)});const dt=(t,e,o)=>Math.min(Math.max(t,e),o);class we{constructor(e,o,n,r){v(this,"position"),v(this,"size"),this.position=h.of(e,o),this.size=h.of(n,r)}static of(e,o){return new we(e.x,e.y,o.x,o.y)}static fromRect(e){return new we(e.position.x,e.position.y,e.size.x,e.size.y)}copy(){return we.fromRect(this)}get center(){return this.position.add(this.size.divideBy(2))}intersects(e){return this.position.x<e.position.x+e.size.x&&this.position.x+this.size.x>e.position.x&&this.position.y<e.position.y+e.size.y&&this.position.y+this.size.y>e.position.y}}class It{constructor(e,o){v(this,"store"),v(this,"nodeflowData"),this.nodeflowData=e,this.store=q(o),this.nodeflowData.chunking.addNodeToChunk(this.id,this.getCenter()),ze(()=>{const n=this.getCollidingNodes();n.length>0&&ze(()=>{n.forEach(r=>{const s=this.nodeflowData.nodes.get(r);if(s){const a=s.rectWithOffset,i=this.rectWithOffset;if(a.intersects(i)){const c=a.center.subtract(i.center).magnitude,d=a.center.subtract(i.center).normalize();this.position=this.position.subtract(d.multiplyBy(c))}}})})})}get nodeflow(){return this.nodeflowData}get centered(){return this.store[0].centered}get connectorSections(){return this.store[0].connectorSections}get css(){return this.store[0].css}get customData(){return this.store[0].customData}get display(){return this.store[0].display}get id(){return this.store[0].id}get offset(){return this.store[0].offset}get position(){return this.store[0].position}get ref(){return this.store[0].ref}get resizeObserver(){return this.store[0].resizeObserver}get size(){return this.store[0].size}set centered(e){this.store[1]({centered:e})}set connectorSections(e){this.store[1]({connectorSections:e})}set css(e){this.store[1]({css:e})}set customData(e){this.store[1]({customData:e})}set display(e){this.store[1]({display:e})}set id(e){this.store[1]({id:e})}set offset(e){this.store[1]({offset:e})}set position(e){this.store[1]({position:e})}set ref(e){this.store[1]({ref:e})}set resizeObserver(e){this.store[1]({resizeObserver:e})}set size(e){this.store[1]({size:e})}get sizeWithOffset(){return this.size.add(this.offset)}update(e){this.store[1](e)}serialize(){const e=Array.from(this.connectorSections.values()).reduce((o,n)=>(o[n.id]=n.serialize(),o),{});return{centered:this.centered,connectorSections:e,css:J(this.css),customData:J(this.customData),id:this.id,display:this.display,position:this.position.serialize()}}static deserialize(e,o,n=!0){const r=o.id??e.getNextFreeNodeId(),s=new It(e,{centered:o.centered??!1,connectorSections:new Se,css:J(o.css)??{},customData:J(o.customData)??{},display:o.display??(()=>{}),id:r,offset:h.zero(),position:h.deserializeOrDefault(o.position),ref:void 0,resizeObserver:void 0,size:h.zero()}),a=W.evaluateHistoryGroup(n);return Object.entries(o.connectorSections??[]).forEach(([i,c])=>{s.addConnectorSection({css:c.css,id:i,connectors:c.connectors},a)}),s}serializeConnections(){return Array.from(this.connectorSections.values()).flatMap(e=>Array.from(e.connectors.values()).flatMap(o=>o.serializeConnections()))}updateWithPrevious(e){this.store[1](e)}addConnectorSection(e,o=!0){const n=W.evaluateHistoryGroup(o),r=Nt.deserialize(e,this,n);if(this.connectorSections.has(r.id))return this.connectorSections.get(r.id);if(n){const s=r.serialize(),a=this.nodeflowData.id,i=this.id,c=s.id;this.nodeflowData.changes.addChange({type:"remove",source:"connector-section",applyChange:()=>{var d,u;(u=(d=O.get().getNodeflow(a))==null?void 0:d.nodes.get(i))==null||u.addConnectorSection(s,!1)},undoChange:()=>{var d,u;(u=(d=O.get().getNodeflow(a))==null?void 0:d.nodes.get(i))==null||u.removeConnectorSection(c,!1)},historyGroup:n})}return this.connectorSections.set(r.id,r),r}removeConnectorSection(e,o=!0){if(!this.connectorSections.has(e))return;const n=this.connectorSections.get(e),r=W.evaluateHistoryGroup(o);if(r){const s=n.serialize(),a=this.nodeflowData.id,i=this.id;this.nodeflowData.changes.addChange({type:"remove",source:"connector-section",applyChange:()=>{var c,d;(d=(c=O.get().getNodeflow(a))==null?void 0:c.nodes.get(i))==null||d.removeConnectorSection(e,!1)},undoChange:()=>{var c,d;(d=(c=O.get().getNodeflow(a))==null?void 0:c.nodes.get(i))==null||d.addConnectorSection(s,!1)},historyGroup:r})}this.connectorSections.delete(e)}getConnectorCount(){return Array.from(this.connectorSections.values()).reduce((e,o)=>e+o.connectors.size,0)}addConnector(e,o,n=!0){if(this.connectorSections.has(e))return this.connectorSections.get(e).addConnector(o,n)}removeConnector(e,o,n=!0){this.connectorSections.has(e)&&this.connectorSections.get(e).removeConnector(o,n)}getConnector(e){var o;return(o=this.getSectionFromConnector(e))==null?void 0:o.connectors.get(e)}getTotalConnectedInputs(e){var o;return((o=this.getConnector(e))==null?void 0:o.sources.length)??0}getAllConnectors(){return Array.from(this.connectorSections.values()).reduce((e,o)=>e.concat(Array.from(o.connectors.values())),[])}getNextFreeConnectorSectionId(){let e="0";for(let o=1;this.connectorSections.has(e);++o)e=o.toString();return e}getNextFreeConnectorId(){let e="0";for(let o=1;Array.from(this.connectorSections.values()).some(n=>n.connectors.has(e));++o)e=o.toString();return e}removeIncomingConnections(){this.connectorSections.forEach(e=>e.removeIncomingConnections())}removeOutgoingConnections(){this.connectorSections.forEach(e=>e.removeOutgoingConnections())}getAllSourceConnectors(){return Array.from(this.connectorSections.values()).reduce((e,o)=>e.concat(o.getSourceConnectors()),[])}getAllDestinationConnectors(){return Array.from(this.connectorSections.values()).reduce((e,o)=>e.concat(o.getDestinationConnectors()),[])}getAllSourceConnections(){return this.getAllSourceConnectors().map(e=>e.destinations.filter(o=>o.destinationConnector.parentNode.id===this.id).map(o=>({sourceNodeId:e.parentNode.id,sourceConnectorId:e.id,destinationNodeId:o.destinationConnector.parentNode.id,destinationConnectorId:o.destinationConnector.id,css:o.css}))).flat()}getAllDestinationConnections(){return this.getAllDestinationConnectors().map(e=>e.sources.filter(o=>o.sourceConnector.parentNode.id===this.id).map(o=>({sourceNodeId:o.sourceConnector.parentNode.id,sourceConnectorId:o.sourceConnector.id,destinationNodeId:e.parentNode.id,destinationConnectorId:e.id}))).flat()}getAllSourceNodes(){return this.getAllSourceConnectors().map(e=>e.parentNode)}getAllDestinationNodes(){return this.getAllDestinationConnectors().map(e=>e.parentNode)}getSectionFromConnector(e){return Array.from(this.connectorSections.values()).find(o=>o.connectors.get(e))}getCenter(){return this.position.add(this.offset,this.size.divideBy(2))}select(e){this.nodeflowData.selectNode(this.id,e)}get rect(){return we.of(this.position,this.size)}get rectWithOffset(){return we.of(this.position.subtract(this.offset),this.size.add(this.offset.multiplyBy(2)))}getCollidingNodes(){return this.nodeflowData.chunking.checkForCollisions(this.id)}isColliding(){return this.getCollidingNodes().length>0}}const Ie={LEFT:0,MIDDLE:1,RIGHT:2,BACK:3,FORWARD:4},No=class Io{constructor(e,o={},n){v(this,"store"),v(this,"changes"),v(this,"mouseData"),v(this,"keyboardData"),v(this,"curveFunctions"),v(this,"settingsStore"),v(this,"nodes"),v(this,"eventStore"),v(this,"chunking"),v(this,"id"),v(this,"keymap",{MOVE_DOWN:new Set(["ArrowDown","KeyS"]),MOVE_LEFT:new Set(["ArrowLeft","KeyA"]),MOVE_RIGHT:new Set(["ArrowRight","KeyD"]),MOVE_UP:new Set(["ArrowUp","KeyW"]),SELECT_MULTIPLE:new Set(["ShiftLeft","ShiftRight"])}),v(this,"resetMovement",()=>{this.currentMoveSpeed=h.zero(),this.keymap.MOVE_LEFT.forEach(r=>this.keyboardData.releaseKey(r)),this.keymap.MOVE_RIGHT.forEach(r=>this.keyboardData.releaseKey(r)),this.keymap.MOVE_UP.forEach(r=>this.keyboardData.releaseKey(r)),this.keymap.MOVE_DOWN.forEach(r=>this.keyboardData.releaseKey(r))}),v(this,"updateZoom",(r,s)=>{const a=this.zoomLevel;if(r===0)return;const i=Number(dt(r>0?a+a*r*this.settings.zoomMultiplier:a/(1-r*this.settings.zoomMultiplier),this.settings.minZoom,this.settings.maxZoom).toFixed(4));this.mouseData.pointerDown=!1;const c=this.size,d=s.subtract(this.startPosition),u=c.multiplyBy(a),l=c.multiplyBy(i),f=d.subtract(u.divideBy(2)).divideBy(a),g=d.subtract(l.divideBy(2)).divideBy(i);this.updateWithPrevious(p=>({position:p.position.subtract(f).add(g),zoomLevel:i}))}),this.id=e,this.settingsStore=q({...Io.DEFAULT_SETTINGS,...o}),this.curveFunctions=n?.(this)??new bo(this),this.store=q({currentMoveSpeed:h.zero(),position:h.zero(),startPosition:h.zero(),size:h.zero(),zoomLevel:1,pinchDistance:0}),this.changes=new W,this.mouseData=new kn(this),this.keyboardData=new In(this),this.nodes=new Se,this.chunking=new Mn(this),this.eventStore={onKeyDownInNodeflow:new F(this),onKeyUpInNodeflow:new F(this),onMouseDownInConnector:new F(this),onMouseDownInNodeflow:new F(this),onMouseDownInNode:new F(this),onMouseMoveInNodeflow:new F(this),onNodeConnected:new F(this),onNodeDataChanged:new F(this),onPointerDownInNodeCurve:new F(this),onPointerUpInConnector:new F(this),onPointerUpInNodeflow:new F(this),onPointerUpInNode:new F(this),onTouchMoveInNodeflow:new F(this),onTouchStartInConnector:new F(this),onTouchStartInNodeflow:new F(this),onTouchStartInNode:new F(this),onWheelInNodeflow:new F(this)},this.setupDefaultEventHandlers(),setInterval(()=>{const r=!ve(Me(this.keyboardData.heldKeys,this.keymap.MOVE_LEFT)),s=!ve(Me(this.keyboardData.heldKeys,this.keymap.MOVE_RIGHT)),a=!ve(Me(this.keyboardData.heldKeys,this.keymap.MOVE_UP)),i=!ve(Me(this.keyboardData.heldKeys,this.keymap.MOVE_DOWN)),c=this.mouseData.heldNodes.length>0;this.currentMoveSpeed=h.of(this.calculateDirectionalMovementAmount(r||s,this.currentMoveSpeed.x,s,r,!c),this.calculateDirectionalMovementAmount(a||i,this.currentMoveSpeed.y,i,a,!c)),!(this.currentMoveSpeed.x===0&&this.currentMoveSpeed.y===0)&&(this.settings.canPan&&!c?this.updateBackgroundPosition(this.currentMoveSpeed,!0):c&&this.settings.canMoveNodes&&this.updateHeldNodePosition(this.currentMoveSpeed.divideBy(this.zoomLevel)))},10)}serialize(){return{changes:this.changes.serialize(),connections:this.serializeConnections(),currentMoveSpeed:this.currentMoveSpeed.serialize(),mouseData:this.mouseData.serialize(),nodes:Object.fromEntries(Array.from(this.nodes.entries()).map(([e,o])=>[e,o.serialize()])),pinchDistance:this.pinchDistance,position:this.position.serialize(),size:this.size.serialize(),startPosition:this.startPosition.serialize(),zoomLevel:this.zoomLevel}}deserialize(e,o=!1){this.update({currentMoveSpeed:h.deserializeOrDefault(e.currentMoveSpeed),pinchDistance:e.pinchDistance,position:h.deserializeOrDefault(e.position),size:h.deserializeOrDefault(e.size),startPosition:h.deserializeOrDefault(e.startPosition),zoomLevel:e.zoomLevel});const n=W.evaluateHistoryGroup(o);this.nodes.clear(),Object.values(e.nodes).forEach(r=>{this.addNode(r,n)}),this.mouseData.deserialize(e.mouseData),e.connections.forEach(r=>{this.addConnection(r,n)}),this.changes.deserialize(e.changes)}serializeConnections(){return Array.from(this.nodes.values()).flatMap(e=>e.serializeConnections())}get settings(){return this.settingsStore[0]}updateSettings(e){this.settingsStore[1](e)}get currentMoveSpeed(){return this.store[0].currentMoveSpeed}get position(){return this.store[0].position}get startPosition(){return this.store[0].startPosition}get size(){return this.store[0].size}get zoomLevel(){return this.store[0].zoomLevel}get pinchDistance(){return this.store[0].pinchDistance}set currentMoveSpeed(e){this.store[1]({currentMoveSpeed:e})}set position(e){this.store[1]({position:e})}set startPosition(e){this.store[1]({startPosition:e})}set size(e){this.store[1]({size:e})}set zoomLevel(e){this.store[1]({zoomLevel:e})}set pinchDistance(e){this.store[1]({pinchDistance:e})}update(e){this.store[1](e)}updateWithPrevious(e){this.store[1](e)}center(){const e=tt().divideBy(2);return this.startPosition.add(e).divideBy(this.zoomLevel).subtract(this.position)}calculateDirectionalMovementAmount(e,o,n,r,s=!1){let a=o;if(e){const i=this.settings.movementAcceleration*(s?-1:1);a=dt(a+(n?i:0)-(r?i:0),-this.settings.maxMovementSpeed,this.settings.maxMovementSpeed)}else a=dt(a*this.settings.movementDeceleration,-this.settings.maxMovementSpeed,this.settings.maxMovementSpeed);return a<=.1&&a>=-.1&&(a=0),a}updateBackgroundPosition(e,o=!1){!this.mouseData.hasSelectedNodeflow()||o===this.mouseData.isDraggingObject||this.updateWithPrevious(n=>({position:n.position.add(e.divideBy(this.zoomLevel))}))}addNode(e,o=!0){const n=W.evaluateHistoryGroup(o),r=It.deserialize(this,e,n);if(this.nodes.set(r.id,r),n){const s=r.serializeConnections(),a=r.serialize(),i=this.id;this.changes.addChange({type:"add",source:"node",applyChange:()=>{const c=O.get().getNodeflow(i);c?.addNode(a,!1),s.forEach(d=>{c?.addConnection(d,!1)})},undoChange:()=>{var c;(c=O.get().getNodeflow(i))==null||c.removeNode(r.id,!1)},historyGroup:n})}return r}updateNode(e,o,n=!0){if(!this.nodes.has(e))return;const r=this.nodes.get(e),s=W.evaluateHistoryGroup(n);if(s){const a=this.nodes.get(e),i=a.serialize(),c=a.serializeConnections(),d=this.id,u=Object.entries(i).reduce((l,[f,g])=>(f in o&&Object.assign(l,{[f]:J(g)}),l),{});this.changes.addChange({type:"update",source:"node",applyChange:()=>{var l;(l=O.get().getNodeflow(d))==null||l.updateNode(e,o,!1)},undoChange:()=>{const l=O.get().getNodeflow(d);l?.updateNode(e,u,!1),c.forEach(f=>{l?.addConnection(f,!1)})},historyGroup:s})}r.updateWithPrevious(vt(a=>Object.assign(a,o))),this.eventStore.onNodeDataChanged.publish({nodeId:e,data:o})}removeNode(e,o=!0){if(!this.nodes.has(e))return;this.mouseData.filterSelections(r=>r.type!=="node"||r.node.id!==e);const n=W.evaluateHistoryGroup(o);if(n){const r=this.nodes.get(e),s=r.serializeConnections(),a=this.id;this.changes.addChange({type:"remove",source:"node",applyChange:()=>{var i;(i=O.get().getNodeflow(a))==null||i.removeNode(e,!1)},undoChange:()=>{const i=O.get().getNodeflow(a);i?.addNode(r.serialize(),!1),s.forEach(c=>{i?.addConnection(c,!1)})},historyGroup:n})}this.removeIncomingConnections(e),this.removeOutgoingConnections(e),this.nodes.delete(e)}removeIncomingConnections(e){this.nodes.has(e)&&this.nodes.get(e).connectorSections.forEach(o=>{o.connectors.forEach(n=>{n.sources.forEach(({sourceConnector:r})=>{r.destinations.filterInPlace(({destinationConnector:s})=>s.parentNode.id!==e)}),n.sources=new Z})})}removeOutgoingConnections(e){this.nodes.has(e)&&this.nodes.get(e).connectorSections.forEach(o=>{o.connectors.forEach(n=>{n.destinations.forEach(({destinationConnector:r})=>{r.sources.filterInPlace(({sourceConnector:s})=>s.parentNode.id!==e)}),n.destinations=new Z})})}getAllSourceConnectors(e){return this.nodes.has(e)?this.nodes.get(e).getAllSourceConnectors():[]}getAllDestinationConnectors(e){return this.nodes.has(e)?this.nodes.get(e).getAllDestinationConnectors():[]}getAllSourceConnections(e){return this.nodes.has(e)?this.nodes.get(e).getAllSourceConnections():[]}getAllDestinationConnections(e){return this.nodes.has(e)?this.nodes.get(e).getAllDestinationConnections():[]}getNextFreeNodeId(){let e="0";for(let o=1;this.nodes.has(e);++o)e=o.toString();return e}addConnection(e,o=!0){const{sourceNodeId:n,sourceConnectorId:r,destinationNodeId:s,destinationConnectorId:a,css:i}=e;if(!this.nodes.has(n)||!this.nodes.has(s))return;const c=this.nodes.get(n),d=this.nodes.get(s),u=c.getConnector(r),l=d.getConnector(a);if(!u||!l||u.destinations.some(g=>g.destinationConnector===l))return;const f=W.evaluateHistoryGroup(o);if(f){const g=this.id;this.changes.addChange({type:"add",source:"connection",applyChange:()=>this.addConnection(e,!1),undoChange:()=>{var p;return(p=O.get().getNodeflow(g))==null?void 0:p.removeConnection(n,r,s,a,!1)},historyGroup:f})}u.destinations.push(new bn({destinationConnector:l,css:i??{}})),l.sources.push(new Nn({sourceConnector:u}))}removeConnection(e,o,n,r,s=!0){var a;if(!this.nodes.has(e)||!this.nodes.has(n))return;const i=this.nodes.get(e),c=this.nodes.get(n),d=i.getConnector(o),u=c.getConnector(r);if(!d||!u)return;const l=W.evaluateHistoryGroup(s);if(l){const f=(a=d.destinations.find(N=>N.destinationConnector.parentNode.id===n))==null?void 0:a.css,g=this.id,p=()=>{var N;(N=O.get().getNodeflow(g))==null||N.addConnection({sourceNodeId:e,sourceConnectorId:o,destinationNodeId:n,destinationConnectorId:r,css:f},!1)},w=()=>{var N;(N=O.get().getNodeflow(g))==null||N.removeConnection(e,o,n,r,!1)};this.changes.addChange({type:"remove",source:"connection",applyChange:w,undoChange:p,historyGroup:l})}d.destinations.filterInPlace(f=>f.destinationConnector.parentNode.id!==n),u.sources.filterInPlace(f=>f.sourceConnector.parentNode.id!==e)}updateHeldNodePosition(e){this.mouseData.heldNodes.forEach(o=>o.node.updateWithPrevious(n=>({position:n.position.add(e)})))}setupDefaultEventHandlers(){this.eventStore.onNodeConnected.subscribeMultiple([{name:"nodeflow:create-connection",event:e=>this.addConnection({sourceNodeId:e.inputNodeId,sourceConnectorId:e.inputId,destinationNodeId:e.outputNodeId,destinationConnectorId:e.outputId})},{name:"nodeflow:reset-mouse-data",event:()=>this.mouseData.reset()}]),this.eventStore.onMouseMoveInNodeflow.subscribeMultiple([{name:"nodeflow:update-background-position",event:({event:e})=>{this.updateBackgroundPosition(h.of(e.movementX,e.movementY))}}]),this.eventStore.onPointerUpInNodeflow.subscribeMultiple([{name:"nodeflow:stop-propagation",event:({event:e})=>{e.stopPropagation(),e.preventDefault()}},{name:"nodeflow:reset-mouse-data",event:()=>{this.mouseData.pointerDown=!1,this.mouseData.heldConnectors.length===1&&this.mouseData.clearSelectedByType("node"),this.mouseData.clearSelectedByType("connector")}}]),this.eventStore.onTouchStartInNodeflow.subscribeMultiple([{name:"nodeflow:stop-propagation",event:({event:e})=>e.stopPropagation()},{name:"nodeflow:clear-held-keys",event:({event:e})=>{e.touches.length===1&&this.keyboardData.clearKeys()}},{name:"nodeflow:handle-pinch",event:({event:e})=>{const{touches:o}=e;if(o.length!==2)return;const{pageX:n,pageY:r}=e.touches[0],{pageX:s,pageY:a}=e.touches[1];this.pinchDistance=Math.hypot(n-s,r-a)}},{name:"nodeflow:update-mouse-data",event:({event:e})=>{const{touches:o}=e;if(o.length!==1)return;const n=o[0],r=h.fromEvent(n);this.mouseData.clearSelectedByType("node"),this.mouseData.update({pointerDown:!0,mousePosition:r,clickStartPosition:h.of(r.x/this.zoomLevel-this.position.x,r.y/this.zoomLevel-this.position.y)})}}]),this.eventStore.onTouchMoveInNodeflow.subscribeMultiple([{name:"nodeflow:handle-pinch",event:({event:e})=>{const{touches:o}=e;if(o.length!==2)return;const{pageX:n,pageY:r}=o[0],{pageX:s,pageY:a}=o[1],i=Math.hypot(n-s,r-a),c=h.of((n+s)/2,(r+a)/2);this.settings.canZoom&&this.updateZoom(i-this.pinchDistance,c),this.pinchDistance=i}},{name:"nodeflow:update-mouse-data",event:({event:e})=>{const{touches:o}=e;o.length===1&&this.mouseData.updateWithPrevious(n=>{const r=h.fromEvent(o[0]);return this.updateBackgroundPosition(r.subtract(n.mousePosition)),{mousePosition:r}})}}]),this.eventStore.onKeyUpInNodeflow.subscribe("nodeflow:remove-held-key",({event:e})=>this.keyboardData.releaseKey(e.code)),this.eventStore.onKeyDownInNodeflow.subscribeMultiple([{name:"nodeflow:add-held-key",event:({event:e})=>this.keyboardData.pressKey(e.code),priority:10},{name:"nodeflow:handle-controls",event:({event:e})=>{switch(e.code){case"Delete":if(this.mouseData.heldNodes.length>0&&this.settings.canDeleteNodes){const o=W.evaluateHistoryGroup();this.mouseData.heldNodes.forEach(n=>this.removeNode(n.node.id,o))}else if(this.mouseData.heldConnections.length>0&&this.settings.canDeleteConnections){const o=W.evaluateHistoryGroup();this.mouseData.heldConnections.forEach(n=>this.removeConnection(n.connection.sourceConnector.parentNode.id,n.connection.sourceConnector.id,n.connection.destinationConnector.parentSection.parentNode.id,n.connection.destinationConnector.id,o))}break;case"Escape":this.mouseData.clearSelections();break;case"Space":this.settings.debugMode&&(this.mouseData.selections.length>0?console.log(this.mouseData.selections):console.log(this.nodes));break;case"Equal":case"Minus":if(e.ctrlKey){if(!this.settings.canZoom)return;e.preventDefault(),this.updateZoom(this.settings.keyboardZoomMultiplier*(e.code==="Equal"?1:-1),tt().divideBy(2))}break;case"KeyZ":if(!e.ctrlKey)break;e.preventDefault(),e.shiftKey?this.changes.redo():this.changes.undo();break}}}]),this.eventStore.onWheelInNodeflow.subscribeMultiple([{name:"nodeflow:update-zoom",event:({event:e})=>{this.settings.canZoom&&this.updateZoom(-e.deltaY,h.fromEvent(e))}},{name:"nodeflow:prevent-scroll",event:({event:e})=>{e.preventDefault()}}]),this.eventStore.onMouseDownInNodeflow.subscribeMultiple([{name:"nodeflow:reset-movement",event:({event:e})=>{e.button===Ie.LEFT&&this.resetMovement()}},{name:"nodeflow:reset-mouse-data",event:({event:e})=>{e.button===Ie.LEFT&&this.mouseData.clearSelections(),this.mouseData.selectNodeflow(),this.mouseData.update({clickStartPosition:h.of(e.clientX/this.zoomLevel-this.position.x,e.clientY/this.zoomLevel-this.position.y),pointerDown:this.settings.canPan,mousePosition:h.fromEvent(e)})}},{name:"nodeflow:stop-propagation",event:({event:e})=>e.stopPropagation()}]),this.eventStore.onMouseDownInConnector.blacklist("nodeflow:allow-pan",(e,o)=>e.event.button!==Ie.LEFT&&o.startsWith("nodeflow")),this.eventStore.onMouseDownInConnector.subscribeMultiple([{name:"nodeflow:stop-propagation",event:({event:e})=>e.stopPropagation()},{name:"nodeflow:start-creating-connection",event:({event:e,nodeId:o,connectorId:n})=>{this.mouseData.startCreatingConnection(o,h.fromEvent(e),n)}}]),this.eventStore.onTouchStartInConnector.subscribeMultiple([{name:"nodeflow:stop-propagation",event:({event:e})=>e.stopPropagation()},{name:"nodeflow:start-creating-connection",event:({event:e,nodeId:o,connectorId:n})=>{const{clientX:r,clientY:s}=e.touches[0];this.mouseData.startCreatingConnection(o,h.of(r,s),n)}}]),this.eventStore.onPointerUpInConnector.subscribeMultiple([{name:"nodeflow:stop-propagation",event:({event:e})=>{e.preventDefault(),e.stopPropagation()},priority:2},{name:"nodeflow:connect-held-nodes",event:({event:e,nodeId:o,connectorId:n})=>{var r;if(!this.settings.canCreateConnections)return;const s=(r=this.mouseData.heldConnectors.at(-1))==null?void 0:r.connector,a=s?.parentNode;!s||!a||this.eventStore.onNodeConnected.publish({outputNodeId:a.id,outputId:s.id,inputNodeId:o,inputId:n,event:e})},priority:2},{name:"nodeflow:reset-mouse-data",event:()=>{this.mouseData.pointerDown=!1},priority:1}]),this.eventStore.onMouseDownInNode.blacklist("nodeflow:allow-pan",(e,o)=>e.event.button!==Ie.LEFT&&o.startsWith("nodeflow")),this.eventStore.onMouseDownInNode.subscribeMultiple([{name:"nodeflow:select-node",event:({event:e,nodeId:o})=>{this.keyboardData.isActionPressed(this.keymap.SELECT_MULTIPLE)||this.mouseData.clearSelections(),this.mouseData.selectNode(o,h.fromEvent(e),this.settings.canMoveNodes)}},{name:"nodeflow:stop-propagation",event:({event:e})=>e.stopPropagation()}]),this.eventStore.onTouchStartInNode.subscribeMultiple([{name:"nodeflow:select-node",event:({event:e,nodeId:o})=>{const{clientX:n,clientY:r}=e.touches[0];this.keyboardData.isActionPressed(this.keymap.SELECT_MULTIPLE)||this.mouseData.clearSelections(),this.mouseData.selectNode(o,h.of(n,r),this.settings.canMoveNodes)}},{name:"nodeflow:stop-propagation",event:({event:e})=>e.stopPropagation()}]),this.eventStore.onPointerDownInNodeCurve.blacklist("nodeflow:allow-pan",(e,o)=>e.event.button!==Ie.LEFT&&o.startsWith("nodeflow")),this.eventStore.onPointerDownInNodeCurve.subscribeMultiple([{name:"nodeflow:stop-propagation",event:({event:e})=>{e.preventDefault(),e.stopPropagation()},priority:1},{name:"nodeflow:update-mouse-data",event:({event:e,sourceConnector:o,destinationConnector:n})=>{this.mouseData.pointerDown=!0,this.mouseData.mousePosition=h.fromEvent(e),this.keyboardData.isActionPressed(this.keymap.SELECT_MULTIPLE)||this.mouseData.clearSelections(),this.mouseData.selections.push({type:"connection",connection:{sourceConnector:o,destinationConnector:n}})}}]),this.eventStore.onPointerUpInNode.subscribeMultiple([{name:"nodeflow:reset-mouse-data",event:()=>{this.mouseData.pointerDown=!1,this.mouseData.heldConnectors.length===1&&this.mouseData.clearSelectedByType("node"),this.mouseData.clearSelectedByType("connector")}},{name:"nodeflow:stop-propagation",event:({event:e})=>{e.stopPropagation(),e.preventDefault()}}])}selectNode(e,o){this.mouseData.selectNode(e,o??h.zero(),!1)}};v(No,"DEFAULT_SETTINGS",{allowCollision:!1,canAddNodes:!0,canCreateConnections:!0,canDeleteConnections:!0,canDeleteNodes:!0,canMoveNodes:!0,canPan:!0,canZoom:!0,debugMode:!1,keyboardZoomMultiplier:15,maxMovementSpeed:15,maxZoom:200,minZoom:.02,movementAcceleration:1.5,movementDeceleration:.85,zoomMultiplier:.005});let zn=No;const Pn="_fatherCurve_sfc2k_1",_n="_motherCurve_sfc2k_11",En="_selectedFatherCurve_sfc2k_21",$n="_selectedMotherCurve_sfc2k_28",An="_newFatherCurve_sfc2k_35",On="_newMotherCurve_sfc2k_42",me={fatherCurve:Pn,motherCurve:_n,selectedFatherCurve:En,selectedMotherCurve:$n,newFatherCurve:An,newMotherCurve:On},Fn="_nodeflow_1mhat_1",Tn={nodeflow:Fn},Ln="_femaleNode_ch6ac_1",Bn="_maleNode_ch6ac_21",jn="_selectedMaleNode_ch6ac_41",Gn="_selectedFemaleNode_ch6ac_60",Wn="_inputConnector_ch6ac_79",Kn="_maleOutputConnector_ch6ac_94",Un="_femaleOutputConnector_ch6ac_110",Rn="_inputsSection_ch6ac_126",Hn="_outputsSection_ch6ac_135",Vn="_nodeFont_ch6ac_144",T={femaleNode:Ln,maleNode:Bn,selectedMaleNode:jn,selectedFemaleNode:Gn,inputConnector:Wn,maleOutputConnector:Kn,femaleOutputConnector:Un,inputsSection:Rn,outputsSection:Hn,nodeFont:Vn};var Zn=A("<p>");const qn=t=>(()=>{var e=Zn();return $(e,()=>t.node.customData?.name),K(()=>I(e,T.nodeFont)),e})(),ko=async t=>await(await fetch(`https://randomuser.me/api/?inc=gender,name&noinfo&results=${t}`)).json().then(o=>o.results).then(o=>o.map(n=>({gender:n.gender==="female"?"F":"M",name:n.name.first+" "+n.name.last}))),Be=t=>({normal:t=="M"?me.fatherCurve:me.motherCurve,selected:t=="M"?me.selectedFatherCurve:me.selectedMotherCurve}),kt=(t,e,o)=>{const n=t,r=y.addNode({css:{normal:e==="M"?T.maleNode:T.femaleNode,selected:e==="M"?T.selectedMaleNode:T.selectedFemaleNode},position:o,customData:{gender:e,name:t},display:qn,centered:!0},n),s=r.addConnectorSection({id:"inputs",css:T.inputsSection},n);return r.addConnectorSection({id:"outputs",css:T.outputsSection},n).addConnector({id:"O",css:e==="M"?T.maleOutputConnector:T.femaleOutputConnector},n),s.addConnector({id:"I",css:T.inputConnector},n),r},Xn=async(t=50)=>{const e=await ko(t);for(const o of e)kt(o.name,o.gender,h.of((Math.random()*2-1)*2e3,(Math.random()*2-1)*2e3))},Yn=()=>{y.eventStore.onPointerUpInConnector.blacklist("familytree-app:prevent-connections-to-parent-connectors",({connectorId:t},e)=>t==="O"&&e==="nodeflow:connect-held-nodes"),y.eventStore.onTouchStartInConnector.blacklist("familytree-app:prevent-connections-from-parent-connectors",({connectorId:t})=>t==="I"),y.eventStore.onMouseDownInConnector.blacklist("familytree-app:prevent-connections-from-parent-connectors",({connectorId:t})=>t==="I"),y.eventStore.onPointerUpInNodeflow.subscribe("familytree-app:spawn-new-node",()=>{const t=y.mouseData.heldConnectors;if(t.length!==1)return;const e=t[0].connector.parentNode,o=y.mouseData.globalMousePosition();ko(1).then(n=>{const r=kt(n[0].name,n[0].gender,o);y.addConnection({sourceNodeId:e.id,sourceConnectorId:"O",destinationNodeId:r.id,destinationConnectorId:"I",css:Be(e.customData.gender)})})},1),y.eventStore.onNodeConnected.subscribe("nodeflow:create-connection",({outputNodeId:t,inputNodeId:e})=>{const o=y.nodes.get(t),n=y.nodes.get(e);if(t===e)return;const r=n.getConnector("I")?.sources;r?.length===2||r?.some(s=>s.sourceConnector.parentNode.customData.gender===o.customData.gender)||y.addConnection({sourceNodeId:t,sourceConnectorId:"O",destinationNodeId:e,destinationConnectorId:"I",css:Be(o.customData.gender)})}),y.eventStore.onPointerUpInNode.subscribe("nodeflow:create-connection",({nodeId:t})=>{const e=y.nodes.get(t);if(!e||y.mouseData.heldConnectors.length!==1)return;const o=y.mouseData.heldConnectors[0].connector.parentSection.parentNode;if(t===o.id)return;const n=e.getConnector("I")?.sources;n?.length===2||n?.some(r=>r.sourceConnector.parentNode.customData.gender===o.customData.gender)||y.addConnection({sourceNodeId:o.id,sourceConnectorId:"O",destinationNodeId:t,destinationConnectorId:"I",css:Be(o.customData.gender)})},2)},Qn=()=>{const t=y.nodes.size;for(let e=0;e<t;e++){const o=Math.floor(Math.random()*t),n=Math.floor(Math.random()*t);if(!y.nodes.has(o.toString())||!y.nodes.has(n.toString()))continue;const r=y.nodes.get(o.toString()),s=y.nodes.get(n.toString()),a=r.customData.gender,i=s.getConnector("I")?.sources;o===n||i?.length===2||i?.some(c=>c.sourceConnector.parentNode.customData.gender===a)||y.addConnection({sourceNodeId:o.toString(),sourceConnectorId:"O",destinationNodeId:n.toString(),destinationConnectorId:"I",css:Be(r.customData.gender)})}},Zt=t=>t?t.trim().replace(/\s+/g," "):"",Jn="_sidebar_o4wha_1",es="_sidebarContent_o4wha_100",je={"sidebar-container":"_sidebar-container_o4wha_1","sidebar-container-closed":"_sidebar-container-closed_o4wha_27",sidebar:Jn,"sidebar-toggle":"_sidebar-toggle_o4wha_52","sidebar-toggle-closed":"_sidebar-toggle-closed_o4wha_77",sidebarContent:es},ts="data:image/svg+xml,%3c!DOCTYPE%20svg%20PUBLIC%20'-//W3C//DTD%20SVG%201.1//EN'%20'http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd'%3e%3c!--%20Credits:%20https://www.svgrepo.com/svg/218171/right-arrow-next%20--%3e%3c!--%20Uploaded%20to:%20SVG%20Repo,%20www.svgrepo.com,%20Transformed%20by:%20SVG%20Repo%20Mixer%20Tools%20--%3e%3csvg%20fill='%23cbc6c1'%20height='256px'%20width='256px'%20version='1.1'%20id='Layer_1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20viewBox='-24.6%20-24.6%20541.20%20541.20'%20xml:space='preserve'%20stroke='%23cbc6c1'%20stroke-width='0.0049200400000000005'%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'/%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'%20stroke='%23595757'%20stroke-width='49.2004'%3e%3cg%3e%3cg%3e%3cpath%20d='M382.678,226.804L163.73,7.86C158.666,2.792,151.906,0,144.698,0s-13.968,2.792-19.032,7.86l-16.124,16.12%20c-10.492,10.504-10.492,27.576,0,38.064L293.398,245.9l-184.06,184.06c-5.064,5.068-7.86,11.824-7.86,19.028%20c0,7.212,2.796,13.968,7.86,19.04l16.124,16.116c5.068,5.068,11.824,7.86,19.032,7.86s13.968-2.792,19.032-7.86L382.678,265%20c5.076-5.084,7.864-11.872,7.848-19.088C390.542,238.668,387.754,231.884,382.678,226.804z'/%3e%3c/g%3e%3c/g%3e%3c/g%3e%3cg%20id='SVGRepo_iconCarrier'%3e%3cg%3e%3cg%3e%3cpath%20d='M382.678,226.804L163.73,7.86C158.666,2.792,151.906,0,144.698,0s-13.968,2.792-19.032,7.86l-16.124,16.12%20c-10.492,10.504-10.492,27.576,0,38.064L293.398,245.9l-184.06,184.06c-5.064,5.068-7.86,11.824-7.86,19.028%20c0,7.212,2.796,13.968,7.86,19.04l16.124,16.116c5.068,5.068,11.824,7.86,19.032,7.86s13.968-2.792,19.032-7.86L382.678,265%20c5.076-5.084,7.864-11.872,7.848-19.088C390.542,238.668,387.754,231.884,382.678,226.804z'/%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/svg%3e";var os=A('<div><div></div><img alt="Toggle sidebar">');const ns=t=>{const[e,o]=mt(!1);return(()=>{var n=os(),r=n.firstChild,s=r.nextSibling;return $(r,()=>t.children),s.$$click=()=>o(!e()),Ot(s,"src",ts),Ot(s,"draggable",!1),K(a=>{var i=je[e()?"sidebar-container":"sidebar-container-closed"],c=je.sidebar,d=je[e()?"sidebar-toggle":"sidebar-toggle-closed"];return i!==a.e&&I(n,a.e=i),c!==a.t&&I(r,a.t=c),d!==a.a&&I(s,a.a=d),a},{e:void 0,t:void 0,a:void 0}),n})()};nt(["click"]);const ss="_formButtonContainer_y6wad_1",rs="_displayContainer_y6wad_9",is="_fieldDisplayContainer_y6wad_37",as="_femaleFont_y6wad_57",cs="_maleFont_y6wad_61",ls="_radioInputFemale_y6wad_65",ds="_radioInputMale_y6wad_127",us="_horizontalRadioInput_y6wad_189",hs="_horizontalRadioContainer_y6wad_196",fs="_parentDisplayContainer_y6wad_204",ps="_parentDisplay_y6wad_204",gs="_invalidParent_y6wad_231",vs="_validMother_y6wad_235",ms="_validFather_y6wad_244",ys="_childrenDisplayContainer_y6wad_253",ws="_childrenDisplayWindow_y6wad_280",Cs="_child_y6wad_253",k={formButtonContainer:ss,displayContainer:rs,fieldDisplayContainer:is,femaleFont:as,maleFont:cs,radioInputFemale:ls,radioInputMale:ds,horizontalRadioInput:us,horizontalRadioContainer:hs,parentDisplayContainer:fs,parentDisplay:ps,invalidParent:gs,validMother:vs,validFather:ms,childrenDisplayContainer:ys,childrenDisplayWindow:ws,child:Cs};var bs=A("<div>"),Ds=A("<div><h2>Selected Node</h2><div><p>Name</p><p></p></div><div><p>Gender</p><p></p></div><div><div><p>Mother</p><p></p></div><div><p>Father</p><p></p></div></div><div><p>Children"),Ss=A("<p>None"),Ns=A("<p>");const Is=t=>{const e=V(()=>t.nodeData.getAllSourceConnectors().map(s=>s.parentNode)),o=V(()=>e().find(s=>s.customData.gender==="F")),n=V(()=>e().find(s=>s.customData.gender==="M")),r=V(()=>t.nodeData.getAllDestinationConnectors().map(s=>s.parentNode).sort((s,a)=>s.customData.name.localeCompare(a.customData.name)));return(()=>{var s=Ds(),a=s.firstChild,i=a.nextSibling,c=i.firstChild,d=c.nextSibling,u=i.nextSibling,l=u.firstChild,f=l.nextSibling,g=u.nextSibling,p=g.firstChild,w=p.firstChild,N=w.nextSibling,j=p.nextSibling,b=j.firstChild,C=b.nextSibling,D=g.nextSibling;return D.firstChild,$(d,()=>t.nodeData.customData.name),$(f,()=>t.nodeData.customData.gender==="F"?"Female":"Male"),N.$$click=()=>{o()?.nodeflow.mouseData.clearSelections(),o()?.select()},$(N,()=>o()?.customData.name||"Unknown"),C.$$click=()=>{n()?.nodeflow.mouseData.clearSelections(),n()?.select()},$(C,()=>n()?.customData.name||"Unknown"),$(D,z(se,{get when(){return r()?.length>0},get fallback(){return Ss()},get children(){var m=bs();return $(m,z(Wo,{get each(){return r()},children:R=>(()=>{var le=Ns();return le.$$click=()=>{R.nodeflow.mouseData.clearSelections(),R.select()},$(le,()=>R.customData.name),K(()=>I(le,k.child)),le})()})),K(()=>I(m,k.childrenDisplayWindow)),m}}),null),K(m=>{var R=k.displayContainer,le=k.fieldDisplayContainer,Mt=k.fieldDisplayContainer,xt=k[t.nodeData.customData.gender==="F"?"femaleFont":"maleFont"],zt=k.parentDisplayContainer,Pt=k.parentDisplay,Mo={[k.validMother]:!!o(),[k.invalidParent]:!o()},_t=k.parentDisplay,xo={[k.validFather]:!!n(),[k.invalidParent]:!n()},Et=k.childrenDisplayContainer;return R!==m.e&&I(s,m.e=R),le!==m.t&&I(i,m.t=le),Mt!==m.a&&I(u,m.a=Mt),xt!==m.o&&I(f,m.o=xt),zt!==m.i&&I(g,m.i=zt),Pt!==m.n&&I(p,m.n=Pt),m.s=Ft(N,Mo,m.s),_t!==m.h&&I(j,m.h=_t),m.r=Ft(C,xo,m.r),Et!==m.d&&I(D,m.d=Et),m},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),s})()};nt(["click"]);var ks=A("<button>Add"),qt=A("<button>Save"),Xt=A("<button>Cancel"),Ms=A("<button>Edit"),Yt=A("<button>Delete"),xs=A("<div>");const Qt=t=>(()=>{var e=ks();return e.$$click=()=>t.onClick(),e})(),zs=t=>{const e=()=>t.setFormData({name:""}),o=()=>t.setFormData(void 0),n=()=>t.setFormData({...t.nodeData}),r=()=>{y.removeNode(t.formData.id),t.setFormData(void 0)},s=()=>y.removeNode(t.nodeData.id),a=()=>{if(!t.formData?.name||!t.formData?.gender)return;const c=kt(Zt(t.formData.name),t.formData.gender,y.center());y.mouseData.clearSelections(),c.select(c.getCenter()),t.setFormData(void 0)},i=()=>{const c=t.formData.id,d=y.nodes.get(c);if(d===void 0){t.setFormData(void 0);return}const u=d.customData,l=Object.fromEntries(Object.entries(t.formData).map(([g,p])=>[g,typeof p=="string"?Zt(p):p]).filter(([g,p])=>g!=="id"&&!!p&&p!==u[g]));if(Object.keys(l).length===0){t.setFormData(void 0);return}const f={customData:{...u,...l}};"gender"in l&&Object.assign(f,{css:{normal:l.gender==="M"?T.maleNode:T.femaleNode,selected:l.gender==="M"?T.selectedMaleNode:T.selectedFemaleNode}}),y.updateNode(c,f),t.setFormData(void 0),"gender"in l&&(d.getConnector("O").css=l.gender==="M"?T.maleOutputConnector:T.femaleOutputConnector,y.removeOutgoingConnections(c))};return(()=>{var c=xs();return $(c,z(se,{get when(){return t.mode==="empty"},get children(){return z(Qt,{onClick:e})}}),null),$(c,z(se,{get when(){return t.mode==="add"},get children(){return[(()=>{var d=qt();return d.$$click=a,d})(),(()=>{var d=Xt();return d.$$click=o,d})()]}}),null),$(c,z(se,{get when(){return t.mode==="view"},get children(){return[z(Qt,{onClick:e}),(()=>{var d=Ms();return d.$$click=n,d})(),(()=>{var d=Yt();return d.$$click=s,d})()]}}),null),$(c,z(se,{get when(){return t.mode==="edit"},get children(){return[(()=>{var d=qt();return d.$$click=i,d})(),(()=>{var d=Xt();return d.$$click=o,d})(),(()=>{var d=Yt();return d.$$click=r,d})()]}}),null),K(()=>I(c,k.formButtonContainer)),c})()};nt(["click"]);var Ps=A('<svg fill=#0078ea height=256px width=256px version=1.1 id=Capa_1 xmlns=http://www.w3.org/2000/svg viewBox="-30.6 -30.6 673.20 673.20"stroke=#0078ea><g id=SVGRepo_bgCarrier stroke-width=0></g><g id=SVGRepo_tracerCarrier stroke-linecap=round stroke-linejoin=round stroke=#080808 stroke-width=36.71988><g><path d="M569.569,0H413.755c-23.403,0-42.377,18.973-42.377,42.375s18.973,42.375,42.377,42.375h53.51L348.501,203.513 c-36.655-24.899-79.878-38.296-125.165-38.296c-59.67,0-115.768,23.237-157.961,65.429c-87.098,87.102-87.098,228.824,0,315.922 c42.193,42.193,98.291,65.431,157.961,65.431s115.768-23.237,157.961-65.431c76.855-76.855,85.878-196.233,27.101-283.094 l118.797-118.795v53.51c0,23.403,18.973,42.375,42.375,42.375c23.405,0,42.375-18.973,42.375-42.375V42.375 C611.945,18.973,592.972,0,569.569,0z M321.369,486.64c-26.186,26.186-61.001,40.607-98.032,40.607s-71.846-14.421-98.032-40.607 c-54.054-54.056-54.054-142.009,0-196.066c26.186-26.186,61.001-40.605,98.032-40.605s71.848,14.421,98.032,40.605 C375.422,344.632,375.422,432.587,321.369,486.64z"></path></g></g><g id=SVGRepo_iconCarrier><g><path d="M569.569,0H413.755c-23.403,0-42.377,18.973-42.377,42.375s18.973,42.375,42.377,42.375h53.51L348.501,203.513 c-36.655-24.899-79.878-38.296-125.165-38.296c-59.67,0-115.768,23.237-157.961,65.429c-87.098,87.102-87.098,228.824,0,315.922 c42.193,42.193,98.291,65.431,157.961,65.431s115.768-23.237,157.961-65.431c76.855-76.855,85.878-196.233,27.101-283.094 l118.797-118.795v53.51c0,23.403,18.973,42.375,42.375,42.375c23.405,0,42.375-18.973,42.375-42.375V42.375 C611.945,18.973,592.972,0,569.569,0z M321.369,486.64c-26.186,26.186-61.001,40.607-98.032,40.607s-71.846-14.421-98.032-40.607 c-54.054-54.056-54.054-142.009,0-196.066c26.186-26.186,61.001-40.605,98.032-40.605s71.848,14.421,98.032,40.605 C375.422,344.632,375.422,432.587,321.369,486.64z">');const _s=()=>Ps();var Es=A('<svg fill=#ea0078 height=256px width=256px version=1.1 id=Capa_1 xmlns=http://www.w3.org/2000/svg viewBox="-23.86 -23.86 524.86 524.86"stroke=#cb3283 stroke-width=0.00477141><g id=SVGRepo_bgCarrier stroke-width=0></g><g id=SVGRepo_tracerCarrier stroke-linecap=round stroke-linejoin=round stroke=#080808 stroke-width=28.62846><g><path d="M326.711,341.99h-64.628v-64.634c0-0.686-0.142-1.323-0.213-1.997c65.409-11.119,115.378-68.161,115.378-136.681 C377.249,62.208,315.044,0,238.571,0C162.103,0,99.892,62.208,99.892,138.678c0,68.521,49.973,125.562,115.375,136.681 c-0.059,0.674-0.204,1.312-0.204,1.997v64.634h-64.631c-12.983,0-23.501,10.527-23.501,23.502c0,12.98,10.518,23.507,23.501,23.507 h64.637v64.64c0,12.98,10.524,23.502,23.501,23.502c12.979,0,23.513-10.527,23.513-23.502v-64.64h64.628 c12.986,0,23.508-10.526,23.508-23.507C350.219,352.518,339.698,341.99,326.711,341.99z M146.904,138.678 c0-50.546,41.121-91.673,91.667-91.673c50.549,0,91.676,41.122,91.676,91.673s-41.127,91.667-91.676,91.667 C188.031,230.346,146.904,189.224,146.904,138.678z"></path></g></g><g id=SVGRepo_iconCarrier><g><path d="M326.711,341.99h-64.628v-64.634c0-0.686-0.142-1.323-0.213-1.997c65.409-11.119,115.378-68.161,115.378-136.681 C377.249,62.208,315.044,0,238.571,0C162.103,0,99.892,62.208,99.892,138.678c0,68.521,49.973,125.562,115.375,136.681 c-0.059,0.674-0.204,1.312-0.204,1.997v64.634h-64.631c-12.983,0-23.501,10.527-23.501,23.502c0,12.98,10.518,23.507,23.501,23.507 h64.637v64.64c0,12.98,10.524,23.502,23.501,23.502c12.979,0,23.513-10.527,23.513-23.502v-64.64h64.628 c12.986,0,23.508-10.526,23.508-23.507C350.219,352.518,339.698,341.99,326.711,341.99z M146.904,138.678 c0-50.546,41.121-91.673,91.667-91.673c50.549,0,91.676,41.122,91.676,91.673s-41.127,91.667-91.676,91.667 C188.031,230.346,146.904,189.224,146.904,138.678z">');const $s=()=>Es();var As=A("<h2>Update Node"),Os=A("<div><div><p>Name</p><input type=text name=lname placeholder=Name></div><div><p>Gender</p><div><div><input type=radio id=male name=gender value=M><label for=male>Male</label></div><div><input type=radio id=female name=gender value=M><label for=female>Female"),Fs=A("<h2>Create Node");const Ts=t=>(()=>{var e=Os(),o=e.firstChild,n=o.firstChild,r=n.nextSibling,s=o.nextSibling,a=s.firstChild,i=a.nextSibling,c=i.firstChild,d=c.firstChild,u=d.nextSibling,l=c.nextSibling,f=l.firstChild,g=f.nextSibling;return $(e,z(se,{get when(){return t.formData.id},get fallback(){return Fs()},get children(){return As()}}),o),r.$$input=p=>t.updateFormData({name:p.target.value}),d.addEventListener("change",()=>t.updateFormData({gender:"M"})),$(c,z(_s,{}),u),f.addEventListener("change",()=>t.updateFormData({gender:"F"})),$(l,z($s,{}),g),K(p=>{var w=k.displayContainer,N=k.fieldDisplayContainer,j=k.fieldDisplayContainer,b=k.horizontalRadioContainer,C=k.horizontalRadioInput,D=k.radioInputMale,m=k.horizontalRadioInput,R=k.radioInputFemale;return w!==p.e&&I(e,p.e=w),N!==p.t&&I(o,p.t=N),j!==p.a&&I(s,p.a=j),b!==p.o&&I(i,p.o=b),C!==p.i&&I(c,p.i=C),D!==p.n&&I(d,p.n=D),m!==p.s&&I(l,p.s=m),R!==p.h&&I(f,p.h=R),p},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0}),K(()=>r.value=t.formData.name),K(()=>d.checked=t.formData.gender==="M"),K(()=>f.checked=t.formData.gender==="F"),e})();nt(["input"]);var Ls=A("<div><h1>Family Tree"),Bs=A("<h2>No Node Selected");const js=()=>{const[t,e]=mt(void 0),o=V(()=>y.mouseData.heldNodes.at(-1)?.node),n=V(()=>{const a=o();if(a)return{...a.customData,id:a.id}}),r=V(()=>t()!==void 0||n()!==void 0),s=V(()=>{if(!r())return"empty";const a=t();return a!==void 0?a.id?"edit":"add":"view"});return(()=>{var a=Ls();return a.firstChild,$(a,z(se,{get when(){return r()},get fallback(){return Bs()},get children(){return z(se,{get when(){return t()!==void 0},get fallback(){return z(Is,{get nodeData(){return o()}})},get children(){return z(Ts,{get formData(){return t()},updateFormData:i=>e({...t(),...i})})}})}}),null),$(a,z(zs,{get mode(){return s()},setFormData:e,get nodeData(){return n()},get formData(){return t()}}),null),K(()=>I(a,je.sidebarContent)),a})()},Gs={MAIN_NODEFLOW:"main-nodeflow"};class Ws extends bo{calculateCurveAnchors(e,o,n,r){const s=this.getVerticalCurve(e,o),a=e.add(s),i=o.subtract(s);return{anchorStart:a,anchorEnd:i}}}const[y,Ks]=O.get().createCanvas(Gs.MAIN_NODEFLOW,{},t=>new Ws(t)),Us=()=>{$o(()=>{Yn(),Xn().then(()=>Qn())});const t=V(()=>{const e=y.mouseData.heldConnectors.at(-1);if(e)return e.connector.parentNode.customData.gender==="M"?me.newFatherCurve:me.newMotherCurve});return[z(Ks,{get css(){return{newCurve:t(),nodeflow:Tn.nodeflow}},get width(){return`${tt().x}px`},get height(){return`${tt().y}px`}}),z(ns,{get children(){return z(js,{})}})]},Rs=document.getElementById("root");Uo(()=>z(Us,{}),Rs);
