(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))o(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();const nn=(t,e)=>t===e,Ie={equals:nn};let Et=Ft;const Y=1,Me=2,At={owned:null,cleanups:null,context:null,owner:null};var N=null;let Ye=null,p=null,b=null,j=null,Re=0;function on(t,e){const n=p,o=N,i=t.length===0,s=e===void 0?o:e,c=i?At:{owned:null,cleanups:null,context:s?s.context:null,owner:s},r=i?t:()=>t(()=>ee(()=>Ke(c)));N=c,p=null;try{return ye(r,!0)}finally{p=n,N=o}}function zt(t,e){e=e?Object.assign({},Ie,e):Ie;const n={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},o=i=>(typeof i=="function"&&(i=i(n.value)),kt(n,i));return[Ot.bind(n),o]}function k(t,e,n){const o=nt(t,e,!1,Y);Ce(o)}function sn(t,e,n){Et=ln;const o=nt(t,e,!1,Y);(!n||!n.render)&&(o.user=!0),j?j.push(o):Ce(o)}function le(t,e,n){n=n?Object.assign({},Ie,n):Ie;const o=nt(t,e,!0,0);return o.observers=null,o.observerSlots=null,o.comparator=n.equals||void 0,Ce(o),Ot.bind(o)}function ee(t){if(p===null)return t();const e=p;p=null;try{return t()}finally{p=e}}function rn(t){sn(()=>ee(t))}function Ot(){if(this.sources&&this.state)if(this.state===Y)Ce(this);else{const t=b;b=null,ye(()=>xe(this),!1),b=t}if(p){const t=this.observers?this.observers.length:0;p.sources?(p.sources.push(this),p.sourceSlots.push(t)):(p.sources=[this],p.sourceSlots=[t]),this.observers?(this.observers.push(p),this.observerSlots.push(p.sources.length-1)):(this.observers=[p],this.observerSlots=[p.sources.length-1])}return this.value}function kt(t,e,n){let o=t.value;return(!t.comparator||!t.comparator(o,e))&&(t.value=e,t.observers&&t.observers.length&&ye(()=>{for(let i=0;i<t.observers.length;i+=1){const s=t.observers[i],c=Ye&&Ye.running;c&&Ye.disposed.has(s),(c?!s.tState:!s.state)&&(s.pure?b.push(s):j.push(s),s.observers&&Lt(s)),c||(s.state=Y)}if(b.length>1e6)throw b=[],new Error},!1)),e}function Ce(t){if(!t.fn)return;Ke(t);const e=N,n=p,o=Re;p=N=t,cn(t,t.value,o),p=n,N=e}function cn(t,e,n){let o;try{o=t.fn(e)}catch(i){return t.pure&&(t.state=Y,t.owned&&t.owned.forEach(Ke),t.owned=null),t.updatedAt=n+1,Tt(i)}(!t.updatedAt||t.updatedAt<=n)&&(t.updatedAt!=null&&"observers"in t?kt(t,o):t.value=o,t.updatedAt=n)}function nt(t,e,n,o=Y,i){const s={fn:t,state:o,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:N,context:N?N.context:null,pure:n};return N===null||N!==At&&(N.owned?N.owned.push(s):N.owned=[s]),s}function Pe(t){if(t.state===0)return;if(t.state===Me)return xe(t);if(t.suspense&&ee(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<Re);)t.state&&e.push(t);for(let n=e.length-1;n>=0;n--)if(t=e[n],t.state===Y)Ce(t);else if(t.state===Me){const o=b;b=null,ye(()=>xe(t,e[0]),!1),b=o}}function ye(t,e){if(b)return t();let n=!1;e||(b=[]),j?n=!0:j=[],Re++;try{const o=t();return an(n),o}catch(o){n||(j=null),b=null,Tt(o)}}function an(t){if(b&&(Ft(b),b=null),t)return;const e=j;j=null,e.length&&ye(()=>Et(e),!1)}function Ft(t){for(let e=0;e<t.length;e++)Pe(t[e])}function ln(t){let e,n=0;for(e=0;e<t.length;e++){const o=t[e];o.user?t[n++]=o:Pe(o)}for(e=0;e<n;e++)Pe(t[e])}function xe(t,e){t.state=0;for(let n=0;n<t.sources.length;n+=1){const o=t.sources[n];if(o.sources){const i=o.state;i===Y?o!==e&&(!o.updatedAt||o.updatedAt<Re)&&Pe(o):i===Me&&xe(o,e)}}}function Lt(t){for(let e=0;e<t.observers.length;e+=1){const n=t.observers[e];n.state||(n.state=Me,n.pure?b.push(n):j.push(n),n.observers&&Lt(n))}}function Ke(t){let e;if(t.sources)for(;t.sources.length;){const n=t.sources.pop(),o=t.sourceSlots.pop(),i=n.observers;if(i&&i.length){const s=i.pop(),c=n.observerSlots.pop();o<i.length&&(s.sourceSlots[c]=o,i[o]=s,n.observerSlots[o]=c)}}if(t.owned){for(e=t.owned.length-1;e>=0;e--)Ke(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function dn(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function Tt(t,e=N){throw dn(t)}function C(t,e){return ee(()=>t(e||{}))}const un=t=>`Stale read from <${t}>.`;function Q(t){const e=t.keyed,n=le(()=>t.when,void 0,{equals:(o,i)=>e?o===i:!o==!i});return le(()=>{const o=n();if(o){const i=t.children;return typeof i=="function"&&i.length>0?ee(()=>i(e?o:()=>{if(!ee(n))throw un("Show");return t.when})):i}return t.fallback},void 0,void 0)}function hn(t,e,n){let o=n.length,i=e.length,s=o,c=0,r=0,l=e[i-1].nextSibling,d=null;for(;c<i||r<s;){if(e[c]===n[r]){c++,r++;continue}for(;e[i-1]===n[s-1];)i--,s--;if(i===c){const a=s<o?r?n[r-1].nextSibling:n[s-r]:l;for(;r<s;)t.insertBefore(n[r++],a)}else if(s===r)for(;c<i;)(!d||!d.has(e[c]))&&e[c].remove(),c++;else if(e[c]===n[s-1]&&n[r]===e[i-1]){const a=e[--i].nextSibling;t.insertBefore(n[r++],e[c++].nextSibling),t.insertBefore(n[--s],a),e[i]=n[s]}else{if(!d){d=new Map;let h=r;for(;h<s;)d.set(n[h],h++)}const a=d.get(e[c]);if(a!=null)if(r<a&&a<s){let h=c,f=1,g;for(;++h<i&&h<s&&!((g=d.get(e[h]))==null||g!==a+f);)f++;if(f>a-r){const A=e[c];for(;r<a;)t.insertBefore(n[r++],A)}else t.replaceChild(n[r++],e[c++])}else c++;else e[c++].remove()}}}const gt="_$DX_DELEGATE";function fn(t,e,n,o={}){let i;return on(s=>{i=s,e===document?t():I(e,t(),e.firstChild?null:void 0,n)},o.owner),()=>{i(),e.textContent=""}}function $(t,e,n){let o;const i=()=>{const c=document.createElement("template");return c.innerHTML=t,n?c.content.firstChild.firstChild:c.content.firstChild},s=e?()=>ee(()=>document.importNode(o||(o=i()),!0)):()=>(o||(o=i())).cloneNode(!0);return s.cloneNode=s,s}function ot(t,e=window.document){const n=e[gt]||(e[gt]=new Set);for(let o=0,i=t.length;o<i;o++){const s=t[o];n.has(s)||(n.add(s),e.addEventListener(s,gn))}}function mt(t,e,n){n==null?t.removeAttribute(e):t.setAttribute(e,n)}function w(t,e){e==null?t.removeAttribute("class"):t.className=e}function I(t,e,n,o){if(n!==void 0&&!o&&(o=[]),typeof e!="function")return Ee(t,e,o,n);k(i=>Ee(t,e(),i,n),o)}function gn(t){const e=`$$${t.type}`;let n=t.composedPath&&t.composedPath()[0]||t.target;for(t.target!==n&&Object.defineProperty(t,"target",{configurable:!0,value:n}),Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return n||document}});n;){const o=n[e];if(o&&!n.disabled){const i=n[`${e}Data`];if(i!==void 0?o.call(n,i,t):o.call(n,t),t.cancelBubble)return}n=n._$host||n.parentNode||n.host}}function Ee(t,e,n,o,i){for(;typeof n=="function";)n=n();if(e===n)return n;const s=typeof e,c=o!==void 0;if(t=c&&n[0]&&n[0].parentNode||t,s==="string"||s==="number")if(s==="number"&&(e=e.toString()),c){let r=n[0];r&&r.nodeType===3?r.data=e:r=document.createTextNode(e),n=se(t,n,o,r)}else n!==""&&typeof n=="string"?n=t.firstChild.data=e:n=t.textContent=e;else if(e==null||s==="boolean")n=se(t,n,o);else{if(s==="function")return k(()=>{let r=e();for(;typeof r=="function";)r=r();n=Ee(t,r,n,o)}),()=>n;if(Array.isArray(e)){const r=[],l=n&&Array.isArray(n);if(Je(r,e,n,i))return k(()=>n=Ee(t,r,n,o,!0)),()=>n;if(r.length===0){if(n=se(t,n,o),c)return n}else l?n.length===0?vt(t,r,o):hn(t,n,r):(n&&se(t),vt(t,r));n=r}else if(e.nodeType){if(Array.isArray(n)){if(c)return n=se(t,n,o,e);se(t,n,null,e)}else n==null||n===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);n=e}}return n}function Je(t,e,n,o){let i=!1;for(let s=0,c=e.length;s<c;s++){let r=e[s],l=n&&n[s],d;if(!(r==null||r===!0||r===!1))if((d=typeof r)=="object"&&r.nodeType)t.push(r);else if(Array.isArray(r))i=Je(t,r,l)||i;else if(d==="function")if(o){for(;typeof r=="function";)r=r();i=Je(t,Array.isArray(r)?r:[r],Array.isArray(l)?l:[l])||i}else t.push(r),i=!0;else{const a=String(r);l&&l.nodeType===3&&l.data===a?t.push(l):t.push(document.createTextNode(a))}}return i}function vt(t,e,n=null){for(let o=0,i=e.length;o<i;o++)t.insertBefore(e[o],n)}function se(t,e,n,o){if(n===void 0)return t.textContent="";const i=o||document.createTextNode("");if(e.length){let s=!1;for(let c=e.length-1;c>=0;c--){const r=e[c];if(i!==r){const l=r.parentNode===t;!s&&!c?l?t.replaceChild(i,r):t.insertBefore(i,n):l&&r.remove()}else s=!0}}else t.insertBefore(i,n);return[i]}const mn=(t,e)=>t===e,te=Symbol("solid-proxy"),et=Symbol("solid-track"),Ae={equals:mn};let jt=Rt;const X=1,ze=2,Bt={owned:null,cleanups:null,context:null,owner:null};var m=null;let Xe=null,vn=null,v=null,S=null,B=null,He=0;function Ve(t,e){const n=v,o=m,i=t.length===0,s=e===void 0?o:e,c=i?Bt:{owned:null,cleanups:null,context:s?s.context:null,owner:s},r=i?t:()=>t(()=>G(()=>Ze(c)));m=c,v=null;try{return ge(r,!0)}finally{v=n,m=o}}function we(t,e){e=e?Object.assign({},Ae,e):Ae;const n={value:t,observers:null,observerSlots:null,comparator:e.equals||void 0},o=i=>(typeof i=="function"&&(i=i(n.value)),Wt(n,i));return[Ut.bind(n),o]}function E(t,e,n){const o=rt(t,e,!1,X);be(o)}function st(t,e,n){jt=wn;const o=rt(t,e,!1,X),i=pt&&pn(pt);i&&(o.suspense=i),(!n||!n.render)&&(o.user=!0),B?B.push(o):be(o)}function L(t,e,n){n=n?Object.assign({},Ae,n):Ae;const o=rt(t,e,!0,0);return o.observers=null,o.observerSlots=null,o.comparator=n.equals||void 0,be(o),Ut.bind(o)}function Ne(t){return ge(t,!1)}function G(t){if(v===null)return t();const e=v;v=null;try{return t()}finally{v=e}}function it(t){return m===null||(m.cleanups===null?m.cleanups=[t]:m.cleanups.push(t)),t}function Oe(){return v}function pn(t){return m&&m.context&&m.context[t.id]!==void 0?m.context[t.id]:t.defaultValue}let pt;function Ut(){if(this.sources&&this.state)if(this.state===X)be(this);else{const t=S;S=null,ge(()=>Fe(this),!1),S=t}if(v){const t=this.observers?this.observers.length:0;v.sources?(v.sources.push(this),v.sourceSlots.push(t)):(v.sources=[this],v.sourceSlots=[t]),this.observers?(this.observers.push(v),this.observerSlots.push(v.sources.length-1)):(this.observers=[v],this.observerSlots=[v.sources.length-1])}return this.value}function Wt(t,e,n){let o=t.value;return(!t.comparator||!t.comparator(o,e))&&(t.value=e,t.observers&&t.observers.length&&ge(()=>{for(let i=0;i<t.observers.length;i+=1){const s=t.observers[i],c=Xe&&Xe.running;c&&Xe.disposed.has(s),(c?!s.tState:!s.state)&&(s.pure?S.push(s):B.push(s),s.observers&&Kt(s)),c||(s.state=X)}if(S.length>1e6)throw S=[],new Error},!1)),e}function be(t){if(!t.fn)return;Ze(t);const e=He;Cn(t,t.value,e)}function Cn(t,e,n){let o;const i=m,s=v;v=m=t;try{o=t.fn(e)}catch(c){return t.pure&&(t.state=X,t.owned&&t.owned.forEach(Ze),t.owned=null),t.updatedAt=n+1,Ht(c)}finally{v=s,m=i}(!t.updatedAt||t.updatedAt<=n)&&(t.updatedAt!=null&&"observers"in t?Wt(t,o):t.value=o,t.updatedAt=n)}function rt(t,e,n,o=X,i){const s={fn:t,state:o,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:m,context:m?m.context:null,pure:n};return m===null||m!==Bt&&(m.owned?m.owned.push(s):m.owned=[s]),s}function ke(t){if(t.state===0)return;if(t.state===ze)return Fe(t);if(t.suspense&&G(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<He);)t.state&&e.push(t);for(let n=e.length-1;n>=0;n--)if(t=e[n],t.state===X)be(t);else if(t.state===ze){const o=S;S=null,ge(()=>Fe(t,e[0]),!1),S=o}}function ge(t,e){if(S)return t();let n=!1;e||(S=[]),B?n=!0:B=[],He++;try{const o=t();return yn(n),o}catch(o){n||(B=null),S=null,Ht(o)}}function yn(t){if(S&&(Rt(S),S=null),t)return;const e=B;B=null,e.length&&ge(()=>jt(e),!1)}function Rt(t){for(let e=0;e<t.length;e++)ke(t[e])}function wn(t){let e,n=0;for(e=0;e<t.length;e++){const o=t[e];o.user?t[n++]=o:ke(o)}for(e=0;e<n;e++)ke(t[e])}function Fe(t,e){t.state=0;for(let n=0;n<t.sources.length;n+=1){const o=t.sources[n];if(o.sources){const i=o.state;i===X?o!==e&&(!o.updatedAt||o.updatedAt<He)&&ke(o):i===ze&&Fe(o,e)}}}function Kt(t){for(let e=0;e<t.observers.length;e+=1){const n=t.observers[e];n.state||(n.state=ze,n.pure?S.push(n):B.push(n),n.observers&&Kt(n))}}function Ze(t){let e;if(t.sources)for(;t.sources.length;){const n=t.sources.pop(),o=t.sourceSlots.pop(),i=n.observers;if(i&&i.length){const s=i.pop(),c=n.observerSlots.pop();o<i.length&&(s.sourceSlots[c]=o,i[o]=s,n.observerSlots[o]=c)}}if(t.owned){for(e=t.owned.length-1;e>=0;e--)Ze(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function bn(t){return t instanceof Error?t:new Error(typeof t=="string"?t:"Unknown error",{cause:t})}function Ht(t,e=m){throw bn(t)}const Sn=Symbol("fallback");function Ct(t){for(let e=0;e<t.length;e++)t[e]()}function $n(t,e,n={}){let o=[],i=[],s=[],c=0,r=e.length>1?[]:null;return it(()=>Ct(s)),()=>{let l=t()||[],d,a;return l[et],G(()=>{let f=l.length,g,A,W,V,q,M,P,z,oe;if(f===0)c!==0&&(Ct(s),s=[],o=[],i=[],c=0,r&&(r=[])),n.fallback&&(o=[Sn],i[0]=Ve(tn=>(s[0]=tn,n.fallback())),c=1);else if(c===0){for(i=new Array(f),a=0;a<f;a++)o[a]=l[a],i[a]=Ve(h);c=f}else{for(W=new Array(f),V=new Array(f),r&&(q=new Array(f)),M=0,P=Math.min(c,f);M<P&&o[M]===l[M];M++);for(P=c-1,z=f-1;P>=M&&z>=M&&o[P]===l[z];P--,z--)W[z]=i[P],V[z]=s[P],r&&(q[z]=r[P]);for(g=new Map,A=new Array(z+1),a=z;a>=M;a--)oe=l[a],d=g.get(oe),A[a]=d===void 0?-1:d,g.set(oe,a);for(d=M;d<=P;d++)oe=o[d],a=g.get(oe),a!==void 0&&a!==-1?(W[a]=i[d],V[a]=s[d],r&&(q[a]=r[d]),a=A[a],g.set(oe,a)):s[d]();for(a=M;a<f;a++)a in W?(i[a]=W[a],s[a]=V[a],r&&(r[a]=q[a],r[a](a))):i[a]=Ve(h);i=i.slice(0,c=f),o=l.slice(0)}return i});function h(f){if(s[a]=f,r){const[g,A]=we(a);return r[a]=A,e(l[a],g)}return e(l[a])}}}function x(t,e){return G(()=>t(e||{}))}const Nn=t=>`Stale read from <${t}>.`;function re(t){const e="fallback"in t&&{fallback:()=>t.fallback};return L($n(()=>t.each,t.children,e||void 0))}function ct(t){const e=t.keyed,n=L(()=>t.when,void 0,{equals:(o,i)=>e?o===i:!o==!i});return L(()=>{const o=n();if(o){const i=t.children;return typeof i=="function"&&i.length>0?G(()=>i(e?o:()=>{if(!G(n))throw Nn("Show");return t.when})):i}return t.fallback},void 0,void 0)}function Dn(t,e,n){let o=n.length,i=e.length,s=o,c=0,r=0,l=e[i-1].nextSibling,d=null;for(;c<i||r<s;){if(e[c]===n[r]){c++,r++;continue}for(;e[i-1]===n[s-1];)i--,s--;if(i===c){const a=s<o?r?n[r-1].nextSibling:n[s-r]:l;for(;r<s;)t.insertBefore(n[r++],a)}else if(s===r)for(;c<i;)(!d||!d.has(e[c]))&&e[c].remove(),c++;else if(e[c]===n[s-1]&&n[r]===e[i-1]){const a=e[--i].nextSibling;t.insertBefore(n[r++],e[c++].nextSibling),t.insertBefore(n[--s],a),e[i]=n[s]}else{if(!d){d=new Map;let h=r;for(;h<s;)d.set(n[h],h++)}const a=d.get(e[c]);if(a!=null)if(r<a&&a<s){let h=c,f=1,g;for(;++h<i&&h<s&&!((g=d.get(e[h]))==null||g!==a+f);)f++;if(f>a-r){const A=e[c];for(;r<a;)t.insertBefore(n[r++],A)}else t.replaceChild(n[r++],e[c++])}else c++;else e[c++].remove()}}}const yt="_$DX_DELEGATE";function ne(t,e,n){let o;const i=()=>{const c=document.createElement("template");return c.innerHTML=t,n?c.content.firstChild.firstChild:c.content.firstChild},s=e?()=>G(()=>document.importNode(o||(o=i()),!0)):()=>(o||(o=i())).cloneNode(!0);return s.cloneNode=s,s}function Ge(t,e=window.document){const n=e[yt]||(e[yt]=new Set);for(let o=0,i=t.length;o<i;o++){const s=t[o];n.has(s)||(n.add(s),e.addEventListener(s,_n))}}function D(t,e,n){n==null?t.removeAttribute(e):t.setAttribute(e,n)}function at(t,e){e==null?t.removeAttribute("class"):t.className=e}function Zt(t,e,n={}){const o=Object.keys(e||{}),i=Object.keys(n);let s,c;for(s=0,c=i.length;s<c;s++){const r=i[s];!r||r==="undefined"||e[r]||(wt(t,r,!1),delete n[r])}for(s=0,c=o.length;s<c;s++){const r=o[s],l=!!e[r];!r||r==="undefined"||n[r]===l||!l||(wt(t,r,!0),n[r]=l)}return n}function lt(t,e,n){return G(()=>t(e,n))}function J(t,e,n,o){if(n!==void 0&&!o&&(o=[]),typeof e!="function")return Le(t,e,o,n);E(i=>Le(t,e(),i,n),o)}function wt(t,e,n){const o=e.trim().split(/\s+/);for(let i=0,s=o.length;i<s;i++)t.classList.toggle(o[i],n)}function _n(t){const e=`$$${t.type}`;let n=t.composedPath&&t.composedPath()[0]||t.target;for(t.target!==n&&Object.defineProperty(t,"target",{configurable:!0,value:n}),Object.defineProperty(t,"currentTarget",{configurable:!0,get(){return n||document}});n;){const o=n[e];if(o&&!n.disabled){const i=n[`${e}Data`];if(i!==void 0?o.call(n,i,t):o.call(n,t),t.cancelBubble)return}n=n._$host||n.parentNode||n.host}}function Le(t,e,n,o,i){for(;typeof n=="function";)n=n();if(e===n)return n;const s=typeof e,c=o!==void 0;if(t=c&&n[0]&&n[0].parentNode||t,s==="string"||s==="number")if(s==="number"&&(e=e.toString()),c){let r=n[0];r&&r.nodeType===3?r.data!==e&&(r.data=e):r=document.createTextNode(e),n=ie(t,n,o,r)}else n!==""&&typeof n=="string"?n=t.firstChild.data=e:n=t.textContent=e;else if(e==null||s==="boolean")n=ie(t,n,o);else{if(s==="function")return E(()=>{let r=e();for(;typeof r=="function";)r=r();n=Le(t,r,n,o)}),()=>n;if(Array.isArray(e)){const r=[],l=n&&Array.isArray(n);if(tt(r,e,n,i))return E(()=>n=Le(t,r,n,o,!0)),()=>n;if(r.length===0){if(n=ie(t,n,o),c)return n}else l?n.length===0?bt(t,r,o):Dn(t,n,r):(n&&ie(t),bt(t,r));n=r}else if(e.nodeType){if(Array.isArray(n)){if(c)return n=ie(t,n,o,e);ie(t,n,null,e)}else n==null||n===""||!t.firstChild?t.appendChild(e):t.replaceChild(e,t.firstChild);n=e}}return n}function tt(t,e,n,o){let i=!1;for(let s=0,c=e.length;s<c;s++){let r=e[s],l=n&&n[s],d;if(!(r==null||r===!0||r===!1))if((d=typeof r)=="object"&&r.nodeType)t.push(r);else if(Array.isArray(r))i=tt(t,r,l)||i;else if(d==="function")if(o){for(;typeof r=="function";)r=r();i=tt(t,Array.isArray(r)?r:[r],Array.isArray(l)?l:[l])||i}else t.push(r),i=!0;else{const a=String(r);l&&l.nodeType===3&&l.data===a?t.push(l):t.push(document.createTextNode(a))}}return i}function bt(t,e,n=null){for(let o=0,i=e.length;o<i;o++)t.insertBefore(e[o],n)}function ie(t,e,n,o){if(n===void 0)return t.textContent="";const i=o||document.createTextNode("");if(e.length){let s=!1;for(let c=e.length-1;c>=0;c--){const r=e[c];if(i!==r){const l=r.parentNode===t;!s&&!c?l?t.replaceChild(i,r):t.insertBefore(i,n):l&&r.remove()}else s=!0}}else t.insertBefore(i,n);return[i]}const Te=Symbol("store-raw"),de=Symbol("store-node"),T=Symbol("store-has"),Gt=Symbol("store-self");function Yt(t){let e=t[te];if(!e&&(Object.defineProperty(t,te,{value:e=new Proxy(t,Pn)}),!Array.isArray(t))){const n=Object.keys(t),o=Object.getOwnPropertyDescriptors(t);for(let i=0,s=n.length;i<s;i++){const c=n[i];o[c].get&&Object.defineProperty(t,c,{enumerable:o[c].enumerable,get:o[c].get.bind(e)})}}return e}function ue(t){let e;return t!=null&&typeof t=="object"&&(t[te]||!(e=Object.getPrototypeOf(t))||e===Object.prototype||Array.isArray(t))}function he(t,e=new Set){let n,o,i,s;if(n=t!=null&&t[Te])return n;if(!ue(t)||e.has(t))return t;if(Array.isArray(t)){Object.isFrozen(t)?t=t.slice(0):e.add(t);for(let c=0,r=t.length;c<r;c++)i=t[c],(o=he(i,e))!==i&&(t[c]=o)}else{Object.isFrozen(t)?t=Object.assign({},t):e.add(t);const c=Object.keys(t),r=Object.getOwnPropertyDescriptors(t);for(let l=0,d=c.length;l<d;l++)s=c[l],!r[s].get&&(i=t[s],(o=he(i,e))!==i&&(t[s]=o))}return t}function je(t,e){let n=t[e];return n||Object.defineProperty(t,e,{value:n=Object.create(null)}),n}function ve(t,e,n){if(t[e])return t[e];const[o,i]=we(n,{equals:!1,internal:!0});return o.$=i,t[e]=o}function In(t,e){const n=Reflect.getOwnPropertyDescriptor(t,e);return!n||n.get||!n.configurable||e===te||e===de||(delete n.value,delete n.writable,n.get=()=>t[te][e]),n}function Xt(t){Oe()&&ve(je(t,de),Gt)()}function Mn(t){return Xt(t),Reflect.ownKeys(t)}const Pn={get(t,e,n){if(e===Te)return t;if(e===te)return n;if(e===et)return Xt(t),n;const o=je(t,de),i=o[e];let s=i?i():t[e];if(e===de||e===T||e==="__proto__")return s;if(!i){const c=Object.getOwnPropertyDescriptor(t,e);Oe()&&(typeof s!="function"||t.hasOwnProperty(e))&&!(c&&c.get)&&(s=ve(o,e,s)())}return ue(s)?Yt(s):s},has(t,e){return e===Te||e===te||e===et||e===de||e===T||e==="__proto__"?!0:(Oe()&&ve(je(t,T),e)(),e in t)},set(){return!0},deleteProperty(){return!0},ownKeys:Mn,getOwnPropertyDescriptor:In};function fe(t,e,n,o=!1){if(!o&&t[e]===n)return;const i=t[e],s=t.length;n===void 0?(delete t[e],t[T]&&t[T][e]&&i!==void 0&&t[T][e].$()):(t[e]=n,t[T]&&t[T][e]&&i===void 0&&t[T][e].$());let c=je(t,de),r;if((r=ve(c,e,i))&&r.$(()=>n),Array.isArray(t)&&t.length!==s){for(let l=t.length;l<s;l++)(r=c[l])&&r.$();(r=ve(c,"length",s))&&r.$(t.length)}(r=c[Gt])&&r.$()}function Vt(t,e){const n=Object.keys(e);for(let o=0;o<n.length;o+=1){const i=n[o];fe(t,i,e[i])}}function xn(t,e){if(typeof e=="function"&&(e=e(t)),e=he(e),Array.isArray(e)){if(t===e)return;let n=0,o=e.length;for(;n<o;n++){const i=e[n];t[n]!==i&&fe(t,n,i)}fe(t,"length",o)}else Vt(t,e)}function me(t,e,n=[]){let o,i=t;if(e.length>1){o=e.shift();const c=typeof o,r=Array.isArray(t);if(Array.isArray(o)){for(let l=0;l<o.length;l++)me(t,[o[l]].concat(e),n);return}else if(r&&c==="function"){for(let l=0;l<t.length;l++)o(t[l],l)&&me(t,[l].concat(e),n);return}else if(r&&c==="object"){const{from:l=0,to:d=t.length-1,by:a=1}=o;for(let h=l;h<=d;h+=a)me(t,[h].concat(e),n);return}else if(e.length>1){me(t[o],e,[o].concat(n));return}i=t[o],n=[o].concat(n)}let s=e[0];typeof s=="function"&&(s=s(i,n),s===i)||o===void 0&&s==null||(s=he(s),o===void 0||ue(i)&&ue(s)&&!Array.isArray(s)?Vt(i,s):fe(t,o,s))}function U(...[t,e]){const n=he(t||{}),o=Array.isArray(n),i=Yt(n);function s(...c){Ne(()=>{o&&c.length===1?xn(n,c[0]):me(n,c)})}return[i,s]}const Be=new WeakMap,qt={get(t,e){if(e===Te)return t;const n=t[e];let o;return ue(n)?Be.get(n)||(Be.set(n,o=new Proxy(n,qt)),o):n},set(t,e,n){return fe(t,e,he(n)),!0},deleteProperty(t,e){return fe(t,e,void 0,!0),!0}};function En(t){return e=>{if(ue(e)){let n;(n=Be.get(e))||Be.set(e,n=new Proxy(e,qt)),t(n)}return e}}var An={equals:!1},zn=An,St=class{#e;constructor(t=Map){this.#e=new t}dirty(t){this.#e.get(t)?.$$()}track(t){if(!Oe())return;let e=this.#e.get(t);if(e)e.n++;else{const[n,o]=we(void 0,zn);this.#e.set(t,e={$:n,$$:o,n:1})}it(()=>{e.n--===1&&queueMicrotask(()=>e.n===0&&this.#e.delete(t))}),e.$()}},R=Symbol("track-keys"),pe=class extends Map{#e=new St;#t=new St;constructor(t){if(super(),t)for(const e of t)super.set(e[0],e[1])}has(t){return this.#e.track(t),super.has(t)}get(t){return this.#t.track(t),super.get(t)}get size(){return this.#e.track(R),super.size}*keys(){for(const t of super.keys())this.#e.track(t),yield t;this.#e.track(R)}*values(){for(const[t,e]of super.entries())this.#t.track(t),yield e;this.#e.track(R)}*entries(){for(const t of super.entries())this.#t.track(t[0]),yield t;this.#e.track(R)}set(t,e){return Ne(()=>{if(super.has(t)){if(super.get(t)===e)return}else this.#e.dirty(t),this.#e.dirty(R);this.#t.dirty(t),super.set(t,e)}),this}delete(t){const e=super.delete(t);return e&&Ne(()=>{this.#e.dirty(t),this.#e.dirty(R),this.#t.dirty(t)}),e}clear(){super.size&&Ne(()=>{for(const t of super.keys())this.#e.dirty(t),this.#t.dirty(t);super.clear(),this.#e.dirty(R)})}forEach(t){this.#e.track(R);for(const[e,n]of super.entries())this.#t.track(e),t(n,e,this)}[Symbol.iterator](){return this.entries()}};class u{constructor(e,n){this.x=e,this.y=n}static zero(){return new u(0,0)}static of(e,n){return new u(e,n)}static fromEvent(e){return new u(e.clientX,e.clientY)}static fromVec2(e){return new u(e.x,e.y)}copy(){return new u(this.x,this.y)}serialize(){return{x:this.x,y:this.y}}static deserialize(e){return new u(e.x,e.y)}static deserializeOrDefault(e,n=u.zero()){return e?u.deserialize(e):n}add(...e){return e.reduce((n,o)=>new u(n.x+o.x,n.y+o.y),this)}subtract(...e){return e.reduce((n,o)=>new u(n.x-o.x,n.y-o.y),this)}multiply(...e){return e.reduce((n,o)=>new u(n.x*o.x,n.y*o.y),this)}divide(...e){return e.reduce((n,o)=>new u(o.x/n.x,o.y/n.y),this)}negate(){return new u(-this.x,-this.y)}shift(e){return new u(this.x+e,this.y+e)}multiplyBy(e){return new u(this.x*e,this.y*e)}divideBy(e){return new u(this.x/e,this.y/e)}isWithinRect(e,n){return this.x>=e.x&&this.x<=e.x+n.x&&this.y>=e.y&&this.y<=e.y+n.y}distanceTo(e){return Math.hypot(this.x-e.x,this.y-e.y)}abs(){return u.of(Math.abs(this.x),Math.abs(this.y))}}const On=ne("<div>"),kn=t=>(()=>{const e=On();return e.$$pointerup=n=>t.nodeflowData.eventStore.onPointerUpInConnector.publish({event:n,nodeId:t.nodeId,connectorId:t.connectorId}),e.$$touchstart=n=>t.nodeflowData.eventStore.onTouchStartInConnector.publish({event:n,nodeId:t.nodeId,connectorId:t.connectorId}),e.$$mousedown=n=>t.nodeflowData.eventStore.onMouseDownInConnector.publish({event:n,nodeId:t.nodeId,connectorId:t.connectorId}),lt(n=>setTimeout(()=>{if(!n)return;const o=t.nodeflowData.nodes.get(t.nodeId).connectorSections.get(t.sectionId).connectors.get(t.connectorId),i=new ResizeObserver(()=>{o.size=u.of(n.offsetWidth,n.offsetHeight)});i.observe(n),o.update({position:u.of((n?.parentElement?.offsetLeft??0)+n.offsetLeft,(n?.parentElement?.offsetTop??0)+n.offsetTop),ref:n,resizeObserver:i,size:u.of(n.offsetWidth,n.offsetHeight)})}),e),E(()=>at(e,t.connector?.css)),e})();Ge(["mousedown","touchstart","pointerup"]);const $t=ne('<svg><circle r="4" fill="none"></svg>',!1,!0),Fn=ne('<svg><path stroke="black" stroke-width="1" fill="transparent">'),Ln=t=>{const e=L(()=>{const{mouseData:n,curveFunctions:o,nodes:i}=t.nodeflowData,s=n.heldNodeId,c=n.heldConnectorId;if(!s||!c)return;const r=i.get(s),d=r.getConnector(c).getCenter(),a=n.globalMousePosition(),{anchorStart:h,anchorEnd:f}=o.calculateCurveAnchors(d,a,r.getCenter(),a);return{start:d,end:a,anchorStart:h,anchorEnd:f,path:o.createDefaultCurvePath(d,a,h,f)}});return(()=>{const n=Fn(),o=n.firstChild;return n.style.setProperty("z-index","2"),n.style.setProperty("position","absolute"),n.style.setProperty("width","1px"),n.style.setProperty("height","1px"),n.style.setProperty("pointer-events","none"),n.style.setProperty("overflow","visible"),J(n,x(ct,{get when(){return t.nodeflowData.settings.debugMode},get children(){return[(()=>{const i=$t();return E(s=>{const c=e()?.anchorStart.x,r=e()?.anchorStart.y,l=t.css??"";return c!==s._v$&&D(i,"cx",s._v$=c),r!==s._v$2&&D(i,"cy",s._v$2=r),l!==s._v$3&&D(i,"class",s._v$3=l),s},{_v$:void 0,_v$2:void 0,_v$3:void 0}),i})(),(()=>{const i=$t();return E(s=>{const c=e()?.anchorEnd.x,r=e()?.anchorEnd.y,l=t.css??"";return c!==s._v$4&&D(i,"cx",s._v$4=c),r!==s._v$5&&D(i,"cy",s._v$5=r),l!==s._v$6&&D(i,"class",s._v$6=l),s},{_v$4:void 0,_v$5:void 0,_v$6:void 0}),i})()]}}),null),E(i=>{const s=e()?.path,c=t.css;return s!==i._v$7&&D(o,"d",i._v$7=s),c!==i._v$8&&D(o,"class",i._v$8=c),i},{_v$7:void 0,_v$8:void 0}),n})()},Tn=ne('<svg><path stroke="black" stroke-width="1" fill="none"></svg>',!1,!0),Nt=ne('<svg><circle r="4" fill="none"></svg>',!1,!0),jn=t=>{const e=L(()=>t.nodeflowData.nodes.get(t.sourceNodeId)),n=L(()=>t.nodeflowData.nodes.get(t.destinationNodeId)),o=L(()=>e().getConnector(t.sourceConnectorId)),i=L(()=>n().getConnector(t.destinationConnectorId)),s=L(()=>!e()||!n()?-1:o()?.destinations?.findIndex(c=>c.destinationConnector===i())??-1);return st(()=>{if(s()<0)return;const{curveFunctions:c}=t.nodeflowData,r=e().getConnector(t.sourceConnectorId),l=n().getConnector(t.destinationConnectorId),d=r.getCenter(),a=l.getCenter(),{anchorStart:h,anchorEnd:f}=c.calculateCurveAnchors(d,a,e().getCenter(),n().getCenter());o().destinations.get(s()).path={start:d,end:a,anchorStart:h,anchorEnd:f,path:c.createDefaultCurvePath(d,a,h,f)}}),[(()=>{const c=Tn();return c.$$pointerdown=r=>{t.nodeflowData.eventStore.onPointerDownInNodeCurve.publish({event:r,sourceConnector:o(),destinationConnector:i()})},c.style.setProperty("cursor","pointer"),c.style.setProperty("pointer-events","visibleStroke"),E(r=>{const l=o().destinations.get(s()).path?.path,d={[t.css?.normal??""]:!0,[t.css?.selected??""]:t.nodeflowData.mouseData.heldConnection?.sourceConnector.parentSection.parentNode.id===t.sourceNodeId&&t.nodeflowData.mouseData.heldConnection?.sourceConnector.id===t.sourceConnectorId&&t.nodeflowData.mouseData.heldConnection?.destinationConnector.parentSection.parentNode.id===t.destinationNodeId&&t.nodeflowData.mouseData.heldConnection?.destinationConnector.id===t.destinationConnectorId};return l!==r._v$&&D(c,"d",r._v$=l),r._v$2=Zt(c,d,r._v$2),r},{_v$:void 0,_v$2:void 0}),c})(),x(ct,{get when(){return t.nodeflowData.settings.debugMode},get children(){return[(()=>{const c=Nt();return E(r=>{const l=o().destinations.get(s()).path?.anchorStart?.x,d=o().destinations.get(s()).path?.anchorStart?.y,a=t.css?.normal??"";return l!==r._v$3&&D(c,"cx",r._v$3=l),d!==r._v$4&&D(c,"cy",r._v$4=d),a!==r._v$5&&D(c,"class",r._v$5=a),r},{_v$3:void 0,_v$4:void 0,_v$5:void 0}),c})(),(()=>{const c=Nt();return E(r=>{const l=o().destinations.get(s()).path?.anchorEnd?.x,d=o().destinations.get(s()).path?.anchorEnd?.y,a=t.css?.normal??"";return l!==r._v$6&&D(c,"cx",r._v$6=l),d!==r._v$7&&D(c,"cy",r._v$7=d),a!==r._v$8&&D(c,"class",r._v$8=a),r},{_v$6:void 0,_v$7:void 0,_v$8:void 0}),c})()]}})]};Ge(["pointerdown"]);const Dt=ne("<div>"),Bn=t=>{const e=L(()=>t.nodeflowData.nodes.get(t.nodeId)),[n,o]=we(!1);return st(()=>{t.nodeflowData.mouseData.heldNodeId!==t.nodeId||!t.nodeflowData.mouseData.isDraggingObject||(e().position=t.nodeflowData.mouseData.mousePosition.divideBy(t.nodeflowData.zoomLevel).subtract(t.nodeflowData.mouseData.clickStartPosition??u.zero()))}),it(()=>{e().resizeObserver&&(e().resizeObserver.disconnect(),Array.from(e().connectorSections.values()).forEach(i=>{Array.from(i.connectors.values()).forEach(s=>{s.resizeObserver&&s.resizeObserver.disconnect()})}))}),(()=>{const i=Dt();return i.$$pointerup=s=>t.nodeflowData.eventStore.onPointerUpInNode.publish({event:s,nodeId:t.nodeId}),i.$$touchstart=s=>t.nodeflowData.eventStore.onTouchStartInNode.publish({event:s,nodeId:t.nodeId}),i.$$mousedown=s=>t.nodeflowData.eventStore.onMouseDownInNode.publish({event:s,nodeId:t.nodeId}),lt(s=>setTimeout(()=>{if(!s)return;const c=new ResizeObserver(()=>{e().update({size:u.of(s.clientWidth,s.clientHeight)}),Array.from(e().connectorSections.values()).forEach(l=>Array.from(l.connectors.values()).forEach(d=>{const a=d.ref;a&&(d.position=u.of((a?.parentElement?.offsetLeft??0)+a.offsetLeft,(a?.parentElement?.offsetTop??0)+a.offsetTop))}))});c.observe(s);const r=e().centered?u.of(s.clientWidth,s.clientHeight).divideBy(2):u.zero();e().update({offset:u.of(s.clientLeft,s.clientTop),ref:s,resizeObserver:c,position:e().position.subtract(r),size:u.of(s.clientWidth,s.clientHeight)}),o(!0)}),i),J(i,()=>e().display({node:e()}),null),J(i,x(re,{get each(){return Array.from(e().connectorSections.entries())},children:([s,c])=>(()=>{const r=Dt();return J(r,x(re,{get each(){return Array.from(c.connectors.entries())},children:([l,d])=>x(kn,{connector:d,connectorId:l,get nodeId(){return t.nodeId},sectionId:s,get nodeflowData(){return t.nodeflowData}})})),E(()=>at(r,c?.css)),r})()}),null),E(s=>{const c=`${e().position.x}px`,r=`${e().position.y}px`,l=n()?1:0,d={[e()?.css?.normal??""]:!0,[e()?.css?.selected??""]:t.nodeflowData.mouseData.heldNodeId===t.nodeId};return c!==s._v$&&((s._v$=c)!=null?i.style.setProperty("left",c):i.style.removeProperty("left")),r!==s._v$2&&((s._v$2=r)!=null?i.style.setProperty("top",r):i.style.removeProperty("top")),l!==s._v$3&&((s._v$3=l)!=null?i.style.setProperty("opacity",l):i.style.removeProperty("opacity")),s._v$4=Zt(i,d,s._v$4),s},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),i})()};Ge(["mousedown","touchstart","pointerup"]);const Un=ne('<div tabindex="0"><div><svg>'),Wn=t=>e=>(()=>{const n=Un(),o=n.firstChild,i=o.firstChild;return n.$$touchmove=s=>t.eventStore.onTouchMoveInNodeflow.publish({event:s}),n.$$touchstart=s=>t.eventStore.onTouchStartInNodeflow.publish({event:s}),n.$$keyup=s=>t.eventStore.onKeyUpInNodeflow.publish({event:s}),n.$$keydown=s=>t.eventStore.onKeyDownInNodeflow.publish({event:s}),n.$$mousedown=s=>t.eventStore.onMouseDownInNodeflow.publish({event:s}),n.addEventListener("wheel",s=>t.eventStore.onWheelInNodeflow.publish({event:s})),n.$$pointerup=s=>t.eventStore.onPointerUpInNodeflow.publish({event:s}),n.$$mousemove=s=>t.eventStore.onMouseMoveInNodeflow.publish({event:s}),lt(s=>{new ResizeObserver(()=>{t.update({size:u.of(s.clientWidth,s.clientHeight),startPosition:u.of(s.offsetLeft,s.offsetTop)})}).observe(s)},n),o.style.setProperty("position","absolute"),o.style.setProperty("transform-origin","center"),o.style.setProperty("transition","scale 0.1s ease-out"),J(o,x(re,{get each(){return Array.from(t.nodes.keys())},children:s=>x(Bn,{nodeId:s,nodeflowData:t})}),i),i.style.setProperty("z-index","2"),i.style.setProperty("position","absolute"),i.style.setProperty("width","1px"),i.style.setProperty("height","1px"),i.style.setProperty("pointer-events","none"),i.style.setProperty("overflow","visible"),J(i,x(re,{get each(){return Array.from(t.nodes.entries())},children:([s,c])=>x(re,{get each(){return c.getAllConnectors()},children:r=>x(re,{get each(){return r.destinations.array},children:l=>x(jn,{nodeflowData:t,sourceNodeId:s,get sourceConnectorId(){return r.id},get destinationNodeId(){return l.destinationConnector.parentSection.parentNode.id},get destinationConnectorId(){return l.destinationConnector.id},get css(){return l.css}})})})})),J(o,x(ct,{get when(){return t.mouseData.heldNodeId&&t.mouseData.heldConnectorId},get children(){return x(Ln,{get css(){return e?.css?.newCurve},nodeflowData:t})}}),null),E(s=>{const c=e?.css?.nodeflow,r=e.height,l=e.width,d=`scale(${t.zoomLevel}) translate(${t.position.x}px, ${t.position.y}px)`;return c!==s._v$&&at(n,s._v$=c),r!==s._v$2&&((s._v$2=r)!=null?n.style.setProperty("height",r):n.style.removeProperty("height")),l!==s._v$3&&((s._v$3=l)!=null?n.style.setProperty("width",l):n.style.removeProperty("width")),d!==s._v$4&&((s._v$4=d)!=null?o.style.setProperty("transform",d):o.style.removeProperty("transform")),s},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),n})();Ge(["mousemove","pointerup","mousedown","keydown","keyup","touchstart","touchmove"]);class ce{constructor(e){this.store=U(e)}get array(){return this.store[0]}get length(){return this.store[0].length}forEach(e){this.store[0].forEach(e)}filter(e){return this.store[0].filter(e)}filterInPlace(e){this.store[1](this.filter(e))}map(e){return this.store[0].map(e)}flatMap(e){return this.store[0].flatMap(e)}find(e){return this.store[0].find(e)}findIndex(e){return this.store[0].findIndex(e)}splice(e,n,...o){this.store[1](this.store[0].splice(e,n,...o))}reduce(e,n){return this.store[0].reduce(e,n)}some(e){return this.store[0].some(e)}every(e){return this.store[0].every(e)}get(e){return this.store[0][e]}set(e,n){this.store[1](e,n)}push(e){this.store[1](this.store[0].length,e)}}class Rn{currentChangeIndex=-1;constructor(e=-1){this.maxChanges=e,this.changes=[]}serialize(){return{changes:this.changes,currentChangeIndex:this.currentChangeIndex,maxChanges:this.maxChanges}}deserialize(e){this.changes=e.changes,this.currentChangeIndex=e.currentChangeIndex,this.maxChanges=e.maxChanges}addChange(e){this.changes=this.changes.slice(0,this.currentChangeIndex+1),this.changes.length===this.maxChanges&&this.changes.shift(),this.changes.push(e),this.currentChangeIndex=this.changes.length-1}undo(){return this.currentChangeIndex===-1?!1:(this.changes[this.currentChangeIndex].undoChange(),this.currentChangeIndex--,!0)}redo(){return this.currentChangeIndex===this.changes.length-1?!1:(this.currentChangeIndex++,this.changes[this.currentChangeIndex].applyChange(),!0)}}class Qt{constructor(e){this.nodeflowData=e}getHorizontalCurve=(e,n)=>u.of((n.x-e.x)/1.5,0);getVerticalCurve=(e,n)=>u.of(0,(n.y-e.y)/1.5);calculateCurveAnchors(e,n,o,i){const s=e.distanceTo(n)/300,c=o.add(e.subtract(o).multiplyBy(s)),r=i.add(n.subtract(i).multiplyBy(s));return{anchorStart:c,anchorEnd:r}}createDefaultCurvePath=(e,n,o,i)=>`M ${e.x} ${e.y} C ${o.x} ${o.y}, ${i.x} ${i.y}, ${n.x} ${n.y}`}class Kn{constructor(e){this.store=U(e)}get css(){return this.store[0].css}get destinationConnector(){return this.store[0].destinationConnector}get path(){return this.store[0].path}set css(e){this.store[1]({css:e})}set path(e){this.store[1]({path:e})}set destinationConnector(e){this.store[1]({destinationConnector:e})}update(e){this.store[1](e)}updateWithPrevious(e){this.store[1](e)}}const Se=(...t)=>{const e=t[0];return t.slice(1).reduce((o,i)=>new Set([...o].filter(s=>i.has(s))),e)},$e=t=>t.size===0,H=t=>typeof t!="object"||t===null||t===void 0?t:Array.isArray(t)?t.map(H):typeof t=="object"?Object.fromEntries(Object.entries(t).map(([e,n])=>[e,H(n)])):t;class dt{constructor(e){this.store=U(e)}serialize(){return{css:this.css,hovered:this.hovered,id:this.id,position:this.position.serialize()}}serializeConnections(){return[...this.destinations.map(({destinationConnector:e,css:n})=>({sourceNodeId:this.parentSection.parentNode.id,sourceConnectorId:this.id,destinationNodeId:e.parentSection.parentNode.id,destinationConnectorId:e.id,css:H(n)})),...this.sources.map(({sourceConnector:e})=>({sourceNodeId:e.parentSection.parentNode.id,sourceConnectorId:e.id,destinationNodeId:this.parentSection.parentNode.id,destinationConnectorId:this.id,css:H(e.destinations.find(n=>n.destinationConnector.parentSection.parentNode.id===this.parentSection.parentNode.id)?.css)}))]}static deserialize(e,n){const o=!e.id||n.connectors.has(e.id)?n.parentNode.getNextFreeConnectorId():e.id;return new dt({css:e.css,destinations:new ce([]),hovered:e.hovered??!1,id:o,parentSection:n,position:u.deserializeOrDefault(e.position),ref:void 0,resizeObserver:void 0,size:u.zero(),sources:new ce([])})}get css(){return this.store[0].css}values(){return this.store[0]}get destinations(){return this.store[0].destinations}get hovered(){return this.store[0].hovered}get id(){return this.store[0].id}get parentSection(){return this.store[0].parentSection}get position(){return this.store[0].position}get ref(){return this.store[0].ref}get resizeObserver(){return this.store[0].resizeObserver}get size(){return this.store[0].size}get sources(){return this.store[0].sources}set css(e){this.store[1]({css:e})}set destinations(e){this.store[1]({destinations:e})}set hovered(e){this.store[1]({hovered:e})}set id(e){this.store[1]({id:e})}set parentSection(e){this.store[1]({parentSection:e})}set position(e){this.store[1]({position:e})}set ref(e){this.store[1]({ref:e})}set resizeObserver(e){this.store[1]({resizeObserver:e})}set size(e){this.store[1]({size:e})}set sources(e){this.store[1]({sources:e})}update(e){this.store[1](e)}updateWithPrevious(e){this.store[1](e)}removeIncomingConnections(){this.sources.forEach(({sourceConnector:e})=>{e.destinations.filterInPlace(({destinationConnector:n})=>n.parentSection.parentNode.id!==this.id)}),this.sources=new ce([])}removeOutgoingConnections(){this.destinations.forEach(({destinationConnector:e})=>{e.sources.filterInPlace(({sourceConnector:n})=>n.parentSection.parentNode.id!==this.id)}),this.destinations=new ce([])}getCenter(){const{position:e,offset:n}=this.parentSection.parentNode;return e.add(n,this.position,this.size.divideBy(2))}}class Hn{constructor(e,n){this.nodeflowData=e,this.store=U(n)}serialize(){return{connectors:Object.fromEntries(Array.from(this.connectors.entries()).map(([e,n])=>[e,n.serialize()])),css:this.css,id:this.id}}removeConnector(e,n=!0){if(!this.connectors.has(e))return;const o=this.connectors.get(e);n&&this.nodeflowData.changes.addChange({type:"remove",source:"connector",applyChange:()=>{this.removeConnector(e,!1)},undoChange:()=>{this.addConnector(o.serialize(),!1)}}),this.connectors.delete(e)}addConnector(e,n=!0){const o=dt.deserialize(e,this);if(!this.connectors.has(o.id))return n&&this.nodeflowData.changes.addChange({type:"add",source:"connector",applyChange:()=>{this.addConnector(o.serialize(),!1)},undoChange:()=>{this.removeConnector(o.id,!1)}}),this.connectors.set(o.id,o),o}get connectors(){return this.store[0].connectors}get css(){return this.store[0].css}get id(){return this.store[0].id}get parentNode(){return this.store[0].parentNode}set connectors(e){this.store[1]({connectors:e})}set css(e){this.store[1]({css:e})}set id(e){this.store[1]({id:e})}set parentNode(e){this.store[1]({parentNode:e})}update(e){this.store[1](e)}updateWithPrevious(e){this.store[1](e)}removeIncomingConnections(){this.connectors.forEach(e=>e.removeIncomingConnections())}removeOutgoingConnections(){this.connectors.forEach(e=>e.removeOutgoingConnections())}getSourceConnectors(){return Array.from(this.connectors.values()).flatMap(e=>e.sources.flatMap(n=>n.sourceConnector))}getDestinationConnectors(){return Array.from(this.connectors.values()).flatMap(e=>e.destinations.flatMap(n=>n.destinationConnector))}}class Zn{constructor(e){this.store=U(e)}get sourceConnector(){return this.store[0].sourceConnector}set sourceConnector(e){this.store[1]({sourceConnector:e})}update(e){this.store[1](e)}updateWithPrevious(e){this.store[1](e)}}class Jt{subscriptions=new pe;blacklistFilters=new pe;blacklist(e,n){this.blacklistFilters.set(e,n)}unblacklist(e){this.blacklistFilters.delete(e)}unblacklistMultiple(e){e.forEach(this.unblacklist)}clearBlacklist(){this.blacklistFilters.clear()}subscribe(e,n,o=0){this.subscriptions.set(e,{name:e,event:n,priority:o})}subscribeMultiple(e){e.forEach(({name:n,event:o,priority:i})=>this.subscribe(n,o,i))}unsubscribe(e){this.subscriptions.delete(e)}unsubsribeMultiple(e){e.forEach(this.unsubscribe)}publish(e){Array.from(this.subscriptions.values()).sort((n,o)=>o.priority-n.priority).filter(({name:n,priority:o})=>!Array.from(this.blacklistFilters.values()).some(s=>s(e,n,o))).map(({event:n})=>n).forEach(n=>n(e))}clear(){this.subscriptions.clear()}get size(){return this.subscriptions.size}get isEmpty(){return this.size===0}}class y extends Jt{constructor(e){super(),this.nodeflowData=e}}class qe extends Jt{}class Gn{constructor(e){this.nodeflowData=e,this.store=U({clickStartPosition:void 0,heldConnection:void 0,heldConnectorId:void 0,heldNodeId:void 0,isDraggingObject:!1,mousePosition:u.zero()})}serialize(){const e=this.heldConnection?{sourceNodeId:this.heldConnection.sourceConnector.parentSection.parentNode.id,sourceConnectorId:this.heldConnection.sourceConnector.id,destinationNodeId:this.heldConnection.destinationConnector.parentSection.parentNode.id,destinationConnectorId:this.heldConnection.destinationConnector.id}:void 0;return{clickStartPosition:this.clickStartPosition?.serialize(),heldConnection:e,heldConnectorId:this.heldConnectorId,heldNodeId:this.heldNodeId}}deserialize(e){let n;if(e.heldConnection){const o=this.nodeflowData.nodes.get(e.heldConnection.sourceNodeId)?.getConnector(e.heldConnection.sourceConnectorId),i=this.nodeflowData.nodes.get(e.heldConnection.destinationNodeId)?.getConnector(e.heldConnection.destinationConnectorId);o&&i&&(n={sourceConnector:o,destinationConnector:i})}this.update({clickStartPosition:u.deserializeOrDefault(e.clickStartPosition),heldConnection:n,heldConnectorId:e.heldConnectorId,heldNodeId:e.heldNodeId})}get clickStartPosition(){return this.store[0].clickStartPosition}get isDraggingObject(){return this.store[0].isDraggingObject}get heldConnectorId(){return this.store[0].heldConnectorId}get heldNodeId(){return this.store[0].heldNodeId}get mousePosition(){return this.store[0].mousePosition}get heldConnection(){return this.store[0].heldConnection}set clickStartPosition(e){this.store[1]({clickStartPosition:e})}set isDraggingObject(e){this.store[1]({isDraggingObject:e})}set heldConnectorId(e){this.store[1]({heldConnectorId:e})}set heldNodeId(e){this.store[1]({heldNodeId:e})}set mousePosition(e){this.store[1]({mousePosition:e})}set heldConnection(e){this.store[1]({heldConnection:e})}update(e){this.store[1](e)}updateWithPrevious(e){this.store[1](e)}reset(){this.store[1]({isDraggingObject:!1,heldConnection:void 0,heldConnectorId:void 0,heldNodeId:void 0})}selectNode=(e,n,o=!0)=>{this.update({isDraggingObject:o,heldConnectorId:void 0,heldConnection:void 0,heldNodeId:e,mousePosition:n,clickStartPosition:n.divideBy(this.nodeflowData.zoomLevel).subtract(this.nodeflowData.nodes.get(e).position)})};deselectNode=()=>{this.update({heldNodeId:void 0,heldConnectorId:void 0,heldConnection:void 0}),this.nodeflowData.resetMovement()};startCreatingConnection=(e,n,o)=>{this.nodeflowData.settings.canCreateConnections&&this.update({isDraggingObject:!1,heldNodeId:e,heldConnectorId:o,mousePosition:n,clickStartPosition:n.divideBy(this.nodeflowData.zoomLevel).subtract(this.nodeflowData.nodes.get(e).position)})};globalMousePosition=()=>this.mousePosition.subtract(this.nodeflowData.startPosition).divideBy(this.nodeflowData.zoomLevel).subtract(this.nodeflowData.position)}const[Ue,Yn]=we(u.of(window.innerWidth,window.innerHeight));st(()=>{const t=()=>Yn(u.of(window.innerWidth,window.innerHeight));return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)});const Qe=(t,e,n)=>Math.min(Math.max(t,e),n),F=new Set,K={MOVE_DOWN:new Set(["ArrowDown","KeyS"]),MOVE_LEFT:new Set(["ArrowLeft","KeyA"]),MOVE_RIGHT:new Set(["ArrowRight","KeyD"]),MOVE_UP:new Set(["ArrowUp","KeyW"])};class ut{constructor(e,n){this.nodeflowData=e,this.store=U(n)}get centered(){return this.store[0].centered}get connectorSections(){return this.store[0].connectorSections}get css(){return this.store[0].css}get customData(){return this.store[0].customData}get display(){return this.store[0].display}get id(){return this.store[0].id}get offset(){return this.store[0].offset}get position(){return this.store[0].position}get ref(){return this.store[0].ref}get resizeObserver(){return this.store[0].resizeObserver}get size(){return this.store[0].size}set centered(e){this.store[1]({centered:e})}set connectorSections(e){this.store[1]({connectorSections:e})}set css(e){this.store[1]({css:e})}set customData(e){this.store[1]({customData:e})}set display(e){this.store[1]({display:e})}set id(e){this.store[1]({id:e})}set offset(e){this.store[1]({offset:e})}set position(e){this.store[1]({position:e})}set ref(e){this.store[1]({ref:e})}set resizeObserver(e){this.store[1]({resizeObserver:e})}set size(e){this.store[1]({size:e})}update(e){this.store[1](e)}serialize(){const e=Array.from(this.connectorSections.values()).reduce((n,o)=>(n[o.id]=o.serialize(),n),{});return{centered:this.centered,connectorSections:e,css:H(this.css),customData:H(this.customData),id:this.id,display:this.display,position:this.position.serialize()}}static deserialize(e,n){const o=n.id??e.getNextFreeNodeId(),i=new ut(e,{centered:n.centered??!1,connectorSections:new pe,css:H(n.css)??{},customData:H(n.customData)??{},display:n.display??(()=>{}),id:o,offset:u.zero(),position:u.deserializeOrDefault(n.position),ref:void 0,resizeObserver:void 0,size:u.zero()});return Object.entries(n.connectorSections??[]).forEach(([s,c])=>{i.addConnectorSection(s,c.css,!1),Object.values(c.connectors).forEach(r=>{i.addConnector(s,r,!1)})}),i}serializeConnections(){return Array.from(this.connectorSections.values()).flatMap(e=>Array.from(e.connectors.values()).flatMap(n=>n.serializeConnections()))}updateWithPrevious(e){this.store[1](e)}addConnectorSection=(e,n,o=!0)=>{(!e||this.connectorSections.has(e))&&(e=this.getNextFreeConnectorSectionId()),o&&this.nodeflowData.changes.addChange({type:"remove",source:"connector-section",applyChange:()=>{this.addConnectorSection(e,n,!1)},undoChange:()=>{this.removeConnectorSection(e,!1)}});const i=new Hn(this.nodeflowData,{connectors:new pe,css:n,id:e,parentNode:this});return this.connectorSections.set(e,i),i};removeConnectorSection(e,n=!0){if(!this.connectorSections.has(e))return;const o=this.connectorSections.get(e);n&&this.nodeflowData.changes.addChange({type:"remove",source:"connector-section",applyChange:()=>{this.removeConnectorSection(e,!1)},undoChange:()=>{this.addConnectorSection(e,o.css,!1)}}),this.connectorSections.delete(e)}getConnectorCount(){return Array.from(this.connectorSections.values()).reduce((e,n)=>e+n.connectors.size,0)}addConnector(e,n,o=!0){if(this.connectorSections.has(e))return this.connectorSections.get(e).addConnector(n,o)}removeConnector(e,n,o=!0){this.connectorSections.has(e)&&this.connectorSections.get(e).removeConnector(n,o)}getConnector(e){return this.getSectionFromConnector(e)?.connectors.get(e)}getTotalConnectedInputs(e){return this.getConnector(e)?.sources.length??0}getAllConnectors(){return Array.from(this.connectorSections.values()).reduce((e,n)=>e.concat(Array.from(n.connectors.values())),[])}getNextFreeConnectorSectionId(){let e="0";for(let n=1;this.connectorSections.has(e);++n)e=n.toString();return e}getNextFreeConnectorId(){let e="0";for(let n=1;Array.from(this.connectorSections.values()).some(o=>o.connectors.has(e));++n)e=n.toString();return e}removeIncomingConnections(){this.connectorSections.forEach(e=>e.removeIncomingConnections())}removeOutgoingConnections(){this.connectorSections.forEach(e=>e.removeOutgoingConnections())}getAllSourceConnectors(){return Array.from(this.connectorSections.values()).reduce((e,n)=>e.concat(n.getSourceConnectors()),[])}getAllDestinationConnectors(){return Array.from(this.connectorSections.values()).reduce((e,n)=>e.concat(n.getDestinationConnectors()),[])}getAllSourceConnections(){return this.getAllSourceConnectors().map(e=>e.destinations.filter(o=>o.destinationConnector.parentSection.parentNode.id===this.id).map(o=>({sourceNodeId:e.parentSection.parentNode.id,sourceConnectorId:e.id,destinationNodeId:o.destinationConnector.parentSection.parentNode.id,destinationConnectorId:o.destinationConnector.id,css:o.css}))).flat()}getAllDestinationConnections(){return this.getAllDestinationConnectors().map(e=>e.sources.filter(o=>o.sourceConnector.parentSection.parentNode.id===this.id).map(o=>({sourceNodeId:o.sourceConnector.parentSection.parentNode.id,sourceConnectorId:o.sourceConnector.id,destinationNodeId:e.parentSection.parentNode.id,destinationConnectorId:e.id}))).flat()}getSectionFromConnector(e){return Array.from(this.connectorSections.values()).find(n=>n.connectors.get(e))}getCenter(){return this.position.add(this.offset).add(this.size.divideBy(2))}}class ht{static DEFAULT_SETTINGS={canAddNodes:!0,canCreateConnections:!0,canDeleteConnections:!0,canDeleteNodes:!0,canMoveNodes:!0,canPan:!0,canZoom:!0,debugMode:!1,keyboardZoomMultiplier:15,maxMovementSpeed:15,maxZoom:200,minZoom:.02,movementAcceleration:1.5,movementSlowdown:.85,zoomMultiplier:.005};constructor(e,n){this.settingsStore=U({...ht.DEFAULT_SETTINGS,...e}),this.curveFunctions=n?.(this)??new Qt(this),this.store=U({currentMoveSpeed:u.zero(),position:u.zero(),startPosition:u.zero(),size:u.zero(),zoomLevel:1,pinchDistance:0}),this.changes=new Rn,this.mouseData=new Gn(this),this.nodes=new pe,this.eventStore={onKeyDownInNodeflow:new y(this),onKeyUpInNodeflow:new y(this),onMouseDownInConnector:new y(this),onMouseDownInNodeflow:new y(this),onMouseDownInNode:new y(this),onMouseMoveInNodeflow:new y(this),onNodeConnected:new y(this),onNodeDataChanged:new y(this),onPointerDownInNodeCurve:new y(this),onPointerUpInConnector:new y(this),onPointerUpInNodeflow:new y(this),onPointerUpInNode:new y(this),onTouchMoveInNodeflow:new y(this),onTouchStartInConnector:new y(this),onTouchStartInNodeflow:new y(this),onTouchStartInNode:new y(this),onWheelInNodeflow:new y(this)},this.setupDefaultEventHandlers(),setInterval(()=>{const o=!$e(Se(F,K.MOVE_LEFT)),i=!$e(Se(F,K.MOVE_RIGHT)),s=!$e(Se(F,K.MOVE_UP)),c=!$e(Se(F,K.MOVE_DOWN)),r=this.mouseData.heldNodeId!==void 0;this.currentMoveSpeed=u.of(this.calculateDirectionalMovementAmount(o||i,this.currentMoveSpeed.x,i,o,!r),this.calculateDirectionalMovementAmount(s||c,this.currentMoveSpeed.y,c,s,!r)),!r&&this.settings.canPan?this.updateBackgroundPosition(this.currentMoveSpeed,!0):r&&this.settings.canMoveNodes&&this.updateHeldNodePosition(this.currentMoveSpeed.divideBy(this.zoomLevel))},10)}serialize(){return{changes:this.changes.serialize(),connections:this.serializeConnections(),currentMoveSpeed:this.currentMoveSpeed.serialize(),mouseData:this.mouseData.serialize(),nodes:Object.fromEntries(Array.from(this.nodes.entries()).map(([e,n])=>[e,n.serialize()])),pinchDistance:this.pinchDistance,position:this.position.serialize(),size:this.size.serialize(),startPosition:this.startPosition.serialize(),zoomLevel:this.zoomLevel}}deserialize(e){this.update({currentMoveSpeed:u.deserializeOrDefault(e.currentMoveSpeed),pinchDistance:e.pinchDistance,position:u.deserializeOrDefault(e.position),size:u.deserializeOrDefault(e.size),startPosition:u.deserializeOrDefault(e.startPosition),zoomLevel:e.zoomLevel}),this.nodes.clear(),Object.entries(e.nodes).forEach(([n,o])=>{this.addNode(o,!1)}),this.mouseData.deserialize(e.mouseData),e.connections.forEach(n=>{this.addConnection(n,!1)}),this.changes.deserialize(e.changes)}serializeConnections(){return Array.from(this.nodes.values()).flatMap(e=>e.serializeConnections())}get settings(){return this.settingsStore[0]}updateSettings(e){this.settingsStore[1](e)}resetMovement=()=>{this.currentMoveSpeed=u.zero(),K.MOVE_LEFT.forEach(e=>F.delete(e)),K.MOVE_RIGHT.forEach(e=>F.delete(e)),K.MOVE_UP.forEach(e=>F.delete(e)),K.MOVE_DOWN.forEach(e=>F.delete(e))};get currentMoveSpeed(){return this.store[0].currentMoveSpeed}get position(){return this.store[0].position}get startPosition(){return this.store[0].startPosition}get size(){return this.store[0].size}get zoomLevel(){return this.store[0].zoomLevel}get pinchDistance(){return this.store[0].pinchDistance}set currentMoveSpeed(e){this.store[1]({currentMoveSpeed:e})}set position(e){this.store[1]({position:e})}set startPosition(e){this.store[1]({startPosition:e})}set size(e){this.store[1]({size:e})}set zoomLevel(e){this.store[1]({zoomLevel:e})}set pinchDistance(e){this.store[1]({pinchDistance:e})}update(e){this.store[1](e)}updateWithPrevious(e){this.store[1](e)}center(){const n=Ue().divideBy(2);return this.startPosition.add(n).divideBy(this.zoomLevel).subtract(this.position)}calculateDirectionalMovementAmount(e,n,o,i,s=!1){let c=n;if(e){const r=this.settings.movementAcceleration*(s?-1:1);c=Qe(c+(o?r:0)-(i?r:0),-this.settings.maxMovementSpeed,this.settings.maxMovementSpeed)}else c=Qe(c*this.settings.movementSlowdown,-this.settings.maxMovementSpeed,this.settings.maxMovementSpeed);return c<=.1&&c>=-.1&&(c=0),c}updateZoom=(e,n)=>{const o=this.zoomLevel;if(e===0)return;const i=Number(Qe(e>0?o+o*e*this.settings.zoomMultiplier:o/(1-e*this.settings.zoomMultiplier),this.settings.minZoom,this.settings.maxZoom).toFixed(4));this.mouseData.isDraggingObject=!1;const s=this.size,c=n.subtract(this.startPosition),r=s.multiplyBy(o),l=s.multiplyBy(i),d=c.subtract(r.divideBy(2)).divideBy(o),a=c.subtract(l.divideBy(2)).divideBy(i);this.updateWithPrevious(h=>({position:h.position.subtract(d).add(a),zoomLevel:i}))};updateBackgroundPosition(e,n=!1){this.mouseData.heldNodeId||n===this.mouseData.isDraggingObject||this.updateWithPrevious(o=>({position:o.position.add(e.divideBy(this.zoomLevel))}))}addNode(e,n=!0){const o=ut.deserialize(this,e);if(this.nodes.set(o.id,o),n){const i=o.serializeConnections();this.changes.addChange({type:"add",source:"node",applyChange:()=>{this.addNode(o.serialize(),!1),i.forEach(s=>{this.addConnection(s,!1)})},undoChange:()=>{this.removeNode(o.id,!1)}})}return o}updateNode(e,n,o=!0){if(!this.nodes.has(e))return;const i=this.nodes.get(e);if(o){const s=this.nodes.get(e),c=s.serializeConnections(),r=()=>{this.updateNode(e,n,!1)},l=()=>{this.updateNode(e,s,!1),c.forEach(d=>{this.addConnection(d,!1)})};this.changes.addChange({type:"update",source:"node",applyChange:r,undoChange:l})}this.eventStore.onNodeDataChanged.publish({nodeId:e,data:n}),i.updateWithPrevious(En(s=>Object.assign(s,n)))}removeNode(e,n=!0){if(this.nodes.has(e)){if(this.mouseData.deselectNode(),n){const o=this.nodes.get(e),i=o.serializeConnections();this.changes.addChange({type:"remove",source:"node",applyChange:()=>{this.removeNode(e,!1)},undoChange:()=>{this.addNode(o.serialize(),!1),i.forEach(s=>{this.addConnection(s,!1)})}})}this.removeIncomingConnections(e),this.removeOutgoingConnections(e),this.nodes.delete(e)}}removeIncomingConnections(e){this.nodes.has(e)&&this.nodes.get(e).connectorSections.forEach(n=>{n.connectors.forEach(o=>{o.sources.forEach(({sourceConnector:i})=>{i.destinations.filterInPlace(({destinationConnector:s})=>s.parentSection.parentNode.id!==e)}),o.sources=new ce([])})})}removeOutgoingConnections(e){this.nodes.has(e)&&this.nodes.get(e).connectorSections.forEach(n=>{n.connectors.forEach(o=>{o.destinations.forEach(({destinationConnector:i})=>{i.sources.filterInPlace(({sourceConnector:s})=>s.parentSection.parentNode.id!==e)}),o.destinations=new ce([])})})}getAllSourceConnectors(e){return this.nodes.has(e)?this.nodes.get(e).getAllSourceConnectors():[]}getAllDestinationConnectors(e){return this.nodes.has(e)?this.nodes.get(e).getAllDestinationConnectors():[]}getAllSourceConnections(e){return this.nodes.has(e)?this.nodes.get(e).getAllSourceConnections():[]}getAllDestinationConnections(e){return this.nodes.has(e)?this.nodes.get(e).getAllDestinationConnections():[]}getNextFreeNodeId(){let e="0";for(let n=1;this.nodes.has(e);++n)e=n.toString();return e}addConnection(e,n=!0){const{sourceNodeId:o,sourceConnectorId:i,destinationNodeId:s,destinationConnectorId:c,css:r}=e;if(!this.nodes.has(o)||!this.nodes.has(s))return;const l=this.nodes.get(o),d=this.nodes.get(s),a=l.getConnector(i),h=d.getConnector(c);!a||!h||a.destinations.some(f=>f.destinationConnector===h)||(n&&this.changes.addChange({type:"add",source:"connection",applyChange:()=>this.addConnection(e,!1),undoChange:()=>this.removeConnection(o,i,s,c,!1)}),a.destinations.push(new Kn({destinationConnector:h,css:r??{}})),h.sources.push(new Zn({sourceConnector:a})))}removeConnection(e,n,o,i,s=!0){if(!this.nodes.has(e)||!this.nodes.has(o))return;const c=this.nodes.get(e),r=this.nodes.get(o),l=c.getConnector(n),d=r.getConnector(i);if(!(!l||!d)){if(s){const a=l.destinations.find(g=>g.destinationConnector.parentSection.parentNode.id===o)?.css,h=()=>{this.addConnection({sourceNodeId:e,sourceConnectorId:n,destinationNodeId:o,destinationConnectorId:i,css:a},!1)},f=()=>{this.removeConnection(e,n,o,i,!1)};this.changes.addChange({type:"remove",source:"connection",applyChange:f,undoChange:h})}l.destinations.filterInPlace(a=>a.destinationConnector.parentSection.parentNode.id!==o),d.sources.filterInPlace(a=>a.sourceConnector.parentSection.parentNode.id!==e)}}updateHeldNodePosition(e){const n=this.mouseData.heldNodeId;if(!n||!this.nodes.has(n))return;this.nodes.get(n).updateWithPrevious(i=>({position:i.position.add(e)}))}setupDefaultEventHandlers(){this.eventStore.onNodeConnected.subscribeMultiple([{name:"create-connection",event:e=>this.addConnection({sourceNodeId:e.inputNodeId,sourceConnectorId:e.inputId,destinationNodeId:e.outputNodeId,destinationConnectorId:e.outputId})},{name:"reset-mouse-data",event:()=>this.mouseData.reset()}]),this.eventStore.onMouseMoveInNodeflow.subscribeMultiple([{name:"update-background-position",event:({event:e})=>{this.updateBackgroundPosition(u.of(e.movementX,e.movementY))}}]),this.eventStore.onPointerUpInNodeflow.subscribeMultiple([{name:"stop-propagation",event:({event:e})=>{e.stopPropagation(),e.preventDefault()}},{name:"reset-mouse-data",event:()=>this.mouseData.updateWithPrevious(e=>({isDraggingObject:!1,heldConnectorId:void 0,heldNodeId:e.heldConnectorId?void 0:e.heldNodeId}))}]),this.eventStore.onTouchStartInNodeflow.subscribeMultiple([{name:"stop-propagation",event:({event:e})=>e.stopPropagation()},{name:"clear-held-keys",event:({event:e})=>{e.touches.length===1&&F.clear()}},{name:"handle-pinch",event:({event:e})=>{const{touches:n}=e;if(n.length!==2)return;const{pageX:o,pageY:i}=e.touches[0],{pageX:s,pageY:c}=e.touches[1];this.pinchDistance=Math.hypot(o-s,i-c)}},{name:"update-mouse-data",event:({event:e})=>{const{touches:n}=e;if(n.length!==1)return;const o=n[0],i=u.fromEvent(o);this.mouseData.update({isDraggingObject:!0,heldNodeId:void 0,mousePosition:i,clickStartPosition:u.of(i.x/this.zoomLevel-this.position.x,i.y/this.zoomLevel-this.position.y)})}}]),this.eventStore.onTouchMoveInNodeflow.subscribeMultiple([{name:"handle-pinch",event:({event:e})=>{const{touches:n}=e;if(n.length!==2)return;const{pageX:o,pageY:i}=n[0],{pageX:s,pageY:c}=n[1],r=Math.hypot(o-s,i-c),l=u.of((o+s)/2,(i+c)/2);this.settings.canZoom&&this.updateZoom(r-this.pinchDistance,l),this.pinchDistance=r}},{name:"update-mouse-data",event:({event:e})=>{const{touches:n}=e;n.length===1&&this.mouseData.updateWithPrevious(o=>{const i=u.fromEvent(n[0]);return this.updateBackgroundPosition(i.subtract(o.mousePosition)),{mousePosition:i}})}}]),this.eventStore.onKeyUpInNodeflow.subscribe("remove-held-key",({event:e})=>F.delete(e.key)),this.eventStore.onKeyDownInNodeflow.subscribeMultiple([{name:"add-held-key",event:({event:e})=>F.add(e.key)},{name:"handle-controls",event:({event:e})=>{switch(e.code){case"Delete":this.mouseData.heldNodeId&&this.settings.canDeleteNodes?this.removeNode(this.mouseData.heldNodeId):this.mouseData.heldConnection&&this.settings.canDeleteConnections&&this.removeConnection(this.mouseData.heldConnection.sourceConnector.parentSection.parentNode.id,this.mouseData.heldConnection.sourceConnector.id,this.mouseData.heldConnection.destinationConnector.parentSection.parentNode.id,this.mouseData.heldConnection.destinationConnector.id);break;case"Escape":this.mouseData.deselectNode();break;case"Space":this.settings.debugMode&&(this.mouseData.heldNodeId?console.log(this.nodes.get(this.mouseData.heldNodeId)):console.log(this.nodes));break;case"Equal":case"Minus":if(e.ctrlKey){if(!this.settings.canZoom)return;e.preventDefault(),this.updateZoom(this.settings.keyboardZoomMultiplier*(e.code==="Equal"?1:-1),Ue().divideBy(2))}break;case"KeyZ":if(!e.ctrlKey)break;e.preventDefault(),e.shiftKey?this.changes.redo():this.changes.undo();break}}}]),this.eventStore.onWheelInNodeflow.subscribeMultiple([{name:"update-zoom",event:({event:e})=>{this.settings.canZoom&&this.updateZoom(-e.deltaY,u.fromEvent(e))}},{name:"prevent-scroll",event:({event:e})=>{e.preventDefault()}}]),this.eventStore.onMouseDownInNodeflow.subscribeMultiple([{name:"reset-movement",event:()=>this.resetMovement()},{name:"reset-mouse-data",event:({event:e})=>{this.mouseData.update({clickStartPosition:u.of(e.clientX/this.zoomLevel-this.position.x,e.clientY/this.zoomLevel-this.position.y),isDraggingObject:this.settings.canPan,heldConnection:void 0,heldConnectorId:void 0,heldNodeId:void 0,mousePosition:u.fromEvent(e)})}},{name:"stop-propagation",event:({event:e})=>e.stopPropagation()}]),this.eventStore.onMouseDownInConnector.subscribeMultiple([{name:"stop-propagation",event:({event:e})=>e.stopPropagation()},{name:"start-creating-connection",event:({event:e,nodeId:n,connectorId:o})=>{this.mouseData.startCreatingConnection(n,u.fromEvent(e),o)}}]),this.eventStore.onTouchStartInConnector.subscribeMultiple([{name:"stop-propagation",event:({event:e})=>e.stopPropagation()},{name:"start-creating-connection",event:({event:e,nodeId:n,connectorId:o})=>{const{clientX:i,clientY:s}=e.touches[0];this.mouseData.startCreatingConnection(n,u.of(i,s),o)}}]),this.eventStore.onPointerUpInConnector.subscribeMultiple([{name:"stop-propagation",event:({event:e})=>{e.preventDefault(),e.stopPropagation()},priority:2},{name:"connect-held-nodes",event:({event:e,nodeId:n,connectorId:o})=>{this.settings.canCreateConnections&&this.mouseData.heldConnectorId&&this.eventStore.onNodeConnected.publish({outputNodeId:this.mouseData.heldNodeId,outputId:this.mouseData.heldConnectorId,inputNodeId:n,inputId:o,event:e})},priority:2},{name:"reset-mouse-data",event:()=>this.mouseData.update({isDraggingObject:!1,heldConnectorId:void 0,heldNodeId:void 0}),priority:1}]),this.eventStore.onMouseDownInNode.subscribeMultiple([{name:"select-node",event:({event:e,nodeId:n})=>{this.mouseData.selectNode(n,u.fromEvent(e),this.settings.canMoveNodes)}},{name:"stop-propagation",event:({event:e})=>e.stopPropagation()}]),this.eventStore.onTouchStartInNode.subscribeMultiple([{name:"select-node",event:({event:e,nodeId:n})=>{const{clientX:o,clientY:i}=e.touches[0];this.mouseData.selectNode(n,u.of(o,i),this.settings.canMoveNodes)}},{name:"stop-propagation",event:({event:e})=>e.stopPropagation()}]),this.eventStore.onPointerDownInNodeCurve.subscribeMultiple([{name:"stop-propagation",event:({event:e})=>{e.preventDefault(),e.stopPropagation()},priority:1},{name:"update-mouse-data",event:({event:e,sourceConnector:n,destinationConnector:o})=>this.mouseData.update({isDraggingObject:!1,heldConnection:{sourceConnector:n,destinationConnector:o},heldConnectorId:void 0,heldNodeId:void 0,mousePosition:u.fromEvent(e)})}]),this.eventStore.onPointerUpInNode.subscribeMultiple([{name:"reset-mouse-data",event:()=>this.mouseData.update({isDraggingObject:!1,heldConnection:void 0,heldConnectorId:void 0})}])}}class Z{constructor(){this.nodeflows=new Map,this.globalEventStore={onMouseMoveInDocument:new qe,onPointerLeaveFromDocument:new qe,onPointerUpInDocument:new qe},this.setupDefaultEventHandlers()}static get(){return this.instance||(Z.instance=new Z),Z.instance}createCanvas(e,...n){const o=new ht(...n);return this.nodeflows.set(e,o),[o,Wn(o)]}getNodeflow(e){return this.nodeflows.get(e)}removeNodeflow(e){this.nodeflows.delete(e)}clear(){this.nodeflows.clear()}hasNodeflow(e){return this.nodeflows.has(e)}setupDefaultEventHandlers(){document.onmousemove=e=>this.globalEventStore.onMouseMoveInDocument.publish({event:e}),document.onpointerleave=e=>this.globalEventStore.onPointerLeaveFromDocument.publish({event:e}),document.onpointerup=e=>this.globalEventStore.onPointerUpInDocument.publish({event:e}),this.globalEventStore.onMouseMoveInDocument.subscribeMultiple([{name:"update-mouse-position",event:({event:e})=>{this.nodeflows.forEach(n=>{n.mouseData.mousePosition=u.fromEvent(e)})}}]),this.globalEventStore.onPointerLeaveFromDocument.subscribeMultiple([{name:"reset-mouse-data",event:()=>{this.nodeflows.forEach(e=>{e.mouseData.reset()})}}]),this.globalEventStore.onPointerUpInDocument.subscribeMultiple([])}}const Xn="_fatherCurve_12xj5_1",Vn="_motherCurve_12xj5_15",qn="_selectedFatherCurve_12xj5_29",Qn="_selectedMotherCurve_12xj5_40",Jn="_newFatherCurve_12xj5_51",eo="_newMotherCurve_12xj5_62",ae={fatherCurve:Xn,motherCurve:Vn,selectedFatherCurve:qn,selectedMotherCurve:Qn,newFatherCurve:Jn,newMotherCurve:eo},to="_nodeflow_1mhat_1",no={nodeflow:to},oo="_femaleNode_1r50o_1",so="_maleNode_1r50o_25",io="_selectedMaleNode_1r50o_49",ro="_selectedFemaleNode_1r50o_72",co="_inputConnector_1r50o_95",ao="_maleOutputConnector_1r50o_110",lo="_femaleOutputConnector_1r50o_126",uo="_inputsSection_1r50o_142",ho="_outputsSection_1r50o_151",fo="_nodeFont_1r50o_160",_={femaleNode:oo,maleNode:so,selectedMaleNode:io,selectedFemaleNode:ro,inputConnector:co,maleOutputConnector:ao,femaleOutputConnector:lo,inputsSection:uo,outputsSection:ho,nodeFont:fo},go=$("<p>"),mo=t=>(()=>{const e=go();return I(e,()=>t.node.customData?.name),k(()=>w(e,_.nodeFont)),e})(),en=async t=>await(await fetch(`https://randomuser.me/api/?inc=gender,name&noinfo&results=${t}`)).json().then(n=>n.results).then(n=>n.map(o=>({gender:o.gender==="female"?"F":"M",name:o.name.first+" "+o.name.last}))),De=t=>({normal:t=="M"?ae.fatherCurve:ae.motherCurve,selected:t=="M"?ae.selectedFatherCurve:ae.selectedMotherCurve}),ft=(t,e,n,o)=>{const i=t.addNode({css:{normal:n==="M"?_.maleNode:_.femaleNode,selected:n==="M"?_.selectedMaleNode:_.selectedFemaleNode},position:o,customData:{gender:n,name:e},display:mo,centered:!0}),s=i.addConnectorSection("inputs",_.inputsSection,!1);return i.addConnectorSection("outputs",_.outputsSection,!1).addConnector({id:"O",css:n==="M"?_.maleOutputConnector:_.femaleOutputConnector},!1),s.addConnector({id:"I",css:_.inputConnector},!1),i},vo=async(t,e=50)=>{const n=await en(e);for(const o of n)ft(t,o.name,o.gender,u.of((Math.random()*2-1)*2e3,(Math.random()*2-1)*2e3))},po=t=>{t.eventStore.onPointerUpInConnector.blacklist("prevent-connections-to-parent-connectors",({connectorId:e},n)=>e==="O"&&n==="connect-held-nodes"),t.eventStore.onTouchStartInConnector.blacklist("prevent-connections-from-parent-connectors",({connectorId:e})=>e==="I"),t.eventStore.onMouseDownInConnector.blacklist("prevent-connections-from-parent-connectors",({connectorId:e})=>e==="I"),t.eventStore.onPointerUpInNodeflow.subscribe("spawn-new-node",()=>{const e=t.mouseData.heldNodeId,n=t.mouseData.heldConnectorId;if(!e||!n)return;const o=t.mouseData.globalMousePosition();en(1).then(i=>{const s=ft(t,i[0].name,i[0].gender,o),c=t.nodes.get(e);t.addConnection({sourceNodeId:e,sourceConnectorId:"O",destinationNodeId:s.id,destinationConnectorId:"I",css:De(c.customData.gender)})})},1),t.eventStore.onNodeDataChanged.subscribe("update-node-css",({nodeId:e,data:n})=>{if(!t.nodes.has(e)||!("customData"in n))return;const o=t.nodes.get(e),i=n.customData;if(!("gender"in i))return;const s=i.gender;s!==o.customData.gender&&(t.updateNode(e,{css:{normal:s==="M"?_.maleNode:_.femaleNode,selected:s==="M"?_.selectedMaleNode:_.selectedFemaleNode}}),t.removeOutgoingConnections(e))}),t.eventStore.onNodeConnected.subscribe("create-connection",({outputNodeId:e,inputNodeId:n})=>{const o=t.nodes.get(e),i=t.nodes.get(n);if(e===n)return;const s=i.getConnector("I")?.sources;s?.length===2||s?.some(c=>c.sourceConnector.parentSection.parentNode.customData.gender===o.customData.gender)||t.addConnection({sourceNodeId:e,sourceConnectorId:"O",destinationNodeId:n,destinationConnectorId:"I",css:De(o.customData.gender)})}),t.eventStore.onPointerUpInNode.subscribe("create-connection",({nodeId:e})=>{const n=t.nodes.get(e),o=t.mouseData.heldNodeId;if(!n||!o||e===o||!t.nodes.has(o))return;const i=t.nodes.get(o),s=n.getConnector("I")?.sources;s?.length===2||s?.some(c=>c.sourceConnector.parentSection.parentNode.customData.gender===i.customData.gender)||t.addConnection({sourceNodeId:o,sourceConnectorId:"O",destinationNodeId:e,destinationConnectorId:"I",css:De(i.customData.gender)})})},Co=t=>{const e=t.nodes.size;for(let n=0;n<e;n++){const o=Math.floor(Math.random()*e),i=Math.floor(Math.random()*e);if(!t.nodes.has(o.toString())||!t.nodes.has(i.toString()))continue;const s=t.nodes.get(o.toString()),c=t.nodes.get(i.toString()),r=s.customData.gender,l=c.getConnector("I")?.sources;o===i||l?.length===2||l?.some(d=>d.sourceConnector.parentSection.parentNode.customData.gender===r)||t.addConnection({sourceNodeId:o.toString(),sourceConnectorId:"O",destinationNodeId:i.toString(),destinationConnectorId:"I",css:De(s.customData.gender)})}},_t=t=>t?t.trim().replace(/\s+/g," "):"",yo="_sidebar_1fnk3_1",wo="_sidebarContent_1fnk3_105",_e={"sidebar-container":"_sidebar-container_1fnk3_1","sidebar-container-closed":"_sidebar-container-closed_1fnk3_29",sidebar:yo,"sidebar-toggle":"_sidebar-toggle_1fnk3_57","sidebar-toggle-closed":"_sidebar-toggle-closed_1fnk3_82",sidebarContent:wo},bo=""+new URL("right-arrow-890fb5bd.svg",import.meta.url).href,So=$('<div><div></div><img alt="Toggle sidebar">'),$o=t=>{const[e,n]=zt(!1);return(()=>{const o=So(),i=o.firstChild,s=i.nextSibling;return I(i,()=>t.children),s.$$click=()=>n(!e()),mt(s,"src",bo),mt(s,"draggable",!1),k(c=>{const r=_e[e()?"sidebar-container":"sidebar-container-closed"],l=_e.sidebar,d=_e[e()?"sidebar-toggle":"sidebar-toggle-closed"];return r!==c._v$&&w(o,c._v$=r),l!==c._v$2&&w(i,c._v$2=l),d!==c._v$3&&w(s,c._v$3=d),c},{_v$:void 0,_v$2:void 0,_v$3:void 0}),o})()};ot(["click"]);const No="_formButtonContainer_y7uod_1",Do="_displayContainer_y7uod_8",_o="_fieldDisplayContainer_y7uod_20",Io="_femaleFont_y7uod_39",Mo="_maleFont_y7uod_43",Po="_radioInputFemale_y7uod_47",xo="_radioInputMale_y7uod_109",Eo="_horizontalRadioContainer_y7uod_171",O={formButtonContainer:No,displayContainer:Do,fieldDisplayContainer:_o,femaleFont:Io,maleFont:Mo,radioInputFemale:Po,radioInputMale:xo,horizontalRadioContainer:Eo},Ao=$("<div><h2>Selected Node</h2><div><p>Name</p><p></p></div><div><p>Gender</p><p>"),zo=t=>(()=>{const e=Ao(),n=e.firstChild,o=n.nextSibling,i=o.firstChild,s=i.nextSibling,c=o.nextSibling,r=c.firstChild,l=r.nextSibling;return I(s,()=>t.nodeData.name),I(l,()=>t.nodeData.gender==="F"?"Female":"Male"),k(d=>{const a=O.displayContainer,h=O.fieldDisplayContainer,f=O.fieldDisplayContainer,g=O[t.nodeData.gender==="F"?"femaleFont":"maleFont"];return a!==d._v$&&w(e,d._v$=a),h!==d._v$2&&w(o,d._v$2=h),f!==d._v$3&&w(c,d._v$3=f),g!==d._v$4&&w(l,d._v$4=g),d},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0}),e})(),We={MAIN_NODEFLOW:"main-nodeflow"},Oo=$("<button>Add"),It=$("<button>Save"),Mt=$("<button>Cancel"),ko=$("<button>Edit"),Pt=$("<button>Delete"),Fo=$("<div>"),xt=t=>(()=>{const e=Oo();return e.$$click=()=>t.onClick(),e})(),Lo=t=>{const e=Z.get().getNodeflow(We.MAIN_NODEFLOW),n=()=>t.setFormData({name:""}),o=()=>t.setFormData(void 0),i=()=>t.setFormData({...t.nodeData}),s=()=>{e.removeNode(t.formData.id),t.setFormData(void 0)},c=()=>e.removeNode(t.nodeData.id),r=()=>{if(!t.formData?.name||!t.formData?.gender)return;const d=ft(e,_t(t.formData.name),t.formData.gender,e.center());e.mouseData.selectNode(d.id,e.mouseData.mousePosition,!1),t.setFormData(void 0)},l=()=>{e.updateNode(t.formData.id,{customData:{...t.formData,name:_t(t.formData.name)}}),t.setFormData(void 0)};return(()=>{const d=Fo();return I(d,C(Q,{get when(){return t.mode==="empty"},get children(){return C(xt,{onClick:n})}}),null),I(d,C(Q,{get when(){return t.mode==="add"},get children(){return[(()=>{const a=It();return a.$$click=r,a})(),(()=>{const a=Mt();return a.$$click=o,a})()]}}),null),I(d,C(Q,{get when(){return t.mode==="view"},get children(){return[C(xt,{onClick:n}),(()=>{const a=ko();return a.$$click=i,a})(),(()=>{const a=Pt();return a.$$click=c,a})()]}}),null),I(d,C(Q,{get when(){return t.mode==="edit"},get children(){return[(()=>{const a=It();return a.$$click=l,a})(),(()=>{const a=Mt();return a.$$click=o,a})(),(()=>{const a=Pt();return a.$$click=s,a})()]}}),null),k(()=>w(d,O.formButtonContainer)),d})()};ot(["click"]);const To=$('<svg fill=#0078ea height=256px width=256px version=1.1 id=Capa_1 xmlns=http://www.w3.org/2000/svg viewBox="-30.6 -30.6 673.20 673.20"stroke=#0078ea><g id=SVGRepo_bgCarrier stroke-width=0></g><g id=SVGRepo_tracerCarrier stroke-linecap=round stroke-linejoin=round stroke=#080808 stroke-width=36.71988><g><path d="M569.569,0H413.755c-23.403,0-42.377,18.973-42.377,42.375s18.973,42.375,42.377,42.375h53.51L348.501,203.513 c-36.655-24.899-79.878-38.296-125.165-38.296c-59.67,0-115.768,23.237-157.961,65.429c-87.098,87.102-87.098,228.824,0,315.922 c42.193,42.193,98.291,65.431,157.961,65.431s115.768-23.237,157.961-65.431c76.855-76.855,85.878-196.233,27.101-283.094 l118.797-118.795v53.51c0,23.403,18.973,42.375,42.375,42.375c23.405,0,42.375-18.973,42.375-42.375V42.375 C611.945,18.973,592.972,0,569.569,0z M321.369,486.64c-26.186,26.186-61.001,40.607-98.032,40.607s-71.846-14.421-98.032-40.607 c-54.054-54.056-54.054-142.009,0-196.066c26.186-26.186,61.001-40.605,98.032-40.605s71.848,14.421,98.032,40.605 C375.422,344.632,375.422,432.587,321.369,486.64z"></path></g></g><g id=SVGRepo_iconCarrier><g><path d="M569.569,0H413.755c-23.403,0-42.377,18.973-42.377,42.375s18.973,42.375,42.377,42.375h53.51L348.501,203.513 c-36.655-24.899-79.878-38.296-125.165-38.296c-59.67,0-115.768,23.237-157.961,65.429c-87.098,87.102-87.098,228.824,0,315.922 c42.193,42.193,98.291,65.431,157.961,65.431s115.768-23.237,157.961-65.431c76.855-76.855,85.878-196.233,27.101-283.094 l118.797-118.795v53.51c0,23.403,18.973,42.375,42.375,42.375c23.405,0,42.375-18.973,42.375-42.375V42.375 C611.945,18.973,592.972,0,569.569,0z M321.369,486.64c-26.186,26.186-61.001,40.607-98.032,40.607s-71.846-14.421-98.032-40.607 c-54.054-54.056-54.054-142.009,0-196.066c26.186-26.186,61.001-40.605,98.032-40.605s71.848,14.421,98.032,40.605 C375.422,344.632,375.422,432.587,321.369,486.64z">'),jo=()=>To(),Bo=$('<svg fill=#ea0078 height=256px width=256px version=1.1 id=Capa_1 xmlns=http://www.w3.org/2000/svg viewBox="-23.86 -23.86 524.86 524.86"stroke=#cb3283 stroke-width=0.00477141><g id=SVGRepo_bgCarrier stroke-width=0></g><g id=SVGRepo_tracerCarrier stroke-linecap=round stroke-linejoin=round stroke=#080808 stroke-width=28.62846><g><path d="M326.711,341.99h-64.628v-64.634c0-0.686-0.142-1.323-0.213-1.997c65.409-11.119,115.378-68.161,115.378-136.681 C377.249,62.208,315.044,0,238.571,0C162.103,0,99.892,62.208,99.892,138.678c0,68.521,49.973,125.562,115.375,136.681 c-0.059,0.674-0.204,1.312-0.204,1.997v64.634h-64.631c-12.983,0-23.501,10.527-23.501,23.502c0,12.98,10.518,23.507,23.501,23.507 h64.637v64.64c0,12.98,10.524,23.502,23.501,23.502c12.979,0,23.513-10.527,23.513-23.502v-64.64h64.628 c12.986,0,23.508-10.526,23.508-23.507C350.219,352.518,339.698,341.99,326.711,341.99z M146.904,138.678 c0-50.546,41.121-91.673,91.667-91.673c50.549,0,91.676,41.122,91.676,91.673s-41.127,91.667-91.676,91.667 C188.031,230.346,146.904,189.224,146.904,138.678z"></path></g></g><g id=SVGRepo_iconCarrier><g><path d="M326.711,341.99h-64.628v-64.634c0-0.686-0.142-1.323-0.213-1.997c65.409-11.119,115.378-68.161,115.378-136.681 C377.249,62.208,315.044,0,238.571,0C162.103,0,99.892,62.208,99.892,138.678c0,68.521,49.973,125.562,115.375,136.681 c-0.059,0.674-0.204,1.312-0.204,1.997v64.634h-64.631c-12.983,0-23.501,10.527-23.501,23.502c0,12.98,10.518,23.507,23.501,23.507 h64.637v64.64c0,12.98,10.524,23.502,23.501,23.502c12.979,0,23.513-10.527,23.513-23.502v-64.64h64.628 c12.986,0,23.508-10.526,23.508-23.507C350.219,352.518,339.698,341.99,326.711,341.99z M146.904,138.678 c0-50.546,41.121-91.673,91.667-91.673c50.549,0,91.676,41.122,91.676,91.673s-41.127,91.667-91.676,91.667 C188.031,230.346,146.904,189.224,146.904,138.678z">'),Uo=()=>Bo(),Wo=$("<h2>Update Node"),Ro=$("<div><div><p>Name</p><input type=text name=lname placeholder=Name></div><div><p>Gender</p><div><input type=radio id=male name=gender value=M><label for=male>Male</label></div><div><input type=radio id=female name=gender value=M><label for=female>Female"),Ko=$("<h2>Create Node"),Ho=t=>(()=>{const e=Ro(),n=e.firstChild,o=n.firstChild,i=o.nextSibling,s=n.nextSibling,c=s.firstChild,r=c.nextSibling,l=r.firstChild,d=l.nextSibling,a=r.nextSibling,h=a.firstChild,f=h.nextSibling;return I(e,C(Q,{get when(){return t.formData.id},get fallback(){return Ko()},get children(){return Wo()}}),n),i.$$input=g=>t.updateFormData({name:g.target.value}),l.addEventListener("change",()=>t.updateFormData({gender:"M"})),I(r,C(jo,{}),d),h.addEventListener("change",()=>t.updateFormData({gender:"F"})),I(a,C(Uo,{}),f),k(g=>{const A=O.displayContainer,W=O.fieldDisplayContainer,V=O.fieldDisplayContainer,q=O.horizontalRadioContainer,M=O.radioInputMale,P=O.horizontalRadioContainer,z=O.radioInputFemale;return A!==g._v$&&w(e,g._v$=A),W!==g._v$2&&w(n,g._v$2=W),V!==g._v$3&&w(s,g._v$3=V),q!==g._v$4&&w(r,g._v$4=q),M!==g._v$5&&w(l,g._v$5=M),P!==g._v$6&&w(a,g._v$6=P),z!==g._v$7&&w(h,g._v$7=z),g},{_v$:void 0,_v$2:void 0,_v$3:void 0,_v$4:void 0,_v$5:void 0,_v$6:void 0,_v$7:void 0}),k(()=>i.value=t.formData.name),k(()=>l.checked=t.formData.gender==="M"),k(()=>h.checked=t.formData.gender==="F"),e})();ot(["input"]);const Zo=$("<div><h1>Family Tree"),Go=$("<h2>No Node Selected"),Yo=()=>{const[t,e]=zt(void 0),n=le(()=>{if(!Z.get().hasNodeflow(We.MAIN_NODEFLOW))return;const s=Z.get().getNodeflow(We.MAIN_NODEFLOW),c=s.mouseData.heldNodeId;if(!(!c||!s.nodes.has(c)))return{...s.nodes.get(c).customData,id:c}}),o=le(()=>t()!==void 0||n()!==void 0),i=le(()=>{if(!o())return"empty";const s=t();return s!==void 0?s.id?"edit":"add":"view"});return(()=>{const s=Zo();return s.firstChild,I(s,C(Q,{get when(){return o()},get fallback(){return Go()},get children(){return C(Q,{get when(){return t()!==void 0},get fallback(){return C(zo,{get nodeData(){return n()}})},get children(){return C(Ho,{get formData(){return t()},updateFormData:c=>e({...t(),...c})})}})}}),null),I(s,C(Lo,{get mode(){return i()},setFormData:e,get nodeData(){return n()},get formData(){return t()}}),null),k(()=>w(s,_e.sidebarContent)),s})()};class Xo extends Qt{calculateCurveAnchors(e,n,o,i){const s=this.getVerticalCurve(e,n),c=e.add(s),r=n.subtract(s);return{anchorStart:c,anchorEnd:r}}}const Vo=()=>{const[t,e]=Z.get().createCanvas(We.MAIN_NODEFLOW,{},o=>new Xo(o));rn(()=>{po(t),vo(t).then(()=>Co(t))});const n=le(()=>{const o=t.mouseData.heldNodeId;return!o||!t.mouseData.heldConnectorId||!t.nodes.has(o)?void 0:t.nodes.get(o).customData.gender==="M"?ae.newFatherCurve:ae.newMotherCurve});return[C(e,{get css(){return{newCurve:n(),nodeflow:no.nodeflow}},get width(){return`${Ue().x}px`},get height(){return`${Ue().y}px`}}),C($o,{get children(){return C(Yo,{})}})]},qo=document.getElementById("root");fn(()=>C(Vo,{}),qo);
